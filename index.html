<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"cdf0e4812144dc4e1a2cb74da77506d000fd5a34415807d45b7c9689fbe50aed7e268ac03dfa05040a51a3be18e2ad2b870a3ef22235d95f700544368eac4db7682b8c3f106206cacf6d05dad549d9ea9aeba30790a1de92ac1e8e082d90390f0c4aa42733737a779e8200096e068e8252003fe1dc1efa95ab4d676cb4339376c8f6b0fd6bdb80a0f6fd52f97437e6682520df2d4980af0025ecbf4d0bf15c05733107ca3781fe478eada01450e2c0d40661b2bf6d15d187d83096aa805b4cafebb97c475a5a285226b02cfac1763f58847fc2c3c4fd7492afc5659902b05ebfb09e82cbc11b3fe70c6b53d5f64156da6f8887a649c0af87b967c1eaf36ab1f54c0835377cf9e9c750985cfcd885f7eb200587045fc444b519d1649cdb04223eff4c558979dd0eb6a502bfc76106d6e9463b4c7aa9e31464885a1e9bb3e446744d452c73fdde139ce53bcdfe684241a7c071c1dc018374c6a3342cde8435d68c2340c4ec2aa7972a609a90a2d45156d231403313d832428bd47410347b26a6fb196252e43baaec26cf64462b6f6a2911ed8de6c5fbf000bfdbcaed5e2e07ff84eefcd3b230f88a65c8b45ce33a0c83abcdb393e7a3a35317b08d25f00b8a3cb76a923c8297ab92be716efee49052a4161fdd8140d3d73ad6f40a719077345f926c9dc8d66332307d762fc2dd9691a6f0ac10ef84abc20f39cb9270673b7c686f576be158592a9bebf77a60abf9143dcd1b4629be2f573be9ce7741494a6dac435381546f42793d3767b6cdb46e19e6afc028ad36e794aabf78edbf7bb749058fd266fe3468894be2c084ebbce8e3d9e3a4110bf7f7060618eb66b057c1bae4fd3889a9f4c9d915d798016813e82052aa0702660302f15cbd0d12ea3f03218ead15d3c7ee50b1937aaf1d4a3aa07faec6bf36652fcb62b74406fb3d8a223919f6888b6e1b5b5b7508f544b398cb6f571e40117159212ba6bdac636682d8c94e12f71ab2421567a344076c3947f2d09ea0c4ccb2ea79265f064ea3cd6d14fd95806a4f3852e760284163e0b8cfdb331f0d531dc2cc9f0790dbfd6e6e10e305ded5088d636d8857ea4407865590b7fd36981022de71c4c7e2d72409a2a8e32d200bae9ca7daf792b276abe79d7b8e4c87ae12b02a7e21d8421918f5b55f0c98ea4102e2cc16f589e2d4cfb479b656cbb077e18ba0b20b839728c99f9885e90df0f6921613f551658606943d6396e37f5e0a107ceb93870de90bbff46654a887f0caae5fd37d943e08adb848800d7b37686d5a2a24895bba2ed9bdeab8b52755f697409291845da3a283d378434b756bea0b1b6e3b32d2c5128bd1eaed5bb7175c096cd922ccdf11cbb6ff99ad2606e5d9ca8f3b97ed2b0035d98ad314cdbe6d0ee3c8634818db0a5550865c3e930e4a1cf5cb132e8a0773de1b818455615afcb6d2432a14f83a2c17bb7dc271d02a9a7d42a04ddb7044bb611801e5a08886c54b648b877b662b9367b0cbfeffed2e6406775b3f2dff229c2eaf5456a11774f29548bc0e063b3fd3b7dbde4a0918ad6e4cfa94ba7b79a610b29adb43a55b4f7195f81e9c0d81573f6484f6e1218a901f1879aadc9d1c3a74690592473893204d9c5240a737279f332b9fd7a32a303f4cbde990464ec8f0356b5cbcdbd8dca885267def54fd706b84bdcbebbab4e077bfe1438037870e6f5c64bbefe8cccc021a137e1cc5f29b0c6d3cb53f424beba91eea4228230b07d5579b70ca7886e525ed2a33c37b0bf5173213d84b664871578bef4d6a76c184ce0e308a21e47e8da974a1eb92eb511737f5749cae06ca8d5a016e46481bad9678fdc7c58dcdb63ee0c83053227d0850a24ec58950dbdfdc5b2d18a5d8bb2782126530ae4db5fa7130491ec58cd149c524e40a0e7820974b4337821b172a5b36857bf9ab66441d8744f73f34b50a33307b8ec2656074f5910dc9793c57d25b35c80ca13d95ee3b1e4404168c526227d5faa841ac40c1ef9061fbee92c20c33003e3152bc43e0046dd4a9b8532c0656300fe1e7dc71a83f4007526f425c50dde4f977ac26748d4470bea8c0c150030344338d6b5d21c22c228085c51fd82150769150381c99d7f20ba072ddc91ab18363fd974dad0d5bcc13b1e7296b4cdccf61b23a8a217301547dee32666e9702bcb736d7143253a6ffa0791de8265ab53c48eb4d3084a020786cbede6f5e0b6744f8496fbb88b8479e5046e71bef200892b52e4f670f923825479338b0964ef86b9b330c05a1789eaa54590395be9d836f28339d3b67e97e4e158ff4a7ee0133c6c0f707561ac76a72681f073b5cdb755cea87080ee9402428fb5dcd3c0af58a442d71d9ef6916dda35c933ef5017734971ddfe7ede82d412b76d688948b06d1e883a8e452caa8c0962b5de80b50a762ee3539e3c3010eaed50fd92552f186f4ff3113c99fcdb075a25f72e789836c5445b9f6abcf0487a4d332843eabfb3bdec84b0436a13ce3b9dec53d0ace5bed616d79c292217ff91a6d18847338af9dd2f22a275194ed18da468157ca7134e8a594365e5f076578d07414d65ff7f64f3f6432a5d55ecce4d6d42740823084285a4fe0c41e277d5470c28dfc78396224431c64614ef0772b4ed82377e49fe4f0fe999d3efd66d1f6ab9a8730cdd803f0b94604690fdde28aa9b57d31a27047147f8ea6cc74396dd700a2eefb2be9826eb4556bfcf58ba7cfed797d1b1ae50de1d950e7ab7438263557f5609b2692d4d207a2010348e8beef408763179064c1394255e3858bba65efec0ccf8167f9c69d3ef3621ad9d517419e986196d38613bf58d776cf4bd82c2b221b8086884ceb224f561bfb14b9def05f3003d8bd22c900ec3ed96d3d5155f7c4a0e07afc324a48bdf08661b621f445e73e6fb7994829dfb7e25a1aa1ae03366dde5eed97069ddff25e783461dab733d3b7f05a864c8927b49ece849416551da9c8f035c93b16168ae4bb7e8cda1a5328f355fbaef8e437cacc19ae9a45fba5b1da53ac04dfd5860e9fe88f9523446c5c82cd4ec69f2b165fdcda7f9d762b6d60d21691d1acc7f04194dcc223e1cfd12d66a1d1d79e0299a1b4badd3955b1cc375a057454cb4aaf35a369cdac1e43d22b4b9722111c671c38028e3d0c4a65aadd584d5f7918c7fe8d780894d4bf30a17098d875c1be5f3ea14ea0cfb55e63cc8396fde18213d759e1235fadd77a07e949083eff64f1a43d3d8671236a506710d6ff858d41b832c10a6f5bb826255c99b9370645d5dc678a1de4abceca6520d65e0473b0066fa6ec99b4908f4ed9cf7642a45e5f8205fcd1570f1cdf53cabcaefd27f35170a79aa3d64290b2ab1f270f2e70901216e02d0faf445272f92f074d01e9d812c80b601c6bb066948742118f5ca391154c433ea9ec8b5bb8296a190952c5e631ad37332df669bb7c96c6fd02109228bfcc0c5021c637cc0e959824274f55da433e63cdbdd1aecef872524d52b7b02942ae49288b8bfd744f4c67258a6900f2040960a47951630706e9c511608958c8fc9dcc745ddeebd2e853b04353ab4bfe174db15072b337bd0ba93d4754369fb148c3210164fe70af2a6448a928cca35e0c534ab97a6fb0f7b4fafc89824d5a298a25d028448f6f928fcf7250166e509d156b9039db73f5347b755b87e4a541f4e77b2088d1fa681a4780a87964463a5c0393b460bf36b780f17fb41711c8fe01ffb8fce388910a785fff2d43031a2d6b8df4c34f50df3ffe90f7f879adb8f0189e932ea870196f5c5af3e82a02c87a8a29a4e712663e32c4354e51116fdb994cb9f60db34399e23aac70e63c3291d173d13a094cf0cffbd457859de4784fee4c4d383812b25a8c2394ff347e075eb0478cb1d316592ddf19735efd8b907a13113748308b17dc5d8bb60ba50c0338430b368bf9b1e21c801a09d550c07426f423e62908702e2a4ac6151d0200e7b43fb161164cd687e749daa612b274df6fbf101b1513e6adb7e7b17b0837a931663c7359546f16600909163cab79b266dba8897329cbb2ba40e8cb0e77ac336a224fa000ead606f459e45d77e7d12122151b984381699038418931f666c88e9ad53babf573fd8e222a1befa5a7457a40be1cb977aa56031d6556aa8f6d7ea13da3e548c537d762595ea1760eca972687fd713b7b9ac517a035618dc3c5523829ffab6fec716d11acbfc35bfe29a21955287c21709aff1b123141818d75e9149d0adc67b1e225dc942816bfd1621b6551186cfb47b7ec62b7764924afe11d037ad039f24b39900abc62b3e1ffccdea7d3e47dd1ec30d014699087cdd86da7078510ea3f0e23f644cab7abc6432adf7d52da632cff9d20037a65ba19eb7665b6fad5e025049443c41bffeed20ee72c26cc9547a92057ec285aeee7098d3fb5c2d319f32c7691d60d7bb4d15943e3133559092080035e45562d4850eb5821ef3fbe4a60f0f3399a7859242bf06a22fe0babaa08d2993f7bacad9bdbeebfced1b1bfec34be5ec9ba845f01041382b5b0644999d42551a841ee8501e3e1f69e18fdfc552b0e08a025ba06fc931cbf029ffdb4989eda1a408aace9d67004b5e1dd57f40f6507e5727505b2dd17ddc66a0841530eb8e98f373d6fbfb67c2fdd0086dd0e71f787b1781de10bab836b9d9c3ede9f715274ee19bdaa8dab935e9887f089e5e120eef0e89642548025d517a9de98b6f18d953f894088380fdfb16bd4d1da97b31f85ce5a65219d0a3c282b4ec1642ae4af0cbb15fbdacf527569cdbd86e5a8d8f8af6a35178853193aae1bcb5b417f1c9087a8ad35cb170023ce1b6676e3bc3fcea136e20de71e7cf25fda4459d7cc65f23f8b4c14390bb1caf99c069180f1ca0fb767d36e712f1b841d0ff780b12112fd5a422b1d9d909c4404dd68d8e4e72365ee8b6190bdbdafcd42a3d6016487a48ad4057e801f334e5cc532d1f09a12b1e7576bc4ef36b7050af183e951032d7b4afa66d6003e727d94c92b15820b994837a7ce1807e8c2653fe8bdda6a416e7c5de42a6c1754807b4074e7c6c9a327baa56355f264a2459e5f6a2395ecd2cd5c18c345be8b22012c3318ebe6eabbbf396ed76368c178f484f96d62be25c2efba860d94eecef54dc29e70f0b76def3db9a01980086fb7303b7e91540b4290c2f905299ae4e12a0e232b70b5c5978671c35ea93e78ff55f7e2953684de306b88409f82ad8e547334026de87ed42591e1e967eef60bfced720d65092a3dd3cc2fe6fe5e684c480e68e3a522a3078691d2daae566a50c66b1b6e4c815a1b05c953acfe203ba6eada1ed258c9af0d084b0a8d3f041cadaf2e0cc70ec9827299b4df8cc4342e5b2f2fd378e1d6a11ce2cc576f6d342b035988109c911eebe63a2a64d12082d7acad26a9dc122bb169d25b93c94b3a70467c2b8a15f7ffde1c35f5359bf364e1dc1efefd73b973e6a501ae891aaa6c90b61212d8c3dac706ab372ae49eac02aff9d4d5172e1a36298ac1b4dbe40bdb0437d78103cea3b10e444c4bb2f99e9e01e10e4453d4d0329a7234e133edb9406ad692a473240b61c43196b67eb0ec18f17acc5e41467ec516acfbfc0c4c363d788795a89c5d798ef5f81ebe716571ad0292b0f8f14c10da40ecb60f8d8b9eae84b7eb691d955d09a80e069719c0d37950bce15e9184f5ccad9002f5bd1ec591fd6cf2851a56d25721bc00f6e70a3b81f91e6bee3c6803140fec8911640efa60a1a43e5c2972d878a7989f60455c4d72555746c67a898566f54f39017e1a5824fd2945408d0d200cedad4ebeeb006437b41ff78ac9df9db5302ed2f5ac4d0ccf6cdd2bf4438afaad2ac81f463c243595fa89da74bec1e44ee9f5e2bc8e1b810a173f7dde3f3b31d887c4a80769594fa54122c1427267e90a8b719cc316df4c775a09acc1735267d5d5409b441aefc236a63da53668a3b77b8b285c1b47ebcb957943ccbda54c9826a3a1625505606a9aa50371434085db3e6a290df72d5c9efe0fbf8f99a7e4beec45e1daf8b18584cb0c0e88ec0adc45b3ec0237ae948fef09545e719ee4a200fabae56cf65c4e0c0852c70b75e5bfae271fa597da0c74610e04ed6f2746e3e456903ff30adda1f8e0043282220e8d857fec07f453393b69b08b68980c1b6eebb2a4a159511e1495211ff2b41fdbb33bfcb4918e5be57636187d07b465d3828e604cf35dd993dbeba6f1dbcf3fc6e421c419e61b908135c82288e0bfd089572808081be43252e6bda2acaa0f06b91c4ef76f75581492b2657c2f42c291abaa1305f2002959e583ba495fa32894f01d5dd51713b50b5522da9516ff314228233de99aade22a94af9cff65925701538558702c602696adb6eafc044de4baf9de7854270258e356aff06e4c156e8aa3abfebc56a958b8063460dff51af92c388969c04a29c32e00c748ec61bf26972e06bd9f1df6896d4449625d2c4d17d7997562f233729934ab8ec18f5d691e84e0dbfa1391ed893251fe767f48136e729adb54b56bb909bdb7c980eead067b17eb4dc96a8d59fc7fd703f41fd183a6c7b56414654548a0128463098e748f424305227b71aca729e0b8d3b08424750e751d3a06dd65eb21181d4ebcbc9ff6d237f22b4b01f648a18d5e39246f1a4bee18722ff56a2db01643278006b094cc2ccebb2485b07966502871badb18968db5eb5fb6e5ed807e39a374b7405c4f2238bbdf0eea6ce99e8c802fbb302534655f9c5559ee8dd3b0dfeac68f7e6544287867020e992fd55fa7465653bec59da485dd07eec1c2893675fd31130285f8037de98ac95ffad6d39abfa579ce27586c5c9ef13e7c50092f4735fad15c78737ab755f743a9478215b2bf1443d7f663397eb7c78fbbd31cb434087c7c2047b6fb99c162d36d6b7b1bd5e3be0046919f586535b835bf4d3c5d6177fdf03a337e661b6d90c21d09583ac85ce215f86d4185e2045066e05fa239d285b2081e578d354b325ea425848767a2a0370e6f63de7b02409e775e9b3a7d4b0017d52b6e14c93eab5e4bccc1fd5487ce0e016c12c61551a7cb24085dbfc4f15d63261a42e59553eb7ac48952908d382c5702323d35b7acaf498fd59ad24a011a32064a2b971a23b23d57eaabd3bf7d354e4832d502b7f8dd3622a3c21703b0ad8c145f0a2ce22ba8ee314d79381dfd5e75a9693c8a71d298fb4e402965e68a256e22c7b223389e70ec0346987835daf562d7f2d75e147275ce51319b65a84052af553f2ab82286310bdeefbc52703b3cc1bdaca403302ae5e0e280ea01a31e053e6b18952a930b9bb55b4673dc8bd1d5ea206d3fd3beb1a27a7f7b520d7cb4a94390a616be220b853530124360f0caaf2ad8c0ac65c76eba89ff8c319e572b55f0db0b816bf146b29175167dd2178c7b8b0846ee7e69d53dfa4ec1121eb8da18600fa213fb7a5275a88f3097c815ea75ce920f849ef0a6fd26cd798ba71e3f5b3cded82e98adf8f6ca533fc7f22bfe05665980c681e824518986d87b4957b7f930d59aac7c2818b97501460ad093594b5ff1c85d69f408d65c5d2f06dc6c6e64b269ff6a004e454c7817fba18ad3b8ca21789a11e0f90608b5c64c87e6a0aba097c92915bd793c2d29935ec990c96c7d8229304b49fde77c2c76d9d40dec06ab5cd6e5ed99cc056b2385c041741a3683b6c414a1ff1bd9befb969be700e605682382c9083c35e835c29c00d6fc171ec627721d0636fdd5a581d43647047b6e3d7bdeb0a64c66cdd9a0e4a92c625abfdd4ccc0f9c4ac116e483a51de3021fae7f708edb8d8c09ebdac02f9ba5bc24f16eb82bef83e7609f2147d1822815568b6c700cce9320b54c36fde98fd5133f85e95f5774c39e1f678ddec164e5cffd1d057adab723cf50fefc1235dafb65e1fa56abb36dcb4a051a84c7c1f3e836ad545c5a9840b798a9fe4b8c60cee0dade67a18e5046e072bc5aba92a429b21a2f6e172250d63504945b02199933ad20caeae6ad5a3d9295d15b1c845bf96dcc780e91cf3eb2471a916ea7faa5be90902b027df01bf1ea1b2f5d4cd98a4dddaa15fa8e50d637a3c632df05854f9f3747806e1122a163e1484e690e3d4103fefb0e87fc631926dd3979ce2f0c9638f4a2b802b7ef4e3e51f111c6c13a020a4cf758bf366df1aa6d4ea390c97b51d2a3e53996bc2e43d9cf86c415ba23e8a77a31a837d6991fb01cb90db6104365ce9092c36f237e896a7f32da92ea357af46efb2f929fd9709faac138989f556567d633bf8f011080976371c32855b4cd50c67495ce7a2270ea082e0c4f85f170b890536f88f5937766c6e15fb6688765a00c91774eb01af8cc71a34c758286351d4b934f87854926e703e4d0a99d7627663f53817236e14b596b5b332f74d88e431f6bba0477609b81fcfabd1856e9d65ec88073fc168fd8f8c0299bcb61eab203f764457e8a6e1a1f42847cf198ecac46d6748f3b4fe69b6d9ce010894ce73b8558f213a93dd7934fc3e105608030d45b03ea7e80f2958eb18510afc9ef47be152b44e3be7ef60fa384c283d6d08c5f4f2a39e38e8f97bee9869e36b012c2fa0180f29463a7992794826a5f53847d6d594ec6e2b834eeec3908d57be40604ca0360caa3b6b2f3ff96faefa7b0fc4a683b622cfcb1c9c6927a40a4cd8848226b8321b73453b62950a6e0030bc17a67496589eb4dcf2e2caa7395a59146abc91b917ac432e3fbc678ae874ace77dc6165fdeaa769e005de14510f1e7bbe1579a1d0d9ced750729c70fd620c37ae9763fd84275fb94c6cb376752b3a0cc32ebfa59c9056180e276b7c6c31fd0edd6504c70e073df211d2fec7465fbab1f425ded32869a0102cd6b069bcae908547ce25d5e1108141505fa12be1f2e5bf5585717721950592627656b1b4f089b7f18af48235d4dabb4e6ec5c6e5a66a2ef9f56e712c931d4046316eeeffcc044c44ef877d3b19712a06faf93a03bd8fa352a1339fc3212ef75298178ab0c3a54ff97440063ba1a1dace74b95eaedb1497c4876134642cc39f7de66ae75e906f0040f6c075869553ec783815580094f9d4554b9e495388023363c6b9aa4b3c5c0371ad5a316905931f01d35fb8abf370042169d1b650e493b7132f893885ccd3d92bfb6c61bb342788074b2cdd39da4b61271a703bbff8ef19d9c01b96d2732429b9668d60e2f837d02656a05b4d0101b7506ed5c24c8947f1d708465c64ac9a9f5a8c200075bd2fe22bd73a4c2fd66958aa23a63dd47785ebc586c2882ea73765dc6aff0966a1a2a2e9d1fa4f83efa9235189d3e02f774a03b74ed9769499527b7828165ba4cb7af764094583e019b2f47b95c2f466e064021439c9393fa394d9c15b0912aa241df47f05f78102c336e6b2631a2853ea69d3f78f7397dd83325537db80b0b50ca3cecb6f4f16788bb48d10e3b6ce15f49cb15ee47c7d3188e67c2fd195ebd6c35f6cac4a017c40ff0b5d0763a04360e4f84abf4a13f0f7edeee91a496ef4427253b35212a20791433ee25cd4a666407c11072ef61b48d9ce5fdaa83c11e51bcae6d747993635b061f3d89570008bfb571cca465eb31374612a606bc20b4b556ea7676414f6415a8b792593ac06b99784e416d5ca3697ca05948e2ba0b4701f0ac0c35ce77c9c805f8acfd25ddc0d762d6c5f25982588309c14d33f9debf26a3a152b5b576626928cf3d49446ce73e69d9e7369239b2199d3b2c91471bdd2fe24f1c51cf46d6c290d770328c2843ce4a05101831e1de02bb9861069eb99f33dc9d5f334cbbf398012a834eb5e9af16b11b9e44a333d392e0c9ebf896929a0a31711664c015b39b6389f6cbebdf2ca788482d8492e7bf61fb77dd4c0e41baf05b05675813e3fc2862312c2923e4f252b9170828317669dffcc33f638535bb5c5d235d800eacecd924c946343d45cb987050b654e9112c9f12dec5b670480870eb3efb5d3bdbc3d0756e91fc6f70fc33ff50049fbf7a05912f1ce5a032b895f6897b01670c6d9cb96305a4bc31c22c5ef900370d87f04453d951806a38adaff03592088d8e154ff73fd61a1d28db4a1c558aa9fa3baad453201cfe1a35d0b896067d454be90bda3288b5f16a0d11d70428f4084c23c5075d7fee4baafe15ec0c22f926c9f27f5035af7fcb3427c79a8493dca58f7cedf2dd4602b4335d5f1bc917d3e7e2c4434cac374857e13d8b54d28ff6f705c6ef79b34065acfda5de91f75258b7b700e25c7a976920d2e9a344cba4406b25257ba41e55292ae977acaf47b97037cffb6ecb112738a5c9e02147d3ed4aa13cf8f6f125ed60eafec912b6d1bc3e51ae55d7901074f6aefbbd3317f487122deca574b1c855933516752c42677347fb012597696502033bdb7d6db277c1ac733a59dff53a56aca8b9e71f4f30a5e22863128f4bda4af412dc598c30bdf6573cc56222448d5d8dc3f9c01a6d13187a3bca37aa2b2da98aedc81d547250e38a82174c0aa847b9467f8f2c9088e43d4b75da9b4625dc0343710f07672d48efeffe63ec63c9dd4656b4b6a87b5cf1c5375bb4fe2a18383c437316fc8e5400d12159ca0e8a360f499f5a40e9efd4576b72f7d6e1c12b738f7fc517a26a7e8a9523309ac774dea3e61d07edad117833a57ccb94ab502f1d864bd20f67db075452273b608ef26bc3d488e46f377f15879d7e302f1d85ed16d26aa084a416c25b78c601fedd4c607b77901c4140c7f0d5274d79a26141a9672dabed33474c3e7ef5320f07563684c8cae30d1f97a9197758698f5561d8503861ce130677483fe4c61a96e7f370dcb2f3d700b28aa630c98abf85db151d2a8bb03459430c6554770d4ccc21175391872e3aa7325acdbb322018b8ee4aff56d93b2d4f0ccee77c5cd6e78d14178de26207238e1de337eaa8255e38cced38f709f460610ce7f3b008a13038c198195bf5913892a5c17ddd560c61cdfab79706761a6791ded202a69759942ca244978eee758e3b956b6244505b52eddac474ff71288a8c6a54985e7527fcd20cf91e93f00c7d4607cc53c7c513ceff57c738b0f9beccee9de5df893ecfbdfa2c16a6d78c5ff539358ff8e883d303680b7746fda931d3381d4e8145aa38faf5865f8e56208cf110c37001ff96387433863b9ea6116b44b0586eccd909dcfa98ba565b4a328f796304cfbda47bf7aa5e2b601b0a52aad812965e545c055466fe6cb029f15faaa3f083dd53a25cae104552c50b6e98b335b58db03697bc0427084ae22b3ff00a83551e067d3dfb143c5f89dcef6194d84d33d06bf05c71cf9c599d0b21837a46e544e9f12333551ecee9a60f13a528acc65154a1c98c81dcdc0f23b881841ff447beb6115477e8ffc472c0e1ff574802070741db49e07517556741b1fdd62409348bd523e62262c8ce28688d65ac6e5dc383fe1b663b91060c372aa51fc7a6dcc8a1cac464ed2b025760f70ec873263e8373d9b7586c4ee72c9d9f6345f75242700d127c90646023ee52c1fcebec272e28023729e4d616902040788e9b1489a1fa6bb0160f78f5db53774317d9dbdec3017fa0137239748f5bee6629f2c273388551ca1a3c45b0712c4812b68083bc0b6dcb6a8008adef3176cecbe26243dc6b279c00c580a3562e3d8853414ffa5d568e7de29dccf3e264d12a0e9b4be975081acb64b4d6de0ce95fcc33c399f2c9887d5a9ff697219cd8019676b6fc7bd811a29e6da2e88ec979105536205616bea87de92752b49562fe884ef9fbc6c3ed3335ba418f44e222549650ab747c7bb58b1f192ba5b4c298c883bc45bd09aef3f450ed991261bf9f38113104274e9df3db14f28aa638a5dff703292e3654b16297055c4da903ece20ab4cd3f29803afb977f040e5e432ce22e44d096acf82413357c013c1d31ece082be7e430013665abd5f71c8e718aaf809c31ba450cb274fde9fa61988258a57fb1f83955387bd1c77199ebc812fbe3af09a07949f20052ed69777c12996a379acf08aa5d53a2101ebb351073daba4be1e2e1d6d5bbb580d42d835d3cbbe3a3fb14ecf0cf571289e290a287d1d4d3656527cc02ef77deab0cfda3dffe5e3ac7ac2f414a0302f40139a48b22509271bac58d19133685f922d0159c0a41a604536a0fe4ab27ec710952ee9595d2bf7f76a86f07a8c2e6b254f5a9e7b4c9d7997513daa335a555fa7a0ce05b7637ef8857c6988f22aa8ee30ebabd7d04f601253a83f9895d618405172a7e5c0378390b0e98fd0df74a049cc6bf17818a388bb1258b0cf02494b929ebcc8b48de0a667dec7113a669e5e1b005f6b409eb8641449eadf03084f9070bd0af61c5433d3e84b182a817218af843dccb42f0447383cc50150218f1cf25786987604dfba255942146ac22a75da36bd974787e5f9a098c58efaff3aae7a7698378cd03514efcd4ca716ae575a09866945f4669700912e86a3e3a9f5f2d325734173c43d26f808538e8a2b028ec42b76495ecf4ce7df81d2f8503d2fccc5999251ea38d4a0112ea1d6cd965f87bc13cca63bf19f70978b747e32aa0a4e11b5c4e3af735c1c8210feec4dccd1525ff0911ac3dc9fd1f1c57f1857d96bec196fdfd77f809638d0bc34255ce6702ebc840849145539eae121b46eecc474a3eb3dd2cf4fad179bd8e5a6f630f094c93f559b19361c7405d85d8a9b23ae189e4582dc3c3793f7ddd2000d4166a4ed97be7150b10975add876e7b3641ceea7bc4af4570fad90e74177b389971a395bf3c7c162daa08d6afe6e93c175ae636c7db0dee32f8ba4440622dd0b01f12e4beae7a9412241f5cc8c57c3d752c41aa72389d84538035df602adf9eb98a64251951a07499222fe36a26da3a303548b97e1c41f2300ea26a6ace9b6a2c11b3a1e6248049394b150b241af72accd7ea768f3f321683dc41220ec19970363262941ffb80e7006b1b64e068c682a124d3eb945c514e6911d6c638a7215de9fe96c089d96783def889f7aac59055b7c213bc9a9ffba0b20da12bb0e4d426a5c0bb64d0af435e11439ee40b879432cbc7a1cbc6616e95687f03f664681f8d159a39063c7a84e2d28fd9dca08580542e0fd6b49e73c38f4ccb83c27662cd972fee7fc8d2b8fcc1c76729b79bce6778be9bef1ed60b2a284d23c3926bf805c55bf7c8b50ffdbe1b20bde43aee0b5dc077a323aef79df294d9a8928a306e27c23d1bcbcc6aea4cdf88ea28ce10afdc2c82d6a0d9b539ed4067f20feb2e7e7d5cc8945f9520051c2ab2a09f37bb42c9d4009ceec9d9dc8a04824e3267414409a4c16b8cb51fe10a07c3736c41dbb5d4768dd68b6dd6d6421249499ff1e5fa3fd73cf17fac3fad9fb3aa419f9328cdb538f0024c0e4f97e8984a18860af44d47111893d33acb667cf3292ce0da558d5c456472a1b817b6b12b4a4ecf3a74415478715a6af0fe5d69a81d23915aa4392f03ea8af353d0fa0f1520506378528a56a2a1992858d669f54647b671129e15c25b153fb82e7228d91bf88611975964a733342961de214f716454461183ba2bb195ad5dab906487ae9b5591c06131a2a7196cf7cc7bbcbbd0570646cd09d1166757eaa9c8b25eeb34d20ef0c54a9ed812f7cbc14c781ad6136e4cb0eaf1a9e2e2ad8aa9a1d96a97915686f1c6c415afcfb2e8a74cd06ba1b65bcad373587f69e80ef099c98e486e4bd182c00aa345bffc7888b8d0b5f50cf0200282b42b3a35949f1fa630f715c6b4960d224d57772dde5c1d8ed09a20becb91d0fa37a5306d7edecb05f8e03a30d3000e5099c3f35de33f2147f5de24e129253316b29585dffd80a0f918fa89210e631ab21cd783cb38558686d3754ea2d6b7387ad079abc032c51354230f8ca723380db012855b456672c5856f10ab218e0f59feee6c3cf37c404907addc913b6b5ae2a1e785f7267518f5b9e552f637fdbeb9f24b4420b829002dddab42782969e56186bb394de3c2cace1f29216cc0bfd92a86412368728791b7e7c619eb8deba29848cba762b53735a0874409795a12ddcce05d157fbd415013d1aedde6b095fe571057e8b7a956eb70f8695de4d8dba065839590df0590126fffdc8447fec07cde1974829894a75d11b2a38930447ffdd606d2436025dc2d80269bd9f932ada94430d121be82e9ddabc35a217e7fad4c95bf306d22fea8b849eb3fa868922710c47263a5c336479ee3c265f698bd2447988952fecbfb1a655037fa7484e4457d196702bd7640ec342e9b18eb691a374b38fe866e3bd42264347f26575d4e8f1820f793f12abc924a9b985d8d6c0168aaa039b94b14adc74120febf810713ab05171c5dbaea23d3a803fca99a844d7728a8554d208ce332576b629ec2c239e6534cb87178af9c12536c40025f9ef3a341f09338b541cb51130bdba15966345414fbf760ddb7be57895d5625ba8daa6449d12648c40a110bdfb415f762c4e0b688b5fb7e4ac83ccf00669665027f1b9c936dec6555d7ee6fe387b4f0f26b7f6367327741ab4f0b6de68b2135ebb7e583b19a6923be31b71a2c5cbf24869a841d8ae8c2deda916d1558b16c4e654d82001f544d5cfe10fdf7614dcf095403ba185412983a35813dfb56dda7545ddac6d6705cec39979042a34236cf21b5ac2df90c03cea81e2c6d4f287b5cfc32c9d051fa9b873ea26a90652765882ac30dce1dcb19a9ca7c9c97cefbc19283168166e291453ea47e4176926192b5923abef8859b028614c7446a287444981eb9f6706cd57c8a48dbf6018a20c200fdca3d38d9a70678c39f40e6767fd4b65fc2ebfd885b8f5b395a84df30efb6bed99ef54d55db32bf06ee3f168192fcf8a903968a8d21a7cd73611d245dc9e47de8e7b4fa2356bdafef397d508541f67d11c833bb429b00aab0847910b59ffe01ba34589f72c6d583d4e7489727cc2f76e500e9ec2ea4ad8605f5a159e7550ca7f2b2af97e9cac0d86043e6ef5247276b0a3100bcc9e8ed6de59793f00baed4a6987faa7e70bae9aa03035616c8c451bbdaa18137cc6fa099cb72a471d3abe343395b803eadd174ba9bf81cfd19a438a3f4a2391a27a932f14ad8c4065e574e8291dc2204ffe650bd1c34893727e4175b4005282932b6380310738b75f825e422fa397f802e5d3bd524711441c708e10bb02b0ae9536d84702dc9922a43dff7a6921cc80fe6255d697aa34d1cb9adaa8226b331996b9d3abab9df1d15d5f41dcf8c952f2f3cf1a40f69b0f9282b72bd5413484f459ec9c9e64178b8a209b6b2d628c683e981edc1721e4c7018b6060fe71baf08f2b52e5d9fead688ae9fd828852c8415cb3190ba6fa63d46d0ce773ee94249806c335d1834e6a920305f0908cc027d9e5e8c348f524e2921733dca84864bd69dc5e7011d9525b8357fae6cfe0974d4952ddef3281a6342f0c89facc25ede31e0b9fcde97bfe3fbcae1498552cbbc0e06752c7a82aa15ef1011b2732971adea4f65765033db98511d4e2c5391cc7f25dd7c52825a48ec39b2eb479ad8f9c52fc39ce3778de5379bba7be72beac5fbcdc2c74a4d1cf5e8fe42c202aefacbf5780830e777f64dac8c4dcb0c0389eb948e0a03ca4e6d1c6e31acbacea3250cbb94492738688b0cc55a1d1e6dd8dcc4f94fc855205889ad5f857aae54b2a9d8c58efc48f0a6307581d260e3c26e362427f122e74f691d27f998f097a78a9adacca4bdaaf2080625d19766bee0903aae6e019d0c4869f57b887553be2a00e9ce894e1684a1c4e7592b054706a6eba650ee182e27dc6fc1d554adf6157095102c0669018649af5c78db621ac3ed35137adea07fd45212474e6760000d91be5fd33f436eec9dc9af3dcc9dad3c837ab28d531c2015ca9e96bdbe130acfd62ebe755d060392bd74ca607cdf7d78178c57380df8cffb643cb70a54ee07c71a944b862df327788b1cd0a20d8bee9b397f099eb34e7f409cc345083d47d559d8cc5b71836a27016258279dbb2a129146e66ebcaa36d58975af87c0192874fc94a0b128f3dd9235a7cf10cda38d6026515c2ee449ee24c17aff07987ca476c810f5003ff2f79dca7871353779990827a5530bc21560f4d479ad42141c64b16d40da583580a1ce72ff7cc486753d902758ea7ad9008b1de00f0f893ad564a01d70de3289a70cc85793f150a65b3704ae0933c4e1c9af66bbb30a152389c5391c080f480b5a9b8a12df596f8554551b996d8704f4e8d26c841d9cabdaa88d27ace5d5b1a64a64168643b2b745bec9b774155b8afbde408e9fa28250a7a6223bf0eb1b56730b8603cc7f09cdb6d1592525d9f0c5a9a802725ffe56cf75483b62c94efa8deddde0e87c02aca14e50b9bfa4385b1005c264cfbc8f86bd71e33caffe485df8348706f080486b8917670349ecf380df25987bc2645f3b2d9dcd2281caadd524fc2336640d3aafe9989953c69fc163cf68ec0e676cdd2bcdf8d26696c9fd40129020f43e1e9c274a07b6963ca28c3447d5c61cf4d2be6b46d55dac9156c70b4f27ae8545bddea8b81d66551b7379d44ce2a5a417e7715d233ccfaa7005a645229a7b20fced5aae28ac5fff872ca3f84e19ff365b09ff19641f993c112a3b4cf94a0f5c50f7c7a622664d63e1680762b39019abb05bfb9672d59a27e796333fb1294737ad10671a7e1991fd713346e4645e8e7ae16d47c08e7ab1000f79c57da2cb91bfea071df1048e6d9c2db085f5ee112ba25b553314e3eacf3ddcf37c1eda969b4606570a4b58c06cb4c1bf0934128a1a80987b7fe1e547abf6972f5d469912855802b6d0b94b61a69dc7c11fffe63e0b131a9b7be47634ee36c8ff0d976983b35cade7052985195aa048b3d827da4b825723a7e920ae5daad1a4415407e607e703e1edfa05464c5ff67e9f466c2fd0c9c57e5ee3046e12c17684ef8d","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"666125d2285f1dab0f009ee7052c866f"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
