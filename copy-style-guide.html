<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"eb5739fe41233c1e802d37f68635a9748acc8ebf58752825a06b941a738f72c77e7bc8554b3fc4c597048df1c03b0dbd36729da67c75a6b04f98bad515db28eee81586c20e17dd421ab1bc7e7e64cdcc5f8c19d46188b4cca3bb126395d3baef1b2361a55ffd81ceb4f497326739cfd9efa4b997b5e240054bc65733b4a9f5741071f524da91f341d11375e5ca01f5091cab38c39dcd73319ca3276ff8a9ce1aba57023ac98504f684db68dd2b6c510441e564e67dcd3158daecf9ba62a7aa4280616e6eb628011066c7f6551711cc9edf281a502b5915e6ee9725d2f8956f5ebd83ed60c707e6c223efae57086b197115050956536bd0ec9cecf123cb77500870369ee005c75edaa52c8eb830afb80b7f8aa08615b9d9c3ca0baa3054184984a38b2459d14fef61a032b1ca6ecf3e5fbec0c9d66e67d348be696516d05233babe0e9a2457e74de975ce04305e9ffd83edde2ceb3270174990bc9133839464d8e73288847c60c6c7c6fb0a057b1cee4f187b6a534b682305cb9db61d4b2f225c27083e5aa727f06059011955e8a6c24ae65ce3adbe61c973dad8ddc4282f2e22346a6edc8ff6c321e943f707e9c022b128be82d3c3627a337fff2aee68c997b79da728f8ab9c0cba94cbd92d5a844710debf5334986d23ff0344839f9e09a16a701ab1974453f89397e3811cedf2c364abfc764290e57b5ba64f88455358c0af7652e32ae9c781897985fa0c89aa844799ccaefa15a8ef0beb81da5b172a7beffc172fc5e1394b21486b647a4823b51afdac0e66c146b6dc585a28d67f4956eaba2861f0cb4afd6b79c821440f39d944d2e0aba908d060aa352cdd4389e0c4358793818e9e2b6a83a92754dcfe7be23f8e536a3d81022fce32d0177dbd920d0749bf976ec9c6cb71b215ce8ca0fab98944c9f4cacdd9f0e83214e3cfb29fdcb6fcbb6ec966627dde54bee9812d4f6ad1e9dd61f52352e56f703553cd4d2125ee1c8f38bd0edbd3c055c7c2327612334507f91cc3b33d4cc68d83a45882187e1482ddf615a563e306b2490e1a868091e43b21d9fd8e3ef9de64407b9f8ed7da5b06de6574eb679047d87bf7aba316095b8b4d40c6503a401b167f0b843c9e008652fe7fc38aa9c962cc71b7eea04b3aaf556ef431807721f070ed655afc913b6006526854389d30b24791b71df5fa21154d57b09e2fb67921c55dd7e015dbbf4bfe89a4b3a3404600ec0d41cf7fd5829617aa8b63dc2802c2403c3e15aabf11cf1f96056c42b1bf62650bb3aca7b0e8eadf538de7c90ed0b68026ffd1b53f366b3e09288ac0ea10ef569f0a262b1ab521eeed248417d0338d78bfb314e078f777910a93aa5cdc27ea5e3006d38a810a1023874f9f39d0ebee0bfdc02615982329b98cadbc6372557bc843dbeef8cd7d38c5c18bb818d9c08d7570ee7e909fb2435bbeb9d4dadfb666c2ece3ea68edae572538a3b9bcf65fd63e85b416a48401f3f990fe9b61408e38780bc39d011a0ecce292a9e159806387cf77bafef52aaf5349118323c60b3e9be3ca69c51c8756f1bf3d963437a9d3b4b69319ea1db513e10702885d27d29416dd3b7f199c9488afb0178dacc31b496f96dfc79735314017ade1f64da31b092ccc5399383c1b19c96853149ae72d851bb2943b0d9541ee96b2e5999e37a623301d6ad6f9e465dc8d65320abadb8d2bedd8f70fbb8f03f2e756f3e3d62f0f8999a8d81e1a84feb1b75138b16e03d6530f536a260149a6db290da8a7231daf5a41b0821c93f9d7f65068dc0c7f7ebb99875e07ffeff8d74530acd58543a711d19c8f813d880b2e2e907f46b321fdf6e0d38204b54f660a8ff3e66ffae81f0475f8da9f7b4a5589e2b28aae7a6a13c888eb4b5e8e8fb162f0442f2df9d557324631578b3fef55ae5587f970a227542eb968777a919d9782fb8e07fe56d045939c8c1b6c885766c9634c0be67d007c827b461cd849d33eac586cd6605b9aeb457e79c6f9fb857615407f62b9be36e4a267fe489ec8e0c4d483012fb456a489d745c25cfd5921e533c01ee88df9c13b81a3845278ba17d0fa5d69be59e5fa6992735b67a719ede92ce4818ece666bd21a618106a171a1557066b657a9867f4ea8857221543e7ab2fb3b16a665c64fd1bad71a319fef1c4237b83a56e1d236b7662da85b26108305355327cfc03e05d8f1ee2f53ecac6f1e8d9431978a0e686e5377b0c91b3ba64d9d5dc0b59c5ac99d401395a75a4c46e2ba960dc86e90bdae8e7f6f168691312194351330f3afae06992f5bd2661495aedae100fb65854bcba3e8528e6993080b3c1bb02ce1dc77ca45731343983f53fa9f9b7a061c169e78b7477b940167f40bbb21eedf2ce9a2e5291bff6b3776ccd0631bd3997d790d10a5bb754620104b7697175278c84d57b1e178200644f6b8d26f1c6608b27976937d1c2bf720c80d9420a74a2b527d1d2bf4eaaca6df6e44ab6d1d810d7a3bd5cefc8ff2219f952f416aac506014f4b80e82c6ad5f2d3d8a300f4c0c5f11a4f93f910dffeca039122392be8bc9120eb5f4cfdd95b550780871d1041eb039469862cc94e4ecdd87fc706b7fedf15b0c33d36a02e656d6e19573a1746edb7b5e2cf2d44dcd8b362d805b617ea8c2e1e4ea17264b5ae161d2939b9843a8a7d806c96777e684947f7dab7ca8535456c67410052099f7c7f66bdd84e8a12f7cd52e0304fd6348fc81ed282c73556143b258ab7bc43023a6a58a5696a1b1547d3e5890b71dbde13e86c499a24c59d95cce55fe2504a0f0881a33896e59ad3cc390db979ea3dd3009276ed81f64c7c5fae4cc2b561d3cbfedf13950076c7da8c9f0e32654cc1749609ac1eb288dfe19039eca4bca0fe9ead59a56b281645547cecda1396b56c7c5dcd9b6b76bc094b7e080803f0b4e89fbcd26e3d109fe964ebb4650abbf405cd32e8d1890b8aaae5050bdd6fa2143ac94b67ee62cb5671032b04cc84486b7a858bfd3fdab373e46950bc55b82aa63bf5c73d2a13c25d5ef5371e59837baea64a7b610cdd4bf8f97e7620a4276da0ae56b1da64b1f622075345a8e52a483f9105b8b9c3dc9333aa9601b2757acef233e387ef3b56bf0bcf873d1901544b71bdf3a2efc777f9757a564416e812c1fb3a743c42f7edf0fa90a3f695b3720eebac1148b2a0386011104e8127e05090570b9ad5a911a70260a191a46b3d4cc20af94bb41b4fe1404af5391b7a723b82411437b4b606a17daa99ad5708642356e4c11b1b345091c291572b84723e959d96ea2a875493c5dcda6885ef23f54298d260a940b97d65a86793c54e401b706eed49770eb5fe3381010db7ae5fd2ca670ded30cdffd194b4f906b7755ef69a9345914243f4d6459a77daf1da01feae3be78358b5b40a245f461818c1c9e4073bf2354b940d11ccb21b4d29deb4730dbb327cd404a058a02a24456dc7481ae490b1155bdeefbfad4780ab702c3016b4fff50d7326340bac05562cf9d8c3294c502021184a26f46f0c6dd425c2713b27bb6ad398a1f95ae5e0e98fb45de8fd15620e88a21bc147cd17c75e4eb477dd2bf2a3548e8c39081b0a3b3b203ea764106104c14b9bb394d5786a999939b1ca55d1f4d00372e3c2df5e66f32b6fe5b0b0e96ec00b42394e84977c893db08e652e90a28109748daf3e06e39423f895a4e8994272d4eb4c4ac1fb125dfc51c72ddb042785cee4568b8fb64c34c790d7f53a15483486c8882b3d1ee9185e3ede7b36284f3f1c9d3afd1a1ee2d7c8488d0aab6dc6268c5065385929b3fa6ee4642d2f1ff6a891e819efae3aa25d9de031422ae28de22ef5f95c7350ab4e093b47f4a595400d8416e8460f61a9db0a75cf34e6e1acc7c740a3ee9953b90aad2620561b1504d67b5c2d93cef32976452445072b8bf76339c512fc144b39cb0dc33db3092803c115dfe8b24f82e40ce5039de75b7e259c417f48e7c9361e52d8a4c0d4fbd991bfd57a9b3bf6782482248ea488d0369ec297c44f6bbb066579a06d918ca1d8a62ba90e615c1e6f5bf7fe171b43af1d741e84ec13f6b7621f521ee096e7335d3cb2be357ba298b16294305b0991c17938c868b453d48cd2aadf03f8de210c4c9c9d87cef17885f341973a9f29cbe5595d6ac454fc400152462c9a5ecc505cacfc97a968e2a5300b187145111cb20d7501e845b025bad0daa9f8ac719c19553bba9299e96191f291e302805e0e62b4b103b46049a1f971500c86d9379a30d2fba1695f2327ba1275d20cc1d5932142c85320a46eeed08634b8766cf717b1da070fcb2737f5009c1ac5efc806154de0d71d939b922ae0fb6ce328a99a4700d624df00909706c87b2e1d54246e9e41cab7b1202e79d9f01729338038f14eb5195e380a7d5a21afb0cf27e3a67ec48ba3760f2a398d92aa367cbd02dceb05253d01dbd5e86d7965851988680a112be167852810325a4147c4edd63eff96f97ce432800ef03835ac352903610aab8cdbed90073912044b96258d7251155c9c4c9578ae2285ee97e23f210d396eb20fd93315ff13c7b2a9b93060385e9bf7e4981626a8c9f28ce95153f38d92e3c017092148bcbe53e48e8433b99334f619bf193f6c770bed25451de1a5e7b30ef9f0185b7959195db6db5be27f0db23b4c772364e86fee7cc4306652720b9e56c662963f80e47e12f3cf09e846dc782534ba1b657ad60683815192d1c4ae94b612acb53e7755e444710aa3d4c73a67fa914fd66ec556013b387ed2744f772d37a3708272fc5e6df16b43e77728bfa88b6e95b3e33c7e9d0394a10022d5fa7fdea2bb8eb39af771be9f0debc67d4152d7f134e95018d786dac83c85a4411ad69637cfe753d48de714d591c9d472ac23224b8cb1305983ade5d0860cdc666ca10a33f11a53f72e72228e3624e4ef44dba6e94b0192917dfc88ae82af5e040bf7529c161c5a6f94b8cb1dbba2a674a1484e30727d56482ad0b1de5247fb355fcee6f022c25475ab0ad06797109b06c2dd995fc4052e05c49da137b4f6c319806de0a2a3dc754f42553fccb738f26b821c20ae3118cdbaf319e7d8c295fde53f4f18f1836804f0a54713de1ce40cd2ec5f92ba0c9e5a21b8eec75d7680d2d173673f19c824d18c10e612b5d8657ef24e68f6fdab54c5afb29996b2f458b1bde30fea8e3c19b92829c981b26a89aeecb6fde78be94026ff2370df8405b7d279270d019c725e1c5b58e7364cc1664facd7dda22c845195829668b0b9b02097c5354c2f882fdd8d31af756506566d935a10e8a8b73ee428071424b0ecd20b71d590ed008cdd594787a826de5ce0ddb01ff9a86ea92451b2efd7a923959fcb94d703e13fc177843d394eb0b4d0c57242965ba7c84d0c5c0c3131f2a2b3c5631db1c5c400553dda7b060a0ef317d2390d5669140b6595024616dbf5a05059b0fa39ea980591a01026310f398ad0fbb78ed28386c2c14123429c0150bb404932325c82ace1c5821f04f2ec98b8a52c59dac2ff6786646d142e0b1f0e950311bc7fc38cf295530bc98766f6ec1128aeebb24d70e4434f67dd322cee3516c4a72cd2cf1dc184e46dfce25dae42bf985756e45c7a1d7d962b8ba7bad10c3bc28f4457bf89246ac4eea5d2f078735a98cbe54654cfb67cae07ece0bd101746ad4f33c78d1d0a82a1b5894c16c1c3d3c918b4f88f6242072e34cfd5b833679e1734ff7020fc5fe9e1d0a7c0f11a9db18d485062f384a21fd5d5da4104de6aab93d12afc5f251c572f5450b56836c0e79fbd33886b3556daa98127a1479ffe8e15efcd0f52de5d515ccb4ca2b7f923b5830721e31950f677bad6e22f944f755a61b087ca2c9ecfce530c4fef5d68e92d30fcf280554deb02800c7b69ccd89348e054fc9a945ddb9f190a99169054e0d18a62c7da6014a7c5118cf92d91f7c789f5c2300a6f20ab59a49027c7ae866523dd56f56a2c5bdba1fd59792798fcb9afd3577534f77343d9bad90313b97e7736103b085cc34b81303467e2c346b9248378848758c47fc584d03570f9e7fb38d43e51e164ab1b1e6e2f42c33281732b2bb9576f0b72f2e3fd17bb8e51b318db260db8fd9d8cb6e990da87b5b590629245f6a02462d9296ce3750e5ac780e8d53128bb274929998035de8b52a41e10481d3b859c82de0bdf5e3663fdc6835d8bf9ac9a31a8130e0058b021fa822618d6339e0186c6507f3279bbffc9a3039432851ceefd4e9ee926828e42fc0719e2ab5a5ac853de85636307fca06a695ab3063eb396c379d8c5670e43682da2e0fda4dfccfd689003bf06cf5a9ba685a95ca3d3eb4b2df954c86458ea80ef769dab835096f2c7823a8d60f895da3fac1288650e74558b69454b08c9154ad0ff899cbb1486cc47bbbdc23b411b4857da873d35028f2101d9b055fb92006092dd5e60236ccdfec3d1bf4d74f6c70378b0dd4849537e769aa2c183a05f6c6abb27ed18d81d087e55f911549edbd01f6975b3bc4b5d25c4a17b028dedb96a3a8df227bee5ddea7f29973ceb46d4a56d7d2582c947d0c93eee7c938f3801c8babaf2cd6716cb54e22d5f8cdc0ff9d6e0303e71f73f344b38177607d2e41135d9d8ccc16f2dba270c0d953b74648f0b7ba50d7d1fab13c707a29dc95d1e5f2823c7ebaa1e486d401904e603aca9ae1608bf1475d6fc8f5218058bd54d611530e5eb6ab6d627bc7e26adfb8dbede3015e42bd2b737982a7aaa01617ceee3ae79842b1f7bbf811e29f0cd2b26355edfdf315ddb68ce7c8801c5622de06efa84bfb980fe0af3e21fa75f0e28c02ab7eb4ca5450109b10241756a1f140632a718ef1c82bc0eda25b59349d173037df6f502bd9a641aea94c7a23c69ce987330feca23706ddb08e891133ae5ba40797d930a418cbf1165dcbb9be3dbbb028af1ab1e151ef3dbe699719a613911aa180cec0c0d538cf9afb3278468d6b91dfdc094828325169d0e989d7556f2cce2468be406e2294593b79863412de0d8f3c3c0b0c81497029891392d10b7bc823b3af4e6332220b1d814f3d4e1a69d06eea9b1f288a5e7e8747172d11cdafe89c6c05ffd17368c34d654e3cf32aec081b55a3bc0ab2eda7ea6235c26a21126025163ea85ac72be2f4fff612c4de582c749b7fb624fd00291b437d19ed2a10e6567965c0d8da5ca758b21dc29cd8cd7104dd6ce58bd5ea4ee3ea6df88ce50fd169934e425b0ac02ec54aa2262dc5ca818d986ca3128b9c61f4cc04e4f8f69befbce662e3842468bcd42d605ab7a49e1b359a16466e6d8b4ea3430c4bfec9ce4a48fb18726beff938c668e69fdde9ca1aea52ea515b00ed9805924ed6c9f90181d1ddc671e56e764fa1406a66b7ca34da659ce149b3c6514fd06968c78c99ed255e2af46b45955ec0ba55f4dc3a80b11906da8e2698796fa23d12ab33e6e655a2f4f2a7611ca734859c503126b215fb1203fee269f254e82d7c24d3166ead9cef13efb88510b60e044e8153deead8ad8395124220f8305a556950a9cab9bf692428b8154a5bf562e40a25ca7f8c10bc222b15681f7678134abe6723db89d07ff9b4b7ea6e408f5cceeb799dd39936398fcfa9e34bd933d116c27540efdd5b443b74742eeb42617b2e045a02c3672ddc6c575222df97af9f37f0c1ec1a4f7a74a5b55d067ebd6662093c678e04691621f0bf5c66b08f74e0c52ee6826f4eac85ea7ef66a6cb129696caa931264792b02a5e01b828a967c39174e849a2b5c6a0ecc022d6e598dbd631a2978854bc9f2fdb4df0dc186d21271644ab49c3bf6fdc49c4cbbbc35c6f9a16bf8b378af5ef5faabb573a05a3f3b9dc17d8fdbe4b494ac61f9ccc171777f708720c9e363d4302dc7b543f916f688841bce57e67726c42af3be94b921ee9f715e0907a3bb80da12bcfc0025828bee5b9fac284ab80492c7f2ebc8b21e2f5dad48a9dca12fda9181eaf324387fb5af9374325c55a4629567a2d81c38aecbd9328ffeb839672c4a6acceb4ca029bd5ea5aa3e079193c5144d9031150c4e0c26e01ba531f1221b23c4bf219cfaee4e2d42310e1823874fbf6d6ba95cc648df205794de4e852c60739c6606afdd32d8ea891f4b243fdbce4002206dc427a7c2f8c8ede99049a0d00e67a5025fb81f7aa66ed5f142965d3a000be2d28ef01edc1b4d3d30f1c27543ab9cbcf8e5ae8ff462db0bb05f7ce6cb81a6c576164aaea225a3abd5beebd97085d05b70462bc064cddfb13a3e3fa3f392ec2e2570d84ca48480570e4e4d3a983f5c293ce27506e05d80eaff0b4ad25d320ee5a29d9c6a2f8dfbec1de66d81913cdc5d51c86ce7ba627931ef1b567f80acb43757139516a4bf83cf8a4f0f9cda692c5661f4e56d88be030648fc9e2f2299180f377b68e30a51ef0a58479c86e0c867267d2ea2e885b6126471cd434ab4a7924a8fc902e70aea235578986010685943a3ad022b138f98975bc1452c5f7a0083820487a3d80699dbc75b9853b44238adb5b6465bea04b28b3111ddac664dc792350fba17b3eb6935ed2588c615d8112be23c66c8c0dbf94b600b276bd7e9ed77a9496012d7d9f378b1c3fad3d5d3c30b9f1496dccbdc9cad11e00af9717810f2dc55cdd47c860cab55a727ece847d8a9326f3ca85794776be4fc97a7c40d1ea9a41b419c928c944878d07f28c703f711693f29e700542bed161915afd8210d0cd2b69861ebfb61acbdee7d43f6a34f1f6a1b110e20d0e50cb1f6453369a5237c120e0d6661c1da1786ac7a766d3811f98ac24711fffc0b48e3af155af11404bcf5a08a2f5f6c530bc31b8e5b6c9da0fa2e5ba5f7f113438fb14a15b1c493a51236707b08587872b1b0b803001538bcbdee85c8e4adfcd69f86a08993e4500245a1866580d87f2ad5e1f0f259d6ee0a96315647e6a0f55c19822341f38d01ce0c09fa21437ec6084b2cd23c0578a1c565ff3a101fe753538afb0c6c795c7726c8e9a433e6eb57363525d75f2ace7b06568d3255ee648ea533db9bea01043fd0f7cc0d54ce319a65270863decf85729b3d45d52f1605779f21b503ebe5bfa9005af440df30b9fe045139d16dcae269ed31d67ed6b535b72bd2b417c45c6dc6cde09c946d64cceefa926501104880c61b3cf6bff13918b70e53b20e9d08bdbb9b6dcc3fe20cd94010b561bdb2f2f250859e1c43451a66bece986260ceda548bb942eec902a1c10f03b24d6f1856c8025ee5eaca2ec487500e3b2cd423a4ac2fa4753d44f06e1b2f90708b351827291b73882e8493325629c48d43d4c85426df67f404732120815b6bd475cd326f8c4ad01b5f37629b70065e1dfd31783af37bbda6909f44cc22744bb43512cbad51baadd02e164589fd86154b5c7874267989337387aee93285c0128b5fee30a59b1f1fa7fe881b1e6d4ca7f09325289a16110ce6956078038b652c2f30d59cf4d086b0f74f871eae3629357235367ea772662ec5c6acf11824306a21b64c5cc6da13463aa0aded94504541c808b8ebd6fccba9ab5950f56f60054a97da6d901908cd5d2f62fee7cecccc8666efa2a0cb094c95ba42b2172c7fc45ebf1e112fb799d59d0262e8a31ad4fa1a49ff2e299b97be4b1e113fce881feb2550315ba82d4b06ae6559b3ea9d33f5d4ffd3a37e13077bc0c05df0ef4149aacc80e9ccea7ad3426c0d1fefe33e4fadd755573fec130674b3bdb4808615a99debeffe607a4cd22cae772c41ca0c7b0d8b6282177679d7dd3bfc7c5d1a1e03413163beec9f249fb6789642e86816888a5b53a3b511ff9275a45062e8cf674a8db97c90170b54a4f365db1bc1a2bb0021c6a038fca5775dca7b8f8a829e7c3cac0a1b37fab939d74e18fb7e2cb50deabd3cde6fe413f59f5e4c0c5e1a6d207bb689725c314cb106029fa75ba9f203ad9ae1b904149d0979c93755e309845dcb6c2a93b09407f5c5e1560c7d79ec279b4cfea935bf34d2ebbaf5faf742e94e2722c611950babb7f9392ee8939576e5fba78d19bc84a64fb298c2b6ace844f8233df97086cfb6eab305344387a9d389e60a52d2c524679418a5e6c99347c0e2c9c4089fe06f0887634169ef5720ba1ec4402153092f5e2bfadaa034e985d7724b1271b72510bfac91c566b87587925782d988c78be8f1c70252696e0377f7f3f404fbd08a5ddf9708bb9b09ec4853c0dae113c4b4fc26693f1d1a395ce560ad6f947345cc702951e56e2c879f7298b7427199e8025d9bb0b17790497d5e92deaebba330f655b6aa32cc2f9ee8d3a38069e78c0b66890efc64583176f708f9b25ed202b5b7acc2e21bb1f98a027619c101a8b7ca2a29e2cf50f1b75679e663644fc550d46e7f276341a90450a44277ba72cf0d2d6b19dccdd8bc0b6fdca299660c5a127c3137265eb76910495145d97d854e0b4b1aec237e9d17d7139857ebf6c701d9521a4f9dffae77d32271d02aae9b3eef3fd655967cf74b57f6600edd2ff487a09f7c1aab8eb1f00a8d96d11c4dc2bafb971d178b23b8a9fe56629d5ddf2a2a9fdc845094222c0e2a268b82cb2a1941f80400ffc5e8416a8ffd9f7594a2574a0ee385dce5092e892b16efd111671347e4228e90938ea2de17ab5b595dd247546d08d470afa92c74074928211a517af1ec55853ef82223dd6298583b2b1985ced9f33b13edb203ad4305b283549ec48d8a8c917418592ff3653df14ddd856a435d89d81fd9aac0b9c1ebd961663faa43b2afd44c1e0d5dd6829b8acbce87cba8b87a7ef76798e2b36e1f4773712dde96c0fae271dc520bad545632dc65d2bc9b540244cdc0c949e4451ff7bd59dc950e1a61292f409d91f4dc5cd80daad670ddeb64ce192b990a9d872296445680f61b38d8fc172cab9bb7d06d11cdf15765fc67f87fbe3ccfa7c715f5ee2451f6deede0fe77c744c079efa668e7282ee08f080ef3402bb2294a759b84cd87fe011a14153f3fcbbf1f2ecb6f61bfc9e57805a0089fd42a26162a942bed1da30313ca00c0106d48bdccbcb5d1462be0f25e0235f5c34b0853414b4cd700e25d6af47b442d75612720ab3b1cd6e12e4530a50f1f6539d4fd44e8a69e35a55d744a3cd4d027378e3898c45ac27161ff04ed1ceb5b1d35be4ebea3a5e6358600ca7c700866fc2c5019f7c02b3c9fb511e928a077a1be2f149ee56132ac1fed2230a91657b53d8caead20206ca21a0276a027090a4527c088d7c70695a7e0f9bb2bd45001bd64e95409c20a3cf6d49b616c37f4d3447cd7acbdb99d18d05785a18f6c2e9cce922dbecc210c66cb5c92f92e8ea5c86e9aba4b4fc2e1312b3edcbf597fdbdadbf4cb926e9c9d324add49d7a95974821e0115f67c4e6006a5f469b37411ee1872b063af9765ea4d4c7e71775cd3b5f9aaf9c74422236848105ad189e7f03dc6bd4edac4fac2f439d8ce62f8644738b6b11eccb7d76e92a6ef9b448266ef037d057282195231d4a69dc98ac0ee7958e3fbf59ea27564bda150d6285fe78269b0a224d2f053645352fd056e6c99bb841760523c9ebcaef394f7d330e5dd77974763453f00acd304a2db950dbb353dd315e1a83231f25c91a9e376a9ea0de4aba9b0f8def951b589c7a2f896110da14f05054de88da76ae216b89864c9ac5767d156b374b786451fd0c121c3b15ce3c26969332e88054d778bd23028795b261c99d0fa40479f75ce27f2fbd3b706582aee3940ccc0bb7b24e5086ae69d5420adcf97d82ca2cde39aad297d7151bfc8f13b43eebcad6fc8bae6ca7c2efbf57c6d068d5defe366ac73bb3bfccb8005f0cf36fcea738f21fc9b235cdf876d30cf9f8ca4e3d32dc58fea30d77ef04ce9000de1baafaae4da4d4e74dd65e233afa77ebd829662b3911e8d499ef744484ac7121cf3d548588f004bbeaebaffb088c29e92aaf62d706c54fd5f3b91c3769b21a660155e0398624abacc144fbf63db99b4ef57118c5c0fc20f15e09fa764467a0161ab90365601e6b1b72d0966fc8e00df8f7f5a4d1ab884484884c65946ba686e5b4d9d494057111a0ade7effafe6a449f47af3f73a15f6049d1c6aadc5c41a63159bccf52b257f36cb8da79e3efbfc827026b9b850853443ed7c1172d7a2758e62de86ebefe6dc214c04b36b8478af5015b4310c2e77ea125f12a6ceb459e468af781889b3105f2486d53d24841d15704e2457d6e353a3fc27a5ba2f19a240b41a583fcca1186503ad29b0cdb3b42566a3af952b8ada46524183cab7c03f32ad1a65e315f38c2815a26feba013211555b0f3e25d7cb438c11900903ba99d62586029c7a3fc03685a67cf8cfe222aee3942c44a8e4f2b37b08521fc8a974d323d2d133044242b4217e009e6b44aef8a2f9b417e6ab378a6cee703e6de375eb682b0183d3649a7459e034c49b798fc6b21d3985daf98b6e2697dca50645eae1c232ffb0a87214b28a8b8b4c291a8c5fb434548301b147c6e2a4dfe71a2debcdf05613986a2bed51c0b936bce0a68be32dd925123b7938923752581e33118cd75b57b55e2e0efd8d28d2403f6b0924cab747af0c5a4d44d92fab29654c88ca2111846813f45c2af6cabf49baa084e897f45233bf8169f93fc6df96452a652727d7d7e4ba3b48392213328874fbaa0052e708bcb270d746708c0a4a7849da029d7bbf87be63332faf7d20cfa05bf7ec35a54227276f028ab2a5ebfff03379698215b697acc1eef5ebee8ae783d01473f47d101b5eb599cce25f9bf7e30aaca961ccfa661effafe356c2d9c7e879a88a7226efaab438e803c94501a559a4063265cf3edec4ca61ae7395723b7c472552be370451851dcfa365c16de97c38de24fb847d851de3fe0a3551b491163aebd14a7b428f0832cfe508b2502ac402625b526a1e7f85bfbee2fc62ee992f05885545c06fd58f018b1ae9a4f4f5e8767f59d472621f059023ed6bbc5714ff76c970f52151d5fced74bd887736d931e58ef52f894a19362941aed09d213582f25fc9f435261b820a3a6736b1381b29a037bea12d328132fa26d96d57b08f280409e4476e149bbbc6e96874acc6611f7fa859b1cbec2862649ceb95fff5b73ccd62bf3887fb830e3387ed163fb252fab98eb1081b437965c44687c3bda3acb037402daf642c35758c6552c75860d0bdf1d7304c288853a3ae6b8ef3bf4087523fe3291160638ac636e3cfb5d64bd20fc459959dd56c9f42b297347af3892ef0179838a269aba0c5603cced9bf767eaafc4e1d2df33b33b42101a3c33763bd0cb7be6cf725fcdf5a67da7ce643e1a1ae41c755206d10e320648b3a77c02e0d52cb44c68d9ae7c6010e6c524ab6d037b9c82d500097200186cb0a9d06290f11692321c4935b92ddf8549822423e272b39ddb4d0c504df5b960e9f8168ef2989cfaee130299ba4ca6262c08e2461bbae00cb84e6202a1dd603f96daf32d89bdfe53bf4f3ccc7905873981853032a4d96336d2ed1f9b458cdaec7f454aecfb43b74a6fe2f29e9cf3df37fcc1a78c903a2a50a496b652307b7548014f6ee905d869bc9d521e433c8baa7390041d9b8c0d0ad64994e5b039b81f775e95845b9d3f4758a7bd1f1390de347b6a362966d371b3f66c34e0bf72aa6929b910615e6b2170a28094c30eb80efb56550bb97ed3f481dbd3776112100ee704400641f2ad2f8cc6a9e71190a559d57c2cd0d4006457c70c3998a228cade6e60c310ff90132e048a63cbd471281b09ed6039abda6f985715becc4cd11a430f458bf4ce629ebfd8c160cc59859bc01a67cd99f4995422fb01352409013195ce867e30ba5d7d87112df02709154949191c8699d261e4d0c3a12df92f774addb6e2c6928ec3f2a882d151d01121c0216d12c419ae0db42a5596ebf7bd75f1b1b41fae45111285e2d6b80994350b3e0bce7becb22d40da1a810ba55d5eeb0396ef6b8e665cce4aa73fb6ac7cab06b365de8d6a05082fa5d2afc9e7429bcddfefb3ee2b53117b1ed46cebc5fa2b87a9685d45b0351ec3f2657e67a0702d009d3ea4f6d971324fc23ead322bdfafa2ab5ea15458545940ddd943c9174a90b90e0233f508877c3824aef4dea15a4957c520841f75e3b3cbf7f13c296ebe524143775142083bfa4147832a0f811f1048325c4444eaf2f5506cfbe96e0326293dfd577a2728507dca8560fa030da6439ae368b5fbd108cbec1092902feb85f807b1ed7a718b8a10260efca282b323a4d810adba18b0a4ca54f76906ecf910b5e0cd0cc0c67fbd06228cb053c0a9aa3d916dcb5d6964f16d9cd7599803a89038cb053868fb50696160a15ee11934c5672c06cad60638e0aab30bdadb4f771d4ff0e1dcb163624ea0a5cc13c44e50d9eda2a92ab22c8feedb4151ce4f3a54fa4cacbc9f80c5cb8319cfe29d29013ab7d6bf2718de4cbe9ff821bf40a72d9cc70191052c2f45979b5d196100bb08701e2d0e4b82a49604edfea60db7a0280696fcf21e2bd14061a2bd4527166816f1f09f214f955aa47bf7d34a277c641cc850cb35f3d7a6d53046ff5a22c0683114bf870969619eb2f684fceed85aa659fbbc8eeb6c80fde05787294df4af74b8e2147264f3efd0fe745cbaa53d0fc6746bdc460e3499f5efc62dffb12dd36de1970fca036b86bf35a859f174e46e23568c8d4c3cb29209ed3ba4b23a3f2b4a1fe01914f6386f575ace62cbb30402faf13085ea3e3b9af94fd2f46db6c9b301ae1d198684d9f8862fd182428856ddcbf6af818be47e332a5a14b5bb8770af003831fbc41e3790d122070667f6e5bbae3cbc7741445568f6193e8f6e203a2ddffb73d65b4678c1e7d3629c3091c68e8012d990edf6ebde7545da5ed6214cc5697c0d03a390c1bd61172658e200d0ec6fc9d5ded54dcb51ece1e37fc0b371593a5d824955fb14404b69653bc1285dd4d64fd7dcf8a7b9376a7d5c24a8b2e14302c2f4dfa47dfa62794f27f5f01010e0169836c5d68bdae523b3a5d6f42634d706f16361e16be06f522bf63762de7d7568a7982c8f11d83fdb0e0404ee6cd6fbf20f2d387d5c043e3e0cb3b2be0a6006335608f4ab0c732a63f94f03afada1d693a0115e2ba9b91ba1ea3c95594a136d945a9956c80e523a6933ecc6f0381b2f4cc960ff1e0b69900cdf4358cb982a4c9b8ad3c71f495e08c0a1551a33ecd5e9ad3329db0c37afe42c951c26a0d3dca858d265b054c7a14501eebea7d40dfe3cbee562dc2d7aec6a7fd58000b020ad12af0f2d488904a34118e7b60f376bbcce0f7aef21be7de3642f7f92d6253b1da4f0f8c72d81014cf4c69538d829048f7fa941a5e62bcbd4a6a8cc76b2512e84d91edc75510973195cd6d2e7d15f9cc7a517b6c5b75326ad61482044b90af68b9498537a335c8fb0982117c17455af4137558ef048609889105bc658d9906a0a525f4dd922f106e4b339e00e392be5594f06dde83ef08469579c5bffb59229b7e3e1193163d5c88236cbd76598feda4dfed2c6a1dfc2aa02a867b0202e0ab4552feb9b564c35ab066b9c980be546c4af338cd3abd68e732422867b5db3328fe657da9d66dc8ad2bc3d4ff9577f8dde1db07023d98cab0b71234a4279217b2eac91c440827130e43bf2e984b9bb623e752a2d7d167fba481059c0cce0d0e72b715b7daa7d8b2b6d82d11bfcc78129b0c8686db4731852794c607fa9c7e282654c55df4ab78e61f5b6f67f470545135f2c96f4207148bc5be1c9c45633a07f6aec1004988cbbf86286ea08acaf6dc880c7da28b4ea16fdfab21371e786136fee6afbb839bfc1fbdb281ad81a0a3b40a3cc9df1f7b8eb4bf2c20247b0460759da0a2939bd6cdae85235d260ee6569ea36efd6f7a525ca47ca8ccdcf66f76df8563f90c3fbfda240d550f33287ce0e46af1fea4ce8a14711c99428b9199721e51a00a3cc8275f98e1dfcb335c7e6d70cf4f244c1a53961c21c42d6b0094b602857c200fd10c6d2748e7cfaf38837f2faf05b64c9d75444b71856981ebc6ce05f4579604c897ee28fa1d013eaaf2b574169ee68b0572328ef577a83c36491322e7f1bc77bcf3c6be79224bafdd729770ce9c2c884fccace386f3e6c47ce8da146c9d8a9e417ab809da040e2d3e9d2838812c52ede495e10cb4cfcd989bb3fd467f22484c24af0e9fbb54296905248ad700753fa6e91b8aa61b03167f2cb30811ad4a3c05be51a183ec842d5d4b50e6a3ff910b69a5b50350319754cdf4d2fa6e814db97da09db043f652f570c5038573e0e337657059aac4361dc2817a19dff57aab9aa9ee20d8152ad85c461a24e1e017d5aeb01a483040424d717128dcd97145183feb92a1934f5009c86882a9a25772f99634e66429598ec9aa4d018c1b26325de41550f8fd5af3a655537f3118123e6123da5538e326fd7658919104702a93da6390fe9ee346dc117799ec8e1a7973aac6707b4d340a14eff2f85d961ad1b4a88d56c4464e9b20adfe52f42d5a678dd6da27ab170da9223fa866d82b201cf16324ad0923ba1d7cb6c7b528b8602e28b75dfdaacbe7d34f014b28461199dd727907e055ad7ed8a1f292d484cb9711fd201ae99ed056b01663c48e2cfa8d198e6d558e446fb5743c3b771bb7906ecc267f69096b99c2b51298e1b4091761c02a5fa38a485681322122bf564e1781d383aadc97a266a20aebdfe1eda17640b2aba14c6f85af00e85c9a0049ba52729640fdbf6a67272d34524d70ef88ae3641ce0cdc3abd527eecd09852e4f8a15552066f55d128c1f7e34d854fb42cba80130fcf07454a351243d3c5d131a4bef003a01bcbf8fa37315ab56d0eb89be8fb320ecbdf81a3df09f88a5fd21e059d956c4741527ec085c8bee0fee9f641c82cb1101700a708ee1902e5478c6974fcc47ac64b476c5ee354a0a539aea1c8ead07e69f5e457dc052bc4ba3a42c04acb84bf76ae9bf3527d89b6155570136d488f1e5f71964bc01494c571d81b8207cf34fb89a73355ce50c4005d4444a0184dd50ef1e0f0e0095d2444cd0387902393e3fdc30347a7b2431b218d346e7994c102707ba52341d0a2d96b911c8f5a1b83ed16df7599c9a0c5c4c248a7552f742ae871c23e3a1a02f14bfc99a3a88ce6af6f847210d876a459cd95b1cb8bea265f993a0379f773694a16192c7f5edc31f500afba5c1b4c85e1284c0205270337f13cd19fe2fadb547a94a4de2c747a958e9ff780d8e6915f2063e6776cc7d74b7ebf3853eb8c4e376ef5192f03d447283bb429625ce2adcef12801c87b879266184173af13300712dbece20ff25d563aa31779a6f95bcc5b7b42666ba05ff5773ea538a680e273f2d3d2b8788f8dc5b92f8ac95bca2478b9004b012ee7ce442a038983677e75122c5111a823eb3aa72ae92eb3d644456df62b4f28ab2d5732331df4698693f70adeebfa0c757cc359b7c21fe9bdf5eae3ed1e1c9a42f8c7e73d1d4b21420042a6f368595664240304a8adbd30b5cc1c14309129be6efdf5519fd5b6da1d53896c01277457af45e329f064bf1de6f0b3d032d7f48b24fb15b330db23cadfb8bae7cbc2aa7a35a8b7c05485e3267e4fec6d3eacfe8560c8a453048b69793a8263b8ca619eb9712f810cb95aaa73c4fe3e880cf13b01efc2a8508dd600f20b2baf105f5b02517862967975933e0384104a693c2289f6fdb08950a5e7f1684116ad3e6cace9c173a3a4b1bbc436b42e86f988d0709f0571484c13f676a3ad700bc82883347ae64e48cf51db1dcfa07cd398c9404cd93e19974ae28f193c62fa7da88ed36fcc11f7902b810cdbcd1ef1b99cea8525a33aac13502af9a750498c9822c8647cb883ebe5af10a82c784dd544d7599bad8efaeb128a03474d4c0be92be70d4843f85a64460499209cd3e413d0b0e26ca99efd28f5dc7a5eaadcc559d2abee13b80a1fe1767848ff922c0391f3a1aff4607daa95703b4133497c269b7c211c3c4f16f94dd77aaa89292231ba1c306cc3ef9f878389c48427e0d5c3426162ffa9460114caf7a186517d528bbf66ebd083b5cfb5deccdb320f9c85a30ef26a9e91c6c0f3c07673777e7fb7ece46016f8bcad52d4a3e20c67d82ed7c674f85bd3fa4a2a8f634ff114f5f6aabcdc3c8763b8809830d0e7911dae10baaad79beda63db400253358360659edc2a2850dec4eba952a7a48d128d87b178ade81cbeb8e9fa23c9a4c85d7397a210ad7c3a57216e13dc7c1754392d63d793455f754a79de06e179e3fbeffab5547b19dc4959ac93b69d11882beb48597ea7af0b1dbe564bb5516afb051e232a149cc5ea97485ced6675bbadcedd6d03ceb370e6c6c9029a828dc691a285b0653277779199acb50666516ebe7c6e703c42ff63eb87e0b614ea82baf4e20d3b708d5ebd2311033591f1a7662ed3b38faaea92e6aafd8ccf6e5d4524729dbf1bdd9ebe77508d3678a8dcf993790bbfd9b0ccc06ac172c776409e8954f185cf120e7b8ed659348eda879abfa2bfa432cd5574d970cff07025780144f18f7bceeefa02d407d67528d12b2c544b1d53b1d5c35e28bce0f6ea15551f02689dd5aa64ba749dedf4060264282cda3125b39f28945c9f0575b1de3a310a7a97d5cdf6b7624aee5e5187b99efbfdf710c58a10a61bcd4b92b54814a80cbf112fbd65b60c2c3b831ef86d99f363a1cd0c4870a9609f8bfe9fa5dc0f3cabd0c7014b135c2fadfb91fcdae378d172f8d26f9fa4440dc5aaa5f1ee9a54dcbfbf08e6a8157cb328c2187ec521532aead18181e408e94c07746b99f9804160ae8d45ff381c11bda33fa28aa9e9c9833a95c2471aacc839b222fe5ebc28a376a989e701b9e770202e13388898fda837af01219883c66e4240984050e897c8417739a0c71c22fccdce2f3a6c360417489d4fd5b7d2f0aeff0cb07df86b0f7ce599ff713b4719d728d6be26acf309a5d6eb921b4f2806e6abcd6b150e3988c2a3645734be2172d477fdc7c1c33fc60a84fbdb47323bc606e8644719d4ce30a7f202c3729f9bcdc6a5c847abeb20e9171b619d4ffd1ec49437cf952ae68735c644028cff9e8ce162d0e2dcbdb2260ef940873bf5cf0b816bc63edf73a7e518bea1d248308730471211d48b631b04b537945b925b6ef0aa51fc1fbb43be924c6df2a7e5d33c06fb2619faa2d449cb6a7006dd603f7bd637272e53a11b2921a1775a5e6ff71ebe04f612e66162b0f6a84d7511b3bf3a7261d5e38fd102542346f391d36a41f1d5641fcdf56d368b083ae706ffd563de5abdebd7216f6f9d3a498b84b856f3e8387191c76a47b6b7928e6debd3d7d8ff4f26f1171b9da049c0fcad0b3baf3ce5a3c30f58312a7326bf5b2b77d7fee6bf0aea0b4a9335c807e3a554c08ab1b8f0cee29c4ed24703149ca1b911b1cc472ca3924279142dd0ca70e098624a9271e87b3dfd02c5cd16eb7a37040e346c7e2e0fdb5ded9fbeb91e7e80dcaf965cac830247fb486fd9798844c17362233e3eb7065ec00603967802533a562a1d1eafc01bf43961b097f848c5eb0f2e80b165d4b6d06a5a8d57973494d39f4453f629b03adc08682c8feb091d08e8b7c5ac46a38a7306d1009724b4756ba331fefcca83da4eb92f70abee68d5ea0f577e14d0b4f678ebb374068876c8ae71b0fd28af73a4d0b1d81b04a680cf287e25c998a474affb19bc871501cdc863e8459ab8ab15722729b671cc0abee26e52c781a48a2a20c125e8c98c51002273c27215545599766153d0e88ef48faa6f759eb9b4ede52d02c39100ac34a39abb7c4e28818dc09f961922ae28f7f94b76dafcf7bc0846a171c23405b0cfe1e79daad7087f3f880baf7689bf20d995cc239577f53706f3040308d8b38cbb8de2e1990e58fee246717f16c508901fde480bd36e759a0021f3101e6aeccb3a90dffaed08dbefd5508c243e67eb8be01230b008a0700eeba8f7525ed38b376e110af9c62e8663f2fa754d1bc6484933986464765ef7371be6d1f01f003749bd0a1523a61900f7eb4883314bbc5b9c712aa2803035076ac452c0e6872c3ca42daa771c86c74ec0bc91c9729f9ffaedc477c157a54fabd346e366a96c2c415ea878d26081ab6e6a7f4be3dbabb9542d5adee9632047a9ae87ce9935bb4a1957fbb0e4b098e7a6939a0d2812146c262bd4112674442ef35f82f0fc6a7269df2949fc8315620a45eeeeac40a7edbd9960fee919f9a82d74ed2b5c60c5dac2282526f4ae1f23537cd0b7544be014e32e0d145b0b108410aa04cb1c78ad3556b511296a14827b8edb5c334f31f981cf4b4c7ffefb70b3d22e4435b1edb9b2e4f2e7e4c64aeabdc9cdcd9904e6e06f5cf8e59461c399244076105ce20829c67f3c70e62afc2625184cfe786e22fa8dc05548ed8467823bcb450e798821e06d16b80a07b0f87eeabbb216de2bf0b066ec553f95c3bbd13c4642d1348e628a2c37e04f138c4e89a56ab3fe7c6c3f3ee4cca48015142b75ee58dd2d44de5179feeedec759b7519d91abf9bcc9ff4f639ec0de0cda49b44ca63c2b69fe0c697307b2141bbdc15d0c40aff6005f6a1cdb97845435e09d896e462ff8b330585fdda4508fbfb92f8f5061339048bfd435ae3eadfc9356820cf58f2abcd4fb490e2e5df8fa0f90ece122771b7dba9bec61af68bb0fd03f20e0ac0d5a8e36610b42ce13f09688d6fe7e37733854b217d3f161d2ed56baeb63b175c8f9e844774431a04a2343c7c3e997091f5bb202ba026e33f901f9854d5fcb7f93d6d8b4f6ec8481874a9211be69249126f3152bed0e4d53ed1faf6f9eb6c01cb2cf0d8b6b9491cfbf554eae4d251ff27d5e86b8b2fe821a30e504e9443b4bbd4f4b190ef7b3c877bf7cb4226bac582a798c3c44785ef5a487a6adefab05b8f108181074c463ce664e248b7b87d8e6d66b9fe25238694bf094fdc9ea41c2b799c265bbbd0d91a3a37c3698715146b7d59b94c7e7a8071d296304dc6ff6dca9e0dce542bd68c011f2e9f81060cedbc94590cff73b46e6e7b4513d5b086394179b8dd26ca3450d97aa5637c671bb48984c53c8e4158ef1bf957e08cd90f544dccf83e801375587afde5b377b2b145f7867f429b244f8984dbc94ff65ab7acb7f0a29f34fd63910d4bddb8ff59fa414e19e7c0c8b24a444d8f74db605c12623b48f826b4a044444d372d8de4ef1d739238e8ef1aedbc33d7008cc1f0a35e25aa35a03531764a89c3145ba810bde6655bf820a37abdd6c1552350c210ccfd9f7d4cc71842758112fbdfbadfe6af28b8cb27feb4a2dd2fc1b729c6a140379287e551f720c04ccc7992be934fd08bde88ad96816e9b6895a80b62ddb03598c3fa96b067e61dafa92e149d0e1603f11dc5d20c1731f3dcc1ea04e64cc26affb0814787d1ba598a0397346121a748b0d6706085047e60eaee31abfd3d13769e4c8228d1f1dbdf350149197c3107661e3df3038bc460d3b4ae0b155ad1bba3422c7a58451b745798bc6b65db3fdfcef784f0350c3cec17fb558a8d0808f423a9262c24dd3faa4844b5019d64a888b4c00a9fcf55fa2ae41d21d39f85ef40b002e999617fa4c7037cd885b26e7dc16ce7ba980aca52e8b5ad95a3a39014617694ecce601fd37373b0bd4e193bcd25a31","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
