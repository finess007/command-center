<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b7902cc6bff9ca62a9bf215e5b7d974775bb0cb85e088d2fe07c55dac3c3d5c3cd43cb2f6827fd2c7cbd8ff6ec0aab8eab8e35c728e2fc638408f1a1d5208be545da891124bc21edf647bbe733a23d073131b9216f7746d9d322b3235fcb43832adccd50b4863d0319252c0d9a89822347e664804db6037cf565a8856944a90c2db1cd5a26e0ba3b2203bf9f7a06b171f9cb7ddeba98d8a33fe77d54cb51e4c17d218e974b9b6430b1c7286c94518f2ffc3dccd6f63f3abf9610ac8926422e41af064cd5b47f7629da9811c0cafda80609bd4ccf0d00b52dbe38f1d13cc1fdb75486d64c8236dcda0fc64bfde3a11b1b93d369674cf2cf3309d780fa417b59d0624f452c213935cc70414df541d064f011d60d5aac460de61769517083bfafb48dc573a79c3c6d5264e69b9ab045f467921f12876096c1336d358cc07e15f0696a7f7a68d0cafbc13e241ed3406479ecc6b21298482121a072459c7012552068560c6b86e0bea24aacb2d9293fd4eeb774cd30d7e893ab72578a2051683d1952baeba54679f8e808ee21b28bcb4d23b399790eba1761e2e09f591ea3f2e939dbc6aaff197c65365f00dfb4a132d49b28911194dcba418c69b172b292ea31030f79d90915f85437beaacaec6d83f00edd31324d3c2d967d95e7e5c0c7e44dcb5a4d34711e6055bddfb5d90d1a8e788990d2c49418b7ad69adaf54d7d535fad03024832b60db63618bda5129f36c1e99297591a1ed56f483d304dba77196bb51e1ad125ec1816ea50d1df7c0aae689a9480d0d0feb58327f953a164d144f1d8e433fa246b920725243fb695ee0100b39cf466243e3e473e4cd1954435857a3af53e120a1549ea16c54c686de7c8abeb46a1a3553cb9305245400911cc6ce71f5ce0f3f5ce558dea5274da5fb7eea730cc460021dba1cce2a509ee803e6da0d81ad4a809247fbb8a50645dcb44377a627a7fdfa475caaa50a9a6c1ef43e602483f698cfc3a7ebf537cc21ebd9800ce2e529bdd153b164860d61f40f870690eaf87b9a5be5fc28822a96212f87cc734631de1c04286a50e9db6850bfc8a5e4b627186509b0e7ecfea8307b79ba23bd7485d6b3eccd0dce8c5227c9c49d05fba93672cb359ea1794c1565b4ca0a1fda021a26f57f5e3597d40b73828a05c8edd8c0599f6dde0b52fc32b908869647babb0ea01cc2c9df99e8500d74899b99f768aa39091f5fa3cc9592db2e95c948e2c273ffaa3f4040d8acc2cb3a341d8822089f067ab3a8f038a6b5bc3164cf65a0d6ee6c8446ad5c215f607810d0a8cef2c53365669796c804debcd44190ed8163ab4ea437547cf24d1415139d44bfd368c167e19b1b2ec1658659fbe3c717469586749a3b479155e9fbeca125737c33025fa6fe34df395a0468ae2f45cc579184cef8195d2e690cc1d9fbeddb0182382fe27f63179dd2a8caeb9dffbf0afa49f27e01c55a389cea77c04607acf4604301a092c26bc4303a17adab71a1fbae96794a0152003835e709a9e0b89ecd966364ea25ae09007dd8c3d29510fa47b7c1ff2b8e54eba9bb9c398e1daff5d2829205d6d4fa6a322ae5bab377d62465fdc5c5d452c041035f83a056e5edac8ec8e9821a908c5c7d331fc0f1267c44c636ddaaf1ac37704d9a30419a83e1f971ca9ed816751c2305a86beebaadcfb7cc323fe69f83ef4ceb0e29577e73e8e4ba56e7139b9209e25725542ab286e49928d674f4199cc656ebc1fdbd5d6a5808bec9962c5ae4b6aa5cc5f5ba033bed5294350b441c6e7abd6cb0cd58d7c688b34978b7f0dedda43376a5b8d7f59c7bfc6a3262b1a88cc128514bd44b7be5393599ce8cf452abb610dd2fb089f06af853e343255d2d0f0a28f48ac05fff49c3c2c5bafa4f167fe91ce430a99f1e066cf885614124d8ababe34038b0912964b2deba3ca19730563a684a551f2993c74cd3daf110817487691d56dc51245db53f03a30c65a1710f729bdbd6a287b2fde7b95651c5bb6cf794ed195d3f14a03b3ed969e1a70aced034cf0bc84f4d076cbf7c9fe98bf124eb9805c95429d57d9acbb63a28de9a92c5f1c49dcbe5d24f9cae4417014a1a1626343814790fea7911a6ce6462c9eec17a57eaad9cffd2548412a8a8e26be74af9ad276cff3e59137d5f0a664eea0f30416d0867aff9014e9b2483a9cd2a48a83dca1802c4b9c07c94d0da1d8f2d84ae9723e467de22c551c015f6a1ef8056c2289d0bbb8fbdc1483aae93b82fd7577281608bb898f532d5937fe91fdd04f46660b9b4798ec9992e5e00bc9d8dfbf1005fa052ec6d67a7ddef55846a9ca54db387959837e721a216f9121f94128c1493c5b5227fa70af801119d23d56bc2c4036bf35d96553853345b22b9720153020ef8f11730f002c74af6bab2e4fe310e870b65d89b88fa7a4acca088c25a6ab2872f29671c3c2815cc016f8fe12d9b898933774a0cbc1a56fa819f57b4b3673002b15b074d23dff518024a05510030b8242f0dec7c85936284a5bfa4c86c48dafb6e08fd691b5e7dd81f4bc1a09af7d288bf1c178340443f4fb18448efc4506a3488aff28a0197d2f6838177f56175cfc3eec3f4c01443ff5b70dd69afb4cec760247df1cb21f0db64335a073afe2fd7b3ff2cefa8ed34d82f46b7f4e0d0f85e4739943f08324c2304b6095d51a624b3211b8f8b39fbc5eacc371de98ce02e4ed8485d4d326766ad9ccc04ec28f3576d558e932394f0a991fd298cf07ba4d36cf9d816518a2a1bfae72397ba65069ebf6ce7b94127343e00307dbe8779ab056c2f4fea9c062036b5bc329b537335ae16cf9839dd428e6ba70103fe26f5eb249ce5e2707271f19a6a33cd20af04bd78b3d4861df60105b4651dcfde2c6025e889c651a1aaf6c2ce8d310c30401685efcf4f88000a4876b07cfd22758218eaa790ace7fa3527f2d43e91f2262cfa1dbe1adfb20e62118f68b1b3b8825f689f2849cc07c80c20ca8de644e2e12fcfd391689f5dfe0010707e6d03efe444f46900aeeb0e95b9748dbbcc47849602ef7780f2b50b3d9fff94291a96e439cc34c13a0f612c0232e39bbe724c7567b1986cf46c8e34da0c5aca0328d31a2f333291cbb6b4fd3f407944f189141eb28fe1e3b89d8c74fd6d92ee0e714fcc023fd57db84c540aea78bf1ac9599514a8cfd29d7b3bac1b2c6bd672eb45a2a671ac70e8f59bf8c8a8c85cb0e5f91df3378a076fcd4db66379990a18c69a1a987e96c102d5e7db75a4c8fa8716b2905b81cb4997e02e889c3916a604ab64f329b5a88c5ffd988e64e61a930bd38d6c60b2fce884eca546e974bfd3c509fc2ecaa8a2d5cca18f5b804c70e1f2301e6afe1709a787321cd07bc2302352fa377d1a78de9b989e916270d2fe71a1cdd9a5b7fa83241e7c30c153d92ade4356bb171bfd588470f7193137d62bfb5b11a6e50c3c5fce0417acaccb461524955be28dbd243ad4d117e7ccd3a59e4af13c07518209a3a3c50de960df141bef50a83b83ce11e24226be34e28540ef6cb5963fe37e9a218c191139b626367907e3ad981b3fe842f615331ba78f7ee2830e63edebe32865162f15b1772551e0a22719b9ceba8166780808517c5c36c2263f6481523a8d20a3276f04cca1dca9c6b3b6283da61902e69bc692c2fcd48ae9ab767127d629b96ad0ccaac0bc4e197e39d11ef309c8f2840181fdac7d44a367c56f7ea71aa8ab672c341842017e753bf3460ade8e4c1453b1a5c34c3099f560ab4179451fcf1a5d78255a53c287507e71f94f2a0db76c41c87e187d6d42bfb3e46984c5d7a6069253f6c51fad3b84a9fbb8793a2cff6bb9a9edd80bbb86f5d8e264590af4d8e48482ced614c36a98e05f5feb8c5abd4c1dd328bd037548e97eabb785db33f037ba99fdcb2968e4ae2f71281e26d113a690a8aa0bb0561a9d8108769966cfb75a614b947a0c460b76202c617b0a3e48fc2822aa784743b6f7f577da78495b6afad588004821d1811f992c560d24286757a1c4f1e010b033d9adce204bbb558d253cedde89f1776e940d2e5af9f7b5cdcb770bd96f1e75f4bada005935a7fe912711bbea741a29b149dd413c51f0e85a03d6eb0cc1aa8ae6a368fe18d6ee5b02a0b75b80a3e3d6d5eda3d554a103c706cd7b50fb6ade32277061bd214747833cf9c6fcada33fd11b17c0333dcb6ed577f22ed62637f534944f3e4bb891d3877f755e023407cbcf88d44859b2f433f0243d358a1513379b55dcaed3b5331a759a6cc749d5b4cd75aa35f3ea6f585fe8717d68aa596b0eeef49914cc7dedbb99a8d48e1cdd9de99e6a5c8ba442131cf2b63324f4e112a3f54959e68deb152e6d8e6c480086ad97771bf231f8087dcea16f9c4553adb88276cb83f1d12298caafc9dbe486ab3fe6c6cf95ca8dc50706799d01720b3aa62055ae1801b7eb7127fe68d1c48bfcc9712479657f80d20fc2823c4e3d95e55b1e37bd34cd7c5347db84cc93f0cc91adbe995ded8de66f5bb1b63e4a43cf6c0958dfd3f5c9488bb36b048f15fab907c2c7f982fc7c4e685e0975a536664ac84c7901608a3b1a2f61f0fbf78eec170a09fc6c4a0525486bc0d8d22302f46a0d9dd7eede29477c7c0a864d1c57929f151bf1abd79807d17fb3373d50f99374b3f0c10d22904ff5372ac86d795893430ef18f142b4ddf3a442fe1e8d635d5bdf5f7b3cae79404d5e7b434e03b3709699ebe25cdd050e573de1df2611eabb2f4b1a6daac80749722aad64ab596c9eb2c4a6c96386c3c4619c11f032ba28e832ed72dc58ddb6b9665125cf5d7e07462810eb668f83974bffd347750cf760eec2d2642761c47f0be573fbc046ee0053737ccb1d7fe3bf701a0a3b68061194b9ee9e8b4754f24d4c5284d4702821274c4ba2006fbbe50a90d79cb64aa95f74a5e3c92870ff70ba3a0e629d446b9b0ec791fcfa957d4e42e1afa8bb087287ed6ba118afd32842445e35edf41435c55a81138279ef3901398aa383e6287eb051d7e34531b0366dd4ac46501972a60b5b418db7d571219f0a4917af1f49206e1c538b058c142f173451339fc14a2d2864eb349872434436031f1e2ff25fcd00c5d1daf3b23151037341937777dfb356ac621be14f71cbe777ee2a1d36c0b19688eeb22d818874782076033652f7cd5db167f10e50dee1fa447a45b9cf1df9afee0c85ca621d6872f76db14417b3d95b8a033672b50064ccb61fba62f2a85add6e4b8f16c0fe00ab30a2dc06e84bf71013501c3c9fa3e197d14b6732651919f5cf5dda273466135309722f88c0b41a0611d03567bf9cf4dc487728bb895fd79af0694095c5f460ebb60fee074f7377c6fe9a4b3bca86e89f6a48f423a4b5d342b370d5cfa11a2882d9e971e464813319bc557d4aa77fb32cda663f8dfa3645da183964a8cb2f3e444a5035cace7b6247958ae25d30725c7200f6eab6c17dd2bb3a5ec640aeace78b28e81e418785d1df92cce7d451c460360700876d08612a44a4dd4972de867a3d3b0b1203ac710e2d9f5e7604ae1ebce373997009d4741b5eee2d962db844149e408c424e5d5f04eea4be090694d45d01920f05be2acf36bafabad3a3a12c40e2f655d6a462df44e54474afd17c1003e704ea2a8f899d856c21b33135110215e1f5bdc18a2a190d37e259495a4c585ccc196e4f1b16eb52754d0ebd2d7a081f16310dbc1954b339b935c9882798a34e16dcc04e488addb3fc0105b7507e8e2d2635b4250485aea1084e61c3066623a825bdd014cb5506a343c7047a83b645d004734b71a4d6806783a3247725915a504cde9cb49205ce0d7f015d5b876c35ba6d12caa614954f7a7c28f383243429c310bcc10a87eae7378e9199dd93c9b5732664b6cc71873e3cc4f4a7e0e49ed3bcea0d3458cbeed03ab3df1bd56ba9af324597d1fb8ad1f38e57eb8e19c62b190956f428a4f70f644b457a55f03708c424264205609d17f2b011c6e1201984981b77bf56a134638a5f1d3ede8efe4710f01e953c1eaa17e480a0f1a59a667e268720ab5ca95d1e518369bdf2ce9495ea0b020b842fb4c97105cd0a72204fdcba193030f6b7cfef60fc2b481382a6c599877273173bccbebab245050a1b0f06a9b9104d16a1432d91e7c3db9cb954f2188c7ec5c8555db3203009083194c2385721de78692e5f64058b1450dadb5f7a52f228b6929e7f4c916aca2df49b783e79507147ec7216fd9a0e5763e99576c61590a0799f5e27269f44be2768cfacc401bb68dc08c7d47e8d76138e7a4547b2b72e16372de24c6078d12c15625e8578ccf09d95730cf19f24dc5274c9081049251b0db22c29b94ee37ff8f3f171b2437d4c6200b4c60f8c99f34678e44fe370870b7fce347538a5ced250d5dbe351e92a71bbb2429f3d6a1bd274cc6737542a5daa3e417ff4eb3017f962527840a855f9b8c5f882cec48ae27bbf841cf22c44fa260a1f574055e7a3348da43a251a812e8c7b705c400124a303f09aca965a498df75fe4e09768789a0a169d2fabd288e43c703a0ca105f54d327dc492f877171dd5ba5ac7fe9b64d7ce4ca19d391a24cf18292a70a66ad99ecd7a6f50f41ec1076111e8fad27520074d177f9912431f6d2a08ef279228cb31a919799b1a0324a731272f9ade7e1b6aa095d5f89e62081db58b133cf9170ed568b0b9a974d4ba8ec23c36c5aea94634336275f88ec4672ab5134b392c630b3e408bd4409dd3f5051d5fd7c1a9a615fe3be13d8d7bfd3883dedd09d05a3fd6539e1dfd374f00462f1a345109da1ec8032f8ae89047d66024257f870fcd6d73c20c8dc8fdd84958230e162b3a467e08cf77d907a7f67ed09ff412fad3ac2414d1ce89df32bc1fc86529902e99d2d5353b340c1f184149e1be7916331aca8730b5f6ab27e86122fc2030c080b74151f4bee696e9dcd566ae4ffcb705b9fa1a972620715f9ff742c6ab828114148d41baf8404d985f4e61aff7a7bb3714c4addc90277051a369ba1a6dbf1a57bd0912149e9c2f247ac3c729008183663c41106014aa4105604b5c3ed2857e2eaac1b03c41c238c95137d4d84d7ecde8a96d62ba27d7a7a8cdec06c449bc6552ef3025e93ab6b53efc72c09b111fceba9c8b50c8ceb7efa0c293152c33ad277d5197b18a20f1cf136becc1cf951c9d5a364dbc31f1b215803a9647a3ba358dbaa5ff470cd985f383298d3d0f2cded0bcd0180969263ea8ec7f511ec65a1030bcdd59ea4eacab4e54000ed55bf86b74a06179c3c1a777932de870eac14811521c252b5b2243f804e7846a973acbaef66e7d898360d1c36827380e8affee3ff1ada720e4e29caa4f92161b6fc8254558d7a37c40cf6703bae38d69a79875590dbae5e17a57ad43f2f728786f51788ba2b3e171e7ec423bd46b9e4da4b37b7a497626af87f2aed5dc107b0dda92db20c0fcad06c546272f59f5593b28e65b50b43fda82ed1b8dc401f8e05de23197df022f2c4dbe40171d8666a1ad4ba84722c53c206b352fc17125d323d12d4a2d2ae86d1339c277ae2b34b6899c10c6661f861afd76afdbcc58b6436c58c682c8bd93baf6fb5f602e59b4de1b304b91c04cbfdae3e391dec7ceed22619cf8dde7518ce74fbf62108cb0866c5540dc1aaa361f075994b0dca5cddaad3202ecc7a87891b97141bbeec5a718c4046b988f76bf009b3a99afcf3a3c5a7b9b5ebe1272827fdf49d44000ac205db7e231bdf91e0d93051de356002450458592f13d822f31222a4a262fa5580551419947ae5149e35385782be96a1287dfb425d9e0cf81bae0bfdc853ff517e6b914353d28969750986b7f67c23484ef172d1df6b57f53a510c7c3c06f23a2fa372c42e8eb208fcf961562a21680f2ec5c53267654c0f0581ee4728a6d6d38b414dd45cba2aaf8fc2be1d4762e45750f19bb3d222a0fd493a64dd06a39e65c733c10d5ccec9b064d5d583241755cc4dea42c9e9aa4f00e97081488eb19065e415abdf5a2b18823019aa7a1a6763329e748aa4b14e71c2cc27f89f4b7d618d5a87ee2114d4917d3e4a6bafe3dcda896b11b7290286978a4aa7cfc3c5b88b17072864f49fbebad5b8bfa362ae098eed37d1b3c8a7456b4fa3b12704d698c7bf2607c2c0eeff28a36713e12732b04ccd68169e3e9e82a784fe963dd11210f0e2793e5d1721de2525a759e4523d3fbb18005f844ae00a1c64552ac3475ff0ad493118aa2612c6a2548dfbfdb57c8c4388a42b57115eb4b4cf771a52d4424a6f4e45919d3542060988a6c2b8d3b0d556f13ceaa8f59cc2015b7be6ced32d88b3cb9b11bd7571fb3e9c03687325940b00a82ccdc5e3c18fcb90c042e8e06b33b27c47bd0398493a40a5518b2f1d998f4612ce58af5ea8c0aa28fcdc62ba108c58e6cf25b919099e3626b9b73a713eca7c0fca474082569ee4879ea2172f9dbaf2d415327de6e4fc6fe4e53178556a76eb1da44b86d03bcb4b9c6e6ad4917b808b3c2193fb44dfc37d55c49dba83d985809ab6f155b5be2b614ce18a2b8fee517708c1de4bb16832d8a1dbbd8acf31e06d6f9b267c486c347e66ebb12d3235a62034ae63fb6bb43d4d0c3919d976ab50389fffb38766662bd655e13529a55188bdd81474026e868d38ec6f5eebf934f55e534e2bad708baa6448b3879816cfd6547b65e8bed291a49bc4ecee731dd6b6b38d96796f5a02eb6e7a1be8f0bf64c1100d1f48ffbb1385caa43077ccee3e854f7fdafe6839a381ecec420747399e6475862e72aac07f6222c64686016ded7898232fbad9555c9016434f9c3c60ae49184c7fbce71231c23451e25defa223b931c448d77b514e96df9ee9d1ae2f84111e0e964bd94f8a83382a0355afa81c1fee6434022bc2ce89c070110697eb9faebb43b5694700b5b26d1f180b4798718449694707fc6c38a80467639b752d8a38f64573e535b9d839852be62502b8781f793124da8503c43a80f9fe0994f73be6b7c0ffb2c9854b0d1b0acb8f122baf6e896a12960454e3f0a70c1ebe652f6f154b9d474fdcd172ad8baf28b5f9a8e33a5b0698129fe0e62dbccd6a59fed72980996d7f67493d05a19cf05112dc87529c18a8f80c308292d9f8ee3dcd0e8423354740126e7748d16ed00211373a00a11decf6b6b2240b956fec93fe70e609e05b7394fb37ef9c19e17886552ca9214b7518e999cc749e25e2d5300203c5643ad0d23891b175d4faf8438bf16171aa2ff20f78ba2f03670ba2a13542d35bcbef7a08fc1de2e947936d06deb4ec8f54dd9967c907f514525420677fd600525b5f1bcd0eed2d1e16da803796fcd7aad14c919ecc1ed964edbc55a7e72bd1634f31609a57118029bc8cf8adfae23a21b3d3f00ac9d2ed4c3242fc181900f2a9ead49b759dd4f64c8ba69de12e215b45ee40fb1eda1af0710bf4c76683fa07a0d6f25d4e309f3cdf5b545bf91b65aa908a6cbac395e5d006b89fac908d08949dbcf08375035b058f6717ce9dfd233ccac5b2e7ae391f1650ad5819317ed2724240c67bb8f6619ac43288a1da274357b09c3ccfc1209f90fef80a04044d7307ccf1fd812fae2d06a9e0b84c192bff84d87c85cf6c5d5bc1b1771a46ab0d7f9d0bba8cafb7842fcfb4508e71901fc2402acca29ad7e1936d3b461be5bc3b3ac7b9010850c0b01c91a40161b36e535e3573b2fee79668f3c0fc3a3ed29d3c175d468dc6138cee8a9c4f9f7b8f0453ed5b0c9fa783de23c0c2f8ada69de2113a95fa9745d85536703510e2a79b4eabd722f731978d0470461e447e21f6c4c22f51aa52b495eb708b9458ee781cd4694c0a311910d4a867b605a56ba653dc4be045644f97be7c865800c3657b84b09ab59f33c20ee7baea18d7e1e31e3f72490812218a1299f92414da4e4a59a7487a2e1d2d2770897a17a8f3ac344695b9fd8d05b84d1fdd12938b580e08a1524eb1469a4780b8a8d367c7434adc0bb67e7e5142691aaaa29c23ebbc3392890a5d268d560a4d600e0f9ae68d315bfee9547bd3df135b3a7a3b390905a9ff163fba3ee03b34c6c43b4ac55741ee48cfc007349b23dd5b2ba2193c74968b53d712a4abd9089a116b4cbc5a21cdfde022e9432021ea83de49ada40b50b361580871ef584848b4c071c971df2673f0b761eba494dda7a8898e1bef7cbd22585ffaa5a34d0817ee470a2b77a0a28e34172216dfcd93f155be9481fa1eb2a0e501606223e9973ddc6cf6ae0505a11884e1767074cdcdf4e34492501f87935a4916a581b5b59395330d0b16d60d97c444eefc683c8d42022aba95d36ba9002831404f949517542be586a0449cbb517fd322f94a1ae0743eee8333c3e980403f378e48829d06acb4763740096ed4bbca3d4dce9f3b8e78e542129cfbf958767a7da3082e2f6f7651575f660a308fd6deaf8deda75713380acf91d53cd043c34adda86e5fbfb3a07544f951dbc8ff6d88ab5da6935361f080337d34df6f5add4af2ab3c941f6709d239e3246660dfb64e73bae356df4173444bd1565a9ec5da6d58a69ccb634d057b58e0fd4314fbd42894b9815ff7e6db153b92e9ff45efc94432bdb961f6154e0030b1a6a5c916dcc5ef5ce4140bed0c1d54989192f37c013b609651cce0c70b7339ff39f0f5eccd4cc77af3b72632c0ec93e7a710c0f78877d7c43d9e0bac5be0353506df78cbc09469c928589e8f6d9d8f6efeace0510fb4025a38a85e60c5f3deb5e03bead1799748bf0066afe5971003e50308e53d7264de31b7f6a151b085852bcb5d0004540b3db0ad5267122bc35b4cf13b869b89a238cd4ac56be180fc4b89d72bb8bc7ba63daec125a57e6cd98b1a3aea1ce2f5e191c203bf44dca214568bc48d32a61b9494f61cd58fc7da152fb2370e7fa18661398945c4adeb0e8e1a25639bd49ffb6db0ae57898497f99a6efd265fd7468695887264ba9b767ed54c4a3f63e0a445c8779f90dec9057f6b18331c33311e3530bbc81679003cd8038401e93a6f4a91f43bb16d253166f592f0886f98bfadc66786c6c5bc998080f6a992b63d9c379714823a28911b2dd8d01e08414c4adcff7dcf4e4b312166f0751d6232efd9c714f4d777efb228404e633c6d3c937ad9b3b30f6f0e6902102f0a4f4a2e9b70b212abed9f496fc42b02cb98d4524466cda8d1d35a50d39e14b5083d65dd6f501a236f1cab70d035895210c2c84678ec1aabdf8381b76bc6d0f071384a38e69628378bb0c73bc46efbdb96014529d95de41e89b00107baebf1d5a7a0a67a6d6de808142bc68935216ec25f473947a577ebe4d7463f31f3b3ac821aedce2a7e1a582ba5fce12e351f11d9a6600c3fb74d505a1842f6cbfb0b618c43ce19ac7a29b0c43302af78e435021b011116cb0615a6798ca24660c7675e78208fb1c11d6add4d7bd11732c797dbaf97cc592842d0797b6e9d5c7e816913ad6741e5fe87d6dce22d4058205b707d3a9d8cb3e2afed214eb783ed83e16cd1dd956e986fbe50b93e73119c8dc55f69c01f46f5f92ffce94d32d008945cc7fddeffa7d524e9c4298c9ae3d75273fca49244a54b5ddfaba1a13818ebe4d371144ee90c12839e37a92c9549ac13175796f5850cbb2de7502d27543e16c539bc4be3bbbb8d3bf9b0dff507322f254007501c3fae2b25878261fa0778b1ddb482d78ad41ae6a022c2e92e5afb88871fe4bb938308bcbec8c457c0475fe6d94a71ae0bd406f1215e8bedb2f54fe68f43296bad341c7c7fd2bba3ad7cbb7d58c4d0cc6fb722ace060b4f90b77fd2a8e2cd47f50cbaca3d4c75ffbbcb7545b7689e077f50608601f854200331e3568e0b4775e7c887e77012fd80c711e5b355c51f90917989d73307112723d7fed375251316735aa2e17b4af05e7e8b913950e8480b42aca32cd02cfb9fbfbe7d386764b7e1a20bfa5726f2a3228f834dd4e8b48c61e34ee81b01cf6896e01556878060f28a4cd2d956886690164cb2bdd221f0bf6a38478c28cd8222cb4f1fb12eeaef2c1b2fe9ce5405850b633e388188db2fb8ddef13bbfd757da0bbdc968e4980e8b4a6aea94e72cfab55b18d2e79d9fa07c599e17c84f028aee578266b328e173a85c62f1f47f7248ef5ea3d80ebea1dcd11e394d321a9f1f0a124871ac437d5940bf882d9558c769d68bebe1802a6c6a1acc02a4fa96badbb8871d69b1072a840bffd36ccc8b88b66627c5c338673a1d5742f6f92d808bfbca58e17ea9082b3617bd2c43e47a1b10ef2666923615faa7024c9bb297c72250873d4c5ea732ef42512c48846cf41c0e176f7422c49ace794a3ea93a1291ea7c5b8821dc9e5c076ad1c21d016f590b05884d3589743624d12ac1609d74dce1988ecd92a5b3df9a3d0c4648d39d71e5fc6fd8c9b89e78e56ca834a40c72c03139f7d9dae6bd31988a383b4be1fafa28ed150d2881add45826060e48ee730d3304b2dd6db90191d017e480900efe4227ebf2a9b2aa4434a233db9b3e3047a0707a1ab11e3324d90e45ee5b3551ac1a5bd5adbd3e1c8a9518db665b7b7bd2496836be526dea4f197afc1be592561e660d3e3b2105f67c4ac70ba17bd952ae011cf89850cf4d8064ff57ded0df14facf3cbb7fe30b0b9d7720ed01669e25f5bfd2948a155b90864df651c2739a5e61a3eeb5b30e10b8129d01e3daf8297701c7bf9bab6d85c606821e6e5c03d695b8f879e789cf777bab3a066a22cc4c715e4baa7bfc927239c210148b5523ea622550d09ba61cd7992640ff4cd6fe00323567dabc58fd5c71bf6c144c40b1f685d40d46bed92e81c5a88f5b6f0d6056e8e21c08ed12e609ba7fd2db17a69d6efc0bcfa223e67917b54511141258a0548d6f72f1431d372159d9356c0951dad6fe9abecf5ed8b0c5b1aa2448542c13e37dd0989213586b91f74c1e4311deeefd9bf39a0346038319903b6923e075e003800d5b0208e14d81081bc84458e384c54f1d9301ef286ef12d74a875033cb4a705f0384f0ff65bbdd4e892fa927963421885aab4427bd782fc0bce5f9486c2fa54c9b9079589c7e09559bea9b743dc4299502c69722120ee396d206a19d2747f1fc2130e3384e39bad577c07c97456228fa4450b653b1a03f4fb2c744a350f9682cbd0373522acdedffd0ddfb583ce2b3050b3523663500b6e0ea095db2fcd68edd297a80675bec234d632f2d8dd0e543dacffe3803b6850c5f35933b710972652a7a85043f8181bdb5df2895e4e92ea7c22bd2918f0265b36f15b06ebc98c918744229afa46a8da47dc46b2ba0a16dc1db4a9a1c8e6230c250cde8cbf90fb441343a27ab9b5bbc1e4cd23f7c02063727d6025170f83d1207a1494456e946121ccc2a2061bf7c118d56f06b9824ee81afde421c12e96f63d520d13ab329a346c24172351f467896aa6c9b5dc67334c3f71fcfa6c1c8a05ed9f0270ea187a7085b8a54927c51edb4c5b9bf9fb4e5065f8980aff7c080027e1f56256631642f875348b618d792f092eb7f3c795dc57fb1923c790a7cb44848893f103a3f8acdea7969117bdbcf59c012f0605624d6102cf2ee941ff9d15473ef28e3a512dc55314d6888b91c10d0fa1fe637e348ca002c9272977ffbee5059b20fbf20f8fc5c59ef12a141865a9fa97818e222df0a0e1b801c2d23b9173e96739b60ccdafca21f7bbdb36b2f49e199c8e93674abc1b1fb365a9a3672587e1939cb213ad1876c723187d0b4a67e859e817ec91b8c58769aaf78e0ec2111f52b3f0355d3c36f2eaaeb342481ccaa90af38e6abe3e8514caf26df8d2b35e50031b1482ac59e32cba0dddc79a481949e408a496f47dff89019e7d8a71770366354e55bc383ae3c1f9c8199b0a8da38651a84a3eda6af4fa7e8b50da53f2e17febc8b64563a416a50067e98615de6e2937d1ef0a0240782cc4594e9aaa9a749e4c5278e9324d3f84e6e800519072d9494ecfd5a58176dd5a6aa4e0d6b37c1fd128747664fec2f191a6394eea0d829eb5a056c3129c769c9a946d5c55ff1262020e541e6f44a4092dea258d18ed3b23593dc793af8c4fce492c6fad334e59fd967541b1a559513ce47f5198f21236ff689fe1b6744e1ffc159cc97bd00b6cb45a3a8fe1b4fc5cc2fdafb68dcd9363fefc3a960b3ad29aa494f56ccf358505f060be03cf87ca2f955fabcede3fcf277555638fbfb25d2d7c8cf5ba6791a046ec293a7f46cd111128655ac2a881a1775c579522d8c76911b1c02df74bf43b7916928e3d8c507892965baa6317331f1266969f1f7ad4a99926c4c8c3422f9bf629cae24e20b1f351276d116ec76f3f7dac71c740ed4ef602979c4908969e71b776f13eb6e31571ba2bbc3ba2d99766d05cbaa2ba3752a9ec4f39006f03c6ec93c8cdd08ae5ca30f85de92c7ea2bd1ac23137af46a29c809af4c762d34e77ed858df2c96943c500fa12d49d18c42e7908c6c572ddc8f104b6e86184382b35233804989a949ed0e8edf8a7b67c19184f1ba0eaaa11389fe63e297a32827dbf58eba334b6573b206d5c2d294df15f8a136cde3f39201e91dab951f09295a763437ff9b974fac6df5e0fa926e8ecf7da85be6cc210560780196219177c7fd4ac5acb2aa16b4be63ce8e1a723687f3549e41535ce7f0db0fa9da308498ef32b73785f5ce72b954a54356941f84a8ae6906296c342d9146dd0758390de7f29792f9c440ec4b011bf2fcb1f7d0eadc15d1f2f53405e28948d58c4b208703adada2fe7131524ef2ee3a66991dd360acf2bc44daca6aebf539b6039275e5a8b8d17e5f3b613ab694baecaae4d7515f8e9c0a9294ba0a3487875a12485418484dbcd6c8ffdcdfe72ab442e1ebaf70d2fae549b69c52319bc068d5cff8843f99bb68fc7a621e8ec8d565d137239c77a252aa132b9af893688fdc579d3a2a25a6fb5996aa1b1c444fdd2057684c46ae400c448e92a48b070b531fbc3f06f15654c669d22971d1b410aad53fd54c83d31305b82fbb34318868553e97070f7b6d079002a5d622d94b9ffb23d124f8c58d9bbd44661254274c6d3126ec7da5216d8c744f80dc6b512f3857d459b2ce0dabf1afdcede4e72af3bd3972f11ab2b3ac49c1235b12ff4ec5dee15bbf8a0c2702f8dd05c56f8318e5393238bb7f47758a748b22a7b9bda83de824562f10c041c6b95841ea1e056316639d50af0b16610de957aa721dd2955819e5e71a23e643e067924cb7da05645a2dacc2a9a694c874048c3771614f6ef913cbff953198b45818b9344fab62b028200dc36c9b48477c3dab8188d136442c108bbe72a2b4bfbe083208e6b635f5ac64ae867e89b495fab7861ef53cb97e7d3fc5752a56816377f419eedb7095e722b2e839a8f89e52f096a139780f5487b986efbe0f8c4d9baea5ac04ff0b79c0cb3c8eb00f1350b3f5ad3d864fba29a68c5f635b072f41c0242a1e0e97f7597d8700d5c54b95b665c6f9cafe294b737cca98278eb795b7bf30ed9fd495149763a1bbcc7eefce5be1e18a1e1742bc96e033446c036b7842ea902f04e4c32ea74cbaa44ba21991f0c5b17e4a75b6830459c3cd3679c3f0e9632e2abcc18d264877ec84623d8baea27af0c58da00b400a380064239deabd9cf28589edb395144178af6262508983dbddf820d1750560ea002893d03ca995d7c64160751e30ea256166754be96281e1c4d71e684f319c1836fdd8ffd8f4e605ac49a26580b7507d6712a0708079cd107a799d210c103eff1bddc1df2aba3407a415f49d9c2326d39c5794ffe77b53e6fb09cdb3903904b9b4745e5a4b0b527438f3a2f14fea5e342c366bd6c2f8b0cb46e15c0d531f23733747e10e1af1ee5097c266ef075df8b1b7704f5d7695d4fdcb238c8fe38d509e5866365d86d245eecfd1e855e1caff305aed9693974ae8259236dd2f8a633b79039f6658bcb117f3e8c7963d3449cf3","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
