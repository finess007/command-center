<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phrasal Verbs Progress</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 2rem; }
        .subtitle { text-align: center; color: #888; margin-bottom: 24px; }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        .stat-value { font-size: 2rem; font-weight: 700; }
        .stat-label { color: #888; font-size: 0.85rem; }
        .streak { color: #f59e0b; }
        
        .progress-bar {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            height: 32px;
            display: flex;
            overflow: hidden;
            margin-bottom: 24px;
        }
        .progress-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: #fff;
            min-width: 30px;
        }
        .seg-box0 { background: #ef4444; }
        .seg-box1 { background: #f97316; }
        .seg-box2 { background: #eab308; }
        .seg-box3 { background: #84cc16; }
        .seg-box4 { background: #22c55e; }
        .seg-box5 { background: #10b981; }
        
        .section-title {
            font-size: 1.25rem;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .leitner-boxes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-bottom: 24px;
        }
        .leitner-box {
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
            padding: 12px;
        }
        .box-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }
        .box-title { font-weight: 600; font-size: 0.9rem; }
        .box-count {
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        .box-interval { font-size: 0.75rem; color: #666; }
        
        .info-box {
            background: rgba(139, 92, 246, 0.1);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            text-align: center;
        }
        .info-box p { color: #a78bfa; margin-bottom: 8px; }
        .info-box .emoji { font-size: 2rem; margin-bottom: 8px; }
        
        .sessions-section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
        }
        .session-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .session-item:last-child { border-bottom: none; }
        .session-date { color: #888; }
        .session-score { font-weight: 600; }
        .session-score.good { color: #22c55e; }
        .session-score.ok { color: #eab308; }
        .session-score.needs-work { color: #ef4444; }
        
        .footer {
            text-align: center;
            color: #555;
            font-size: 0.8rem;
            margin-top: 32px;
        }
        
        @media (max-width: 600px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ Phrasal Verbs Progress</h1>
        <p class="subtitle">400 essential phrasal verbs â€¢ Leitner spaced repetition</p>
        
        <div class="info-box">
            <div class="emoji">ðŸ’¬</div>
            <p><strong>Practice happens in Telegram with Nova</strong></p>
            <p style="font-size: 0.85rem; color: #888;">This page shows your progress. Drills are done in chat!</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value" id="totalVerbs">400</div>
                <div class="stat-label">Total Verbs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="masteredCount">0</div>
                <div class="stat-label">Mastered</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="dueToday">0</div>
                <div class="stat-label">Due Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="accuracy">â€”</div>
                <div class="stat-label">Accuracy</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="sessions">0</div>
                <div class="stat-label">Sessions</div>
            </div>
            <div class="stat-card">
                <div class="stat-value streak" id="streak">0</div>
                <div class="stat-label">ðŸ”¥ Streak</div>
            </div>
        </div>
        
        <div class="section-title">ðŸ“Š Mastery Progress</div>
        <div class="progress-bar" id="progressBar"></div>
        
        <div class="section-title">ðŸ“¦ Leitner Boxes</div>
        <div class="leitner-boxes" id="leitnerBoxes"></div>
        
        <div class="sessions-section" id="sessionsSection" style="display: none;">
            <div class="section-title">ðŸ“œ Recent Sessions</div>
            <div id="sessionsList"></div>
        </div>
        
        <div class="footer">
            Progress synced from Nova âœ¨ â€¢ Last updated: <span id="lastUpdated">â€”</span>
        </div>
    </div>
    
    <script>
        async function loadData() {
            try {
                const response = await fetch('phrasal-verbs-full.json');
                const data = await response.json();
                
                // Calculate stats
                const boxCounts = [0, 0, 0, 0, 0, 0];
                const now = Date.now();
                let dueCount = 0;
                
                data.verbs.forEach(v => {
                    const box = v.box || 0;
                    boxCounts[box]++;
                    if (box === 0 || !v.nextReview || new Date(v.nextReview).getTime() <= now) {
                        dueCount++;
                    }
                });
                
                const total = data.verbs.length;
                const mastered = boxCounts[5];
                const stats = data.stats || {};
                const accuracy = stats.totalQuestions > 0 
                    ? Math.round((stats.totalCorrect / stats.totalQuestions) * 100) + '%'
                    : 'â€”';
                
                // Update display
                document.getElementById('totalVerbs').textContent = total;
                document.getElementById('masteredCount').textContent = mastered;
                document.getElementById('dueToday').textContent = dueCount;
                document.getElementById('accuracy').textContent = accuracy;
                document.getElementById('sessions').textContent = stats.totalSessions || 0;
                document.getElementById('streak').textContent = stats.currentStreak || 0;
                document.getElementById('lastUpdated').textContent = data.lastUpdated 
                    ? new Date(data.lastUpdated).toLocaleDateString() 
                    : 'â€”';
                
                // Progress bar
                document.getElementById('progressBar').innerHTML = boxCounts.map((count, i) => 
                    count > 0 ? `<div class="progress-segment seg-box${i}" style="width: ${(count/total)*100}%">${count}</div>` : ''
                ).join('');
                
                // Leitner boxes
                const boxLabels = ['Box 0: New', 'Box 1: 1 day', 'Box 2: 3 days', 'Box 3: 1 week', 'Box 4: 2 weeks', 'Box 5: Mastered'];
                document.getElementById('leitnerBoxes').innerHTML = boxLabels.map((label, i) => `
                    <div class="leitner-box">
                        <div class="box-header">
                            <span class="box-title">${label.split(':')[0]}</span>
                            <span class="box-count">${boxCounts[i]}</span>
                        </div>
                        <div class="box-interval">${label.split(':')[1] || ''}</div>
                    </div>
                `).join('');
                
            } catch (e) {
                console.error('Failed to load data:', e);
            }
        }
        
        loadData();
    </script>
</body>
</html>
