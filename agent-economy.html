<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"1ee1c162a99f0e0cf68368f6ed79156e632455427a81b10307f2bb22c30d6611bd68ff380a64b7d9ec63b60bf47a00697094a283e99404e5df47b52a73b03304e392ef2c18079247a21d286922c0763a9cc413ee4348bbd39fc3191c307c080f168ea9f0814f24ac9839dfebe60dd26f7042e52851645199ac3ab9f1b3abb5688e956007b9392bc49ba442e58103db7278636e573c24a7c20b2f06972817d70a11339309c8de864c4c8c0a615ec23c9bbb33161f56040aed1a00a9e5d48636bf1bc9aaaa6ecbd5056049cbcedd52cc15198378fb7434685498f274f9dfc651a2622765a32d5769dc1e8fb8bd9a5243e9cdb0ed0e82edd3fc08915c599c067b995a1281acba5bbf8b7e84aea4946b858bee4bacb5505be41f3a57b1f53f1e3f8927b571bc183ef4d16d7916167ef3a271577cd363e853be3e5b3fd3beb45280752f816bfa0cc0ae650624c7ff6a4b10aab8aa0a3fbbb5aa4a369f4ce82e15e691912343b4fd7b18647319330d295d67c3bd0db2279bc71c02e6b55d01ebf7627d0fa83c7213270cae7eade33e309302a1eb51faed5b2b1e1077ee7a5598af1f238909ba89cf6fab2e6b4c0966ae901042e8c508509fd28754c743cdff1ca7f8cf47a50f8ccce7a35641a3af6ad22ce9ce33e305a3251ef5c90595b3f8f8972e9309b350a49a54a9d4b6510d100ccb100d56cf034d22b74ae10a37fdc01dfae70be696a737bf164753b7e9da2bccca4cef34c05c38b38530c570d1c1f9986c77258981a5a88780b9f552d146fbeb79033e68810abbaac9d5e5c5df98ebc9bc17f5858b14a3dadfe6b913526b24d845fe7481fe43fb2603b26cb3e47a4103c39aa9b84f8e6e22dc80584cfde32665f1699e5e9003827f1a0ee12658d58ee01a1a8e2ae67771d48d64c04b960aa21fdf908627480dbe6dfb563c0ec2bbb0bfeae331aff076fcd711832d6c29e394baf766448b191bc9c9974bb10db8acb2f120150e5a7a25a30f036bbd4eab589b0647c78f0eeb599caef234b2a1c8a5aa2f20bec7212cfc8eea3564faef8b38d9e83ab10f88453eb22729947063ee455f57f21e1ce61bad6039da742816d552bc32acdc1a681c3d7cb2ecdb039c4d063e5518d5ae122b05248772543bde63e10aa35bd490c0fc7e250d774bf899918feb8a59e6ad509a72f2c2f8af4c9d67bce6ba7abf0bb58c51a203b62a34e80d36819c6c71108cc870ca4d292934a9014e40cf5f3885a014451c23441b82723ac7f251f5552a5f299f76736fbd5a162343da098a8d6bfc5a7b3962bf7e89a8b6b42e330cdf7a33d6901d24417d93303f314d1acc329dae833cbce7a203f9dc0b9fb8579c4de7c04a4e7943f9103cedf56ddee0dc00de9c7bf64c51988a12c77aa3615323fbc37a54293aff3bac1967e722519017057a8ace6203fd156b42d019e90717ab5f151a9c41bc8220a1bb2cb0653d8535f502a6223b3bac556a54b422151d1b090ceeafb1fd27aa9ebe4c3034db8ad1cf4cbacde2746ddffbfd92fae3482b302bf20632c08d3884635d4ab67b135f400bc196162a3782faae7f84deae8e551485c05576b9324f604c99e7c6a18586a6fbcd595fcb3a5f73a6634e54380fd1d711ea78a9f3b840d214e12e5fec8ee847608496018b968b2df5060350e2c6797b88f1fada37f81a8c1162c03e2768e4f9ff0ecba1d9fb17b49b7bf1652eccd6671968cc9ea4e7563a103b13f7076b5396a7a146aa5677212a5d4aef0c9852944314c2998f7e5bbdacab313b3737ca16bc84862bd7554d8d478768cdba7267ee9fa6f399a115363ad7b81a832eabf8600d7469b3f11ab84e43ffd24636a268ea7492d3640198aa125080a83d4d391047e4983ec0ecd42137106af1fed7958a3589120350ea794c9da8d4bb2778cee542441f841933dca7a5be08e40842a0426b62936010f2c9002d5063677eb3c5f3d843ed213750d2678f5a9e21c1a276ca5a491693cef0cd12aa1ddf14f174d8e4f55098abcdd92973d0c3d4b4c34f35f8e68043dd15bebbc64eec8a5ea661338be1c7b526b1df22fbd90e547059349b898402ac1cc3714898caeec0d4544c82e5371cf8d9b1675e4dd9a4033f88b1090ee14da9aad067a444841709eecdd139c96668e20a501a1054b836466d7af96d08b2c12c8de8db81fed9d2299c6d62bc5e885609a0b23b2a37eaf395c048910962036903b222d66f38fb0911220576e89eb9f5d73b935655f709025e53b5a3457dbfddcb182a5ce36db14803b3211f51d21a049495bb27b671199c0ddcb453fa739bd1d307fc8a05f2cecd02cc2c325ab8acd4a6d2153d14404bf34007ef95caa0353e614c368ab57233ec9d07cc8a59816f8f6815564a6c46155d024b85c045fab45b0877700070624798c2fb11f10a6bb7e005395efcb68b0569117862ded2dc5304ece4dba47b1472802613e3f9361ac033f27757b47c45c309d13d374e8d3a46a013924bd3bc5dca3338b433156b75a47f30f278ae5796761f22bb2103762e45a6fc3ef50ad49db7e926d3514ce0418b135ba32a0b06b93918c825f43a88740a6757097dcf3642a6d6e7cf8f9af8bb4aed810736b213bca06102761cc59c49add5155cafe6e547cd964fdfb4e4988404d9d13b338ddd71550500cf0a5bbe943f548c569df368222ba1d6f122b70b63bc11895030648ba10451bb0de6d6175aaa495311009027d9f8bbff4c160abc241a8dc9ff41e78154abe4951a78bc6e2e40ace9b75eccd524ac768937daea24d08b449e8b3819e77c7b5395e211002d9ed155735dc072e74bdaebf5a7018dfb60c68c1d53029879090bfde5779828858b0db5cb06e9526b06e418e37de41492dc6315329c8223709ab33444f361b3f20bdbf24910a5fa629ffb6c64d3255c35b354e1626fee83b0e229add0502e3c0baf4e08a3a58251402849a3cea5bdce3c31305c7461148979e9b31b86d0bb2afa056ac0184dc3831450d9bfe333ec9fa578e21b0ea18ece9d0b2f623d58bb369033a17fff340e44aeb639bee70928d7371962fd60fa12aa327e681d88f24e029087ecb7d1c02484d6cc3b7fd57b0e02f4c9483ca997433c668f93632926b97a629b751b13823c883c7f7ecbd5460ef17db7e7e077bdfad7dd67026f44febb7f4dadb3fa50c665561cbf1de74e5765124f40fc7fe09b8a6ef404b26bbc7c5c1dea7966470d992f29ca1bbb4567a5994be700fd2a27e8326dca3cbc745f758e5e4627a46a65ab5c8ea3ac7b76d2657fe89cabe91aa69ba2c97a759f909284da39b8d0bda99c05c8a07b78b63daa72c485152583c27ef600cf5002958340188f4b7d396392556d4e94089e559e55614f3995d9c25acfcb05de2fd7b7cd4363396530998f5913fa6cebcec904103d2d9fface7237f2550cd4e7972b907eb1b7a23324a2acd134b829ce883630bf860e46a6a39e0092834ce57ba120282b35f33e5fdfe9ce5e0242898c53ed12f1a93c781ad1bd2d434cb01cc4ea647c2f32f2c1d12209dbc2b777c5cdfda6653677c65f97d8c3379de0e1070cb7acf0c2c5ffb37bf8615f6c170ffe051f6a97d17c3da0078540d5b49dd39e6c83c58df05714283dd18625f483d0613049472d582836b57b34fd5f50327ec98aaaf5abbbc5fc78f969c329f28df82f1417a211acdf8664147c288b6a442ccce6fcf8882c292327a8b98a01878824ebb208c6e0f2f7ca5ec55aca3149b6e35526221ba1d1fc3ce724828195b1c107c311cd64c37906825f09cdcf2973f0e28568ff5b4aedaf1045f17ad2234e593f533e4eb237824758536a6dbcae4d57bf87ed97d08c8f2bd3096c3f4091a555c39ba7d58f39f302bd04848c7348edf8dd7bba75433b5be7f4b64e8feab8cdd879198292b846a1ef795c8839bcc9412a6bb6b28fe45b9db2aadb87118329ec086b746c93543464fe6bff89ad720ae7c2d6f0f7a215bf3d7afe8d66de9b17310095e5f2da224caa1a1875d05ff54717660a14b931812d2397a0f6c80b559789d0599300929e8cbc9aa9d26a2d14fc92022bc28346550ae5c9983bf52441918b8a7fd906a0da7e097c4853e03f5342922ca6d826e96477499bfa8d5cbebb9a6032282ed33881a2b87911df305e580c87eba982f876abeec516ef115aebc23ac899fd43433c290293dabad308c239b260cc4eab6b6cc28e629584bdb6106adbfbd4b8a56dc61c297c3c353c62fddd26073a69a2d51e05db8d4f82f99e0e11d3d9b47ca3e2523d5a6c4c5336eebdff277e43e7617b9f23ae0a4ec0247d36962952544bf1bb6ed71dff92b8ee155e364a9e1d84d3d5e858f59e740a4b771b0da38f74db3ad53adfa50715f5a73f4d523f02b152085ce00d6ffb9590c2799f718ac2168bf58f01ad7b4555c85d8d877a3c584d145f09e83fb1447b0330375bae154b9bf92cf91275a709c4a216ead9f0fd9262a37191d09cd1b0fe3320d9c3583c9e192da363d57dc1ac26424d758473708016299eac6626f2a48086a2f6d298270899e25179019ef1fa0d9abca1b67c66a2fdf55125ffa4545ade23187c6f64c17663abba38b325c89ec861dbbe42175cc758923f8a841d49e12e3fc41551c31140c0dfa2ae687261bf92ffcf4d16e28c21a691f169435db62dc87a65a20274359a67e4c856d33d1519b07662916aa2ea21d4556310629d22c1bbc84cf4db2ef1f730cd5fc00a568ca267e9d592f42b67cbe34eb1a391b014de4186ff351c75daa69661c18bcc6dd145f44d821e223cef2c5847f57394452ecd7f82993f350b37499c9e0edcd8ee078a98cb182142aa1a1649934313661e08a136a78906f46ff8c52d0f748a0538c1a08b7ab9ceb60a9ecbdf3aa84ca9e68672b4be94b6891fb75e6750887ceb4dabb897726ac1d3fe57351e63f3cddff9c820eeb8e41c004fcc9224b0c5d4c3d8e8aab75d3058013c82bc90c395edd90b7891bfc9d581177f0bb0faddddd8d828e9d84081b05e0aaf66405b6c32822ad7f8630ab9e52f736bb7ea6d6aef019af1cd95b1e0a681e388e22755f459ba2ed74db2f8d09e5defa2516140ccfd350a7a88372437d5a6fa1c9d32bf1f692b54c1ccd43037f77dadfd11fdf3c181b1920a09b8fc03606c0edd82e4be66ef29105040574847528f012bbb19d509aa8cfaa6d4a85b059761fa7b0e1141d1036192ba1582cdec62ccd51d7daa8b241899baf7c03ac1f05a3fb522909d0098be40c0953e79c6aac2254368a35bd5360171298eddd38bdc18cdaad93ebe69f25ee8f6df28908c4896e0e5a321c50ecc97a1620a42a424feccc96a6b228290b63e259d79d5d55378c5d3edd02a06cb6e396aa2bbd70042f0b085ddaaca8c44ec9d8aa85f852de022daa43808e2d577fbbe57a660ead619a35ff8ed3fe1e6ce2ba3472c1a1ce8203e098bc640e632609a799d762395f20fe50353dfbd2be85ce248e21ea76b8445a1073157623ad6d8dcbad9cdf4f0507c9a1c0ff4c023bb3a46d1b0967191651a5cede7da5b25be4b4d3f393031ef5295254c1fbab330f742458bd7274a658e0628e1bcd37f56f31d0cdb62ffeced2c7061b9fbd260c3de43ea8ff353eb28111cdfa58afbafa00f69664d5d5c7921b325465889d932edd5983e80fb5f949f81e4db245c5b55b84a30ec0bbce2becc400380dc16862829078e35e2776edc3d2a64ad1e84825e32d7971bff271168508c2bcebb0b9004d90c66b637924a9a38a12a55ac1523e0823fdfc65ba39f8bcb46cf1c486af2d1d62958f109a08208fbbf412709e0f50cb58ed99736805e47c834a7a6c6a5653b49db9104b7c2195600cc2dd7eb8600b0f0db60b2c0409bba63a5fbf948f62b1607cc24041bdf77b1f9d5a5f6e686a24b8f2391b7bfb42558dfbda2ac6b4614292272226ccf887cee538f02c2d20fe4c829201fd6019d280fa726d11122fe376d199ed079d8fcb562732b4bda52306acc240f802628400b96ba8f5c4aa80c74866261c63f0247ab6ffbe027aee0ff0bd4a995bec46d2048be0ce4bdb3fba4ba117fcbd8612a507af35c9db3434849b4eeb7af51159659d6ad92df12551c9c62fe979b60d2bd31cb377a51d092f60729e1e2a39bb0ed5b09bb83e3845fbe5bda9b67ececefbae4d14c8612570184c5711d8ea33642d1cec8a3a780d9121c8cb16ca1e282578431e64074cfd1c426af4be19b0951e42c6d2f78810c6ed6b212b52fe5fcffb13c5e9115c31d885429de437a649b10dc0a49a7b3deb6d7e6438c28765b8dd4f7ac7b98d5c6a35fbe1ec318fa0e4e330c0764d8abdaf5e95195885a372c8935398b42acab8feb8acc1621b40a733c63591cce9ab195bdc4975ac3fd888a927b30b59843ce241c6b7d5e3f4724c5e7b01f642864f5abbdad809e0f7eeb4359679e388437892bf670d91ef29ab2b609fa89a40ed59005d4b85c635832e4293de941badb6c208e47260bb05718956c27287fdc011d415e347c03906eee5a8d7b4b6295dd6b770598a3769a7d04582f60ffd302b20ea9785783eedcd1c1ec812aab66ced2ae1c2b4defc0ab33b951ec8b341a49202cecb84b4be2ea1908865f6352b2e37ce787ffdc34f16d1d216c57fac20d2afc3bfbcbf89b7a736df278370372ff6e2a722cee6df37fd676b8b8669f8dae51735a6e0558914896a773204abe3943ddfe8e19af669d51f247264a7589617423344d7dbf4d8f221286a7d0f0d992fe5fb271d0e118a048e006547cf74dd793818fb0d52528cc85a2127ef57e5390373f73e035066d3594ce9066f8274b9fd7c6b3f3e3d966b9c18e0c8734d2a3599fcb77d78901228376fb121814f828745ea031a25d8a48ecc5a9ba59968e7af7acaa3e31ab9ea257811454814e0a6928a816d8814c8350b7a175a2f6cb48e511c6755a5d8c8f671c75be23192956c969f061ab36a345957792e58af66ca05a1f7a410a22c1c2ca688536f4b45644076950adb42eea9da12546a61be1e6d3fcc94d698b8d5f610fe3d0d07415b3d90be13933443f4b6b4d8a6cce1e7fadefebaa301a72fdd19c02dd22fd2d3853f3e99a11d6f931fca6fd4b9497b4f4c83051e21a666aa276e6cf4f2d3fa9f5aed3d8073f80de0332d06edb35f49067fee1a47da2087ed11a313cf3378860fd7f3e453751a8845d568083f003e169721b93e7151ddd363239fa6ebef152db179d1f13dd60fad27c818418691303203c416379abd29761e44eac3b9b04029f09e345fe3cb8acfec5cb90aec53368b7314d2bd47dd4bf7c505679673690701a0f37e3b5a7dbfe2cc8f8ebbda67482f15450722b1e433cf2524f0575dd73b1c9e42e9d33ddef94f7704dcaeca5fa021c4ba5daf224132135f67e63a6e8780b77c6475d5b78e4f7869696489137a205c7d0d1a43ae5bcfd3828ccbf9bf3e28651b4ecddce707f5563bb7fe40f376817589fd51717124b902e66c8216cb151edbb5677ce2bae8269024abcd259a6493de436f948164a9856dc2f7a95cd4538a55b98dd1ddfd8515f8707827abefd812ed492cc77e9590e0f46a6dd57eb9a20d8d3ea5f69d5a258c49c2d32bb648fac386d353da0cdb1c586f6abae25d8a4130758e418b2fb2f2f781a31beefda34d90c21558a49e4d4ee3e6eeae773fa05f757dfdcbea4fb82f74831f3b9a8767f28e44e6d2f39346bab7e0f0de4e76863a52fa20d7cadc431e9140e244b7ca384babf4a120180ab09aa82f096611c1b6d34c1378fd20a179dd526611e5c455593115b925c0fc0058f1ed67ee4cafe4d45f01bf0d718c3b52a274678a421bafee0fc37c6b60ccef66199b2a09a03d962ae2e456e8eac5e8e85d6d3fc71263009d10b2f66bf4461b778a7fece8ee9e0e83aa01a8eb6fb46b47d7f19461b21aa7dcb68a6103e2ca6ccc0873659869646434948bdecbb445434dd1b9e454dccc8e86c8fcc2c990e8bacd4325444d7cbe33bb5cdbfc9885ccdb1fe4cedbd2a0d281d18005410cf8354189f98a7ef3092182a4c63e3d2766b6e456c361253ba2788c9f878795e01c58bf861e3725d860a55ff3a6a30f883552e96926a0c472f15520fd53e189b37dfef760f89f5452bc03ac92a9353a3734d78e696afa953c6d33fe2678ade4e4aeca4b99e8c52259f6d2e39dbda5deb4b59675bb6e51fa5209815afd8698a777e6628487bfde8384214e92638b3be2a4e463309c95aa63fa42d39fbfffbea1dc7faa8ba00d52c29bb0d916b54bd7bfc72f7a2c686c53bc285e9949af31d85af4d9f0ae43b1534ab3ea9d5f0917ac31d5e92c41e2991a2ea43e800d6008f2379cf794dc7da9de23360d55875b2e5d96d04dbfd435ebc0848375c066e006769130cc9dd74b5ec8223eb853f23cd533fe958919c05d7436b92f50bbac006c33abb3b99716fd6742803faeebd6b70fbca5bb836a48a0f3759936ad75c3bfa1b0996508c073a64a7ae217d4afd020581f60e8d8417203d088e46104cfbca11f94a48af1a51b1b105fb60f9cbd987d1f30e1d7abb40b5ef125c0188538db64806eeceee4db068ebba5772415915d71943a13002483e9139e2f6adbe31df5a4308c1e4b916ca19d5d172207f251f8a2cdc180cc44cea2edb138061c1dc5a8324fff62963c9389156e5d63491246407ca0046afc44c8ee851cc0b47f0b784751b6cc920ffe77b136c1fb6d6003fce0638d8bcb9d6bba6687718832c2fa8b8b60265b4932638e3e5e6f85367553aac9697356ccca3a3ab791cf783b32d19b913bffb994a5432ad3127d7e3cce12086e45875cec2980c4a56057f1359c2053ec89c8587f967a2c9e1ad62d3dfa0b6a73510efe62cd3f3b83cd99dfc0b5ecf35165d07ac62669270402b08a51c5f011ebbecfc5c0957c90e48958a9c92a2300862a355b4cbfdb24efab0dbbbed2e9df6b7a4191235b4000c04b5e9fbe6c6f3174a891e0710b906d60b2fa45fd70a97a98250d45f930ccc99ad748c20a7a647f2439534da6bc43875612c041196313a2da36e811e69002416702cc91678042aa95f60a7fd90203897c172a465a9717403aaf25f2d86a778c7f104910b21012008b9c794dbd6df276990a5135abdbaa31f471023ede15f444a96462b8bc27296f4718e966eaa98d48804563e03a50fb67f9f83c28bc6753ea38889707282a00c7aef9abfc5d71c7dd955a9cafdf71326c033104dbc89fe353bd47db0a00352570c69f28402371760c46c9b5615f14a916c89b0c6b848c0c55c9948aef9623e99a20751af44055c21f7454235e417d3e422b62b3c472d390b91db42305e61cd162bd63cb18f3b9bde4ca989f292b3a0a19d90b2529fd3ac16260a437227cc260bcf00ec2518c570c9d9e3fdde963019517dd2941429348a4949ca0cc0ef0104f094cdd0629dff2c1dfe8a63004f99883b27da0796934d8864588ffb5ed04d81ec0ea87a9ed125b6dc7046517bb486324229e49d653b5d7806e11cbe7161f63e9d2f11f70545384a1aba1bad1481f98af9a6f353f1b9ca029f3a4cc42046acb309d588df9fa47fd5d87c3770a0aaaa2be7cbe21402f014980166c29dd6c0e71d81b5255e8fd13863c26fed761d5ec63736447e46cdfb6b095edf8898b8090c369339cc3ff7c127f97489f9124fefa5dc9e5dbd5cae48dc53157065b5a8d923028840ddd6f3d9c9c7ee93e40a016bc9b21d010f1248cf7ea5d38baf84efa8e31eac6250edda25829ad5e0645e5b291652f56e4b2fe1a5d900199071132199a0c03f52c045c637c16b8516926166f07b47fa90fd0cc7924b007ad4d7ef1ae240be3bbe471722eb3238f701d4051a24026bcb38da06889254002a823d34142d67283a258cc442f01dffd5d843a1f340d55f2ad0447ec03505df02a2b58bc7d816afa1c94f0e2dd989570f2d4ca9291be0ccfa2dc1956766249ccd31f002705dc4ae9cf178ee1aeb4319ac6cbea3b52ef093b61c30dd09b2fc211842a11928551ce11a860c23d4740dc707886656b67a3ea75b69d9123b3912d84f98fbeb3d5e2f3ef8b00ee25d48beaad31c9bd6981d50c3b4bb839a672d5da6c3d1c6793275ff10a494d46196308458c34386b11924bf040c9ec3f5e312fc6e8be2eb26871703227d2fb16b7aef0f0a7bc978a3ff1fe609dfe0d10cab4b1963f2a25996ef3495e224f2b9477c8cc8683a7f7baf8b0d24af437a58bfe4e568ccf27aeeaa538dfbd6d2bc7271f193bea889914f440c07d4b501d944b9a3814627d5fdffdcd88913ebb4e66aebd4cb0ec75213ac83f74a3e23619a6606539033ab00fd643a0f5aa090440345fcc9e8d830fa741ab5a1a4d43599ec18ca896ba505e1979c7e1351a3e77d15ce833580dd6f17422a2b0104dab1122af3c6cb1e39c7be957505c900a81c32fece6f765f3e3c6b9c20f62572b6d74671eeb607fd812a6e553931d9d86d4245a02cf524c699fa725573f0bde6f525b4b1c3aa15377860c21d5e6f4d90aebd60fb9162554012f0d090c48cf0e5d2f6ce620b928cae6e1f9bdf146da5b59498e161a31f41d76e5ec07ae2f0de1b7a4c3ee992d591222cafc2d0b9f153c1f33cdbbe78f739b750d390a8c1f9e6a070a156a5a5f67c41e1565777d3070aae8806b7571c35119fbc15781a3ff15bba63dd72c5ec852c1d49337bb2248a92a80a44d75e2d208babda20e2aa72b5812b7f9e7f54acd7c20aa0fe3f2e2a259139db58d24603d96924bd845b6e4c60e74575e30df2d08b7e192d646890e34cde554b98cd8a96966012bb4bc4932b680cffd28641b080b14bd8befc965ae580a7eec2097cf0b66dde7bfb00ccb83eecb1b7f3bd3b99f512f5913057318b72c777cc590cb6c55e9e0f85b78a79a4712fdb0b8e89d029c4f3d31d25266f0d66b762b54ef39b54e6e3c22f5387ff5511a12e63e93cc749973689353b1a07298264e5d81d2c3c77fbadd2fab42766525a0a5bab670f7790c4005ca552782aaccaaedaa29a51050af54603cd7cb8315780c9c7cc937a17c9fe6f6f38cace221bdf07d9f50cf86a9ec259f583e2992b88e11ef34cabb910f9b0e3d0795f230bb84710e2a632f28f51c839c22e655eec8acc95fdfdad97c316470a73e7b5f3fe8549dc09ac90e6730179383ed14c90268cd8d6095a3b8a07aed67b031710620e71b671cfde50cae28ea56be3efe6f4e820b3251ea89240063b7f9ad1e57007568d15b277b3f68f26a20f27d133f5d11afd6b08377b8b4b6163234ece5f108c34f0cd1891ca1962ee4d4d820dc3f2832d1cc703b03036017d1a3c101ece2ef40c6503543059859aafa7a7367d9a2b43124957ca9ba64b3d9470c7efd8aa5bef212b98e85809c99aa48130f7f6af20daa3c896cc8da23b23624a13e86eec906db1f724e32609ef5281fffbd7d4ded2d68f1518603980c9ba92c8c44ed918f7d24f5d62806e5d4ad245acb18b24fc71b880462d3dab228a772fd1eb824236f55efd546881392455bdd5ddfab4e4b5276b9d748a7d0c1ccd67d31093470f8164d783280c3ac1417fbfbc6b3b4bbc870dbd2ead6968c46126247d09824526a473539a635c6594560e92c2e8cc2652057fca0cc823dd603849c761c76d55c7af330a5b663eae177311e0ad4ab8ba739f96b659d77b5c2455edd66069af12dc24d6d6b482413377f19d62d33b68450052277f27bc2d7049adee41233d39255e817d42e75b803a15bb8c9458c1cdac4483637f4483959582ae3d5b3064f1845a0c2ccc8646cfe3830157d46640fc9aa5f3159bc0c78f3a1537088170980753c113b427b24af20ba57f89babc2d52dcc54de1f59e39a9cde0dd4b9afa38e7868f7f570cc7ac284d80f0323189ebdac51bcdf45f007efb518042bc7fa98de4bb6c36e5d7fa64cf12c7abad5084cb123f9c13cc0c35f5f7fd865e5ec3494c9ad91529de663a379dfaacb0d2d0e4ae00f2de1acbd6cc9b9ac326093fed3f1cb56ca6eb8d56a0633f3ed25ee2eeceed868263623320ffaec06e9649c0b70a7aa6bf12d82c2ce3f7486dd6a21365b5640394bff936f2bccbb8eb531844a33102192ad3522c923b90b7c37ba21ec217ce6fdf10b8c89bb5cc899f48b20dc5fa684cba7634101b34518430bdda3e4e0bcaaaac03b6717ce7697f642a19e40074cd9a92f5fe342285c35ce0087387125c8b28fcb4dde18815745af79d238fd780238c7466bf4b331e6ddd823b641c9f10b62eda7cf261bfbe8aa0c0a7c030e87147d13d26f7fa4dd2d951d6adfafce92e0d1524be4e9c36ddbc4b7e5f6096bd8c7a956421f1f9fa29f1ff8a3bfbb3742faa36282486db58946bef84d5495da6735560d93e698e8eff4d9b3bc03419ccef7cf87d3005616aeeff5bde8f7318e409410e79639c9b6b6a72ebb0925be510702f6bc01a6490bd59999316c48bc5a7fd47271373785dc0ae784efd8029b1c8829d5c7260e92e73c2a10702cc2cc6485dade271cbae00d07b137ba2cd013d0d42d4a1c22b57d6ca0ffd6cf2a995aef1ecd02d38c3a2d809676d98417bf27abb4c02c1fae0530b0c0c1cc9f7652e041ac6085172327b5899ab1b359d5c367392bd017b45b181d03ecf0ddba98ee1ed938d39834b4be2ab2c06b7fa9645dbe219d51dc80c98ba0cbce809e381c81ae2b144c7d1254c7a9e3a81c885c1f09ef33009863158b234c5f1fe15ad1c2bc38407f4068b8b3c3c92991cab5b9c3b38262b1efcfc922fed2f0024bdb2d2f48a06e731e0bd44b80c03b83164b3eb753efae9b3339ce6a90664ecd204de672b502fbc13931e4fbd3a38734304d32cc224dd9f4d3d8418f16d8b656bc8a9d3399e240aee61d102f418d453c36c1e3cedabe6e9527208258385d9be008deb47399a4d09bee0c6a766baaa67c22380e018a6fca6ead3248a78e77d668b2099413c64091f3659933ebc9b7f4ec05d49f048feebe62578658a7fdafad0ff2d99d55cd922a5a409ace1c82c0e44691b0c5335c8b09c1b04e651acd3e98ea3c1085e49e3473b55b4d8513c17de7d41062ec54711a3e9d9c7bb6a9f962a098d592f28b81df13b42449774f0aeb079332dc97e794ba0b11b2f10625de283bd1cea9f37df103302a3d2d438b9cc357a74e139b995ebbf6b51e379d17078856cb7bf8fa514958e470201fee56b6ab19b853c1e05cd279dd794c8a33eb0788e6efa361e0b9dfbfaf0b81a7207a289a39ea27b3de3010fef8271c6260bd5d0a4fface5144b862d54c35d8b196748c2959c2aebb64cd4bfd7bd7da537422bc350fbc187e9e8cd1b3636dc1ba1a993548ef3db44489296b6135705efe5316825640d28dc768eb73bcde67e97201b09337ae9a5ae42d20350d62281b169e62f179893b4641e2f614c582f1b68265109b0a3865103af66abc0142d52a1d080bda94867e5edbb037ed7d9c827689b0371aad6358e357db8ca8aa91bddd7b7295619e0b27385142e506e897bedff9be12181c03cdfe72e1b8edf946ae3e294251f77a334d90a5c448afdd924a9279c2cb2e45b469ee6566e03d08dad4b53909606ea38759dcb6649500dad7306600643f93b86fb3130361b76c8c29ad0ee9cbc833b59c13e13ba15b9ee7bf8f12afbbf91cd3c99bf2b74c1cc752c45605d6add1b53f053dabfb0f08ff03b24364a1a666b0fd52121fb4c5bfb96a6002066670a2c2eaf0d8d9c44f87645564dd43b9fbec2c856fe7050ce5b3cd67b87f464711592d7919dd18ffc85fd9686099e756c651d955c8222470bf5100b44e9be8a0d1468c169b601a3bfc34393ec01f942f0e56c82b99973ef6825fe7abc8690826f69b4e781905db129b4bfbacd6e20ef363c0e74bc55fbc583b31ca452816416e856e2503a8f3b797d6cc8c432e0f9cf2c689ad8ef4c4883a3a6d2c05e94329edb60a70dbf48772ecc2ff426efe83c2d992d74e60dfc693f213a2fb718bb36b59d3327aebe934133d4639395febe146caf7c257e71a62c44d16521499a948a4edb10b19c7e5027d86e67612c9ce1d43aca37d839009bd92be5dcf90b41ee9c19c0238ccb52de715f91fba9e240e97e49fcfcb0526354ad623c45c29d3839e2031a09db3c107c71daad314346767b534fe7a2eb7cef20138b8a2e739bb5994485916d876d74a87852a3bec076b70842acdd169c78bf18d908afe594f62e6a6f0af33c60e95b269bee69ca39e5e0652d70e3df4e647b9c30c6c35d1235637151147b2ed602a7372b323de1eb95100ecf664f9a86ec2d8ebd873f4385368a26601c6a73300f87e9e9c80fd504d0a9fb78f52d5b6ee6b9e3d6b5a9eea7b5c0a83466419b28e23a363ace934efa60de6e38a93e00143d1602cc8f98d1d17312e1594d489e1de43d06dcd2168f022193c2e69cdfa0ee547956b82a525c30e50631fccf6fe1045229c14f5d40057051ff3da7ab306bc8066a9404fd9acbe1dd9a5192d98c6535a5beb74fae5df2ed5e51a68c9214e486e0879c635c2ae2e4ead41ec5ec34900f3927823f6021335eeeb99e567310ebe8fe0e45e371d82698a177f81713d187d0c6366420699294be0c9b42f95494c433bc381f816e8cc6e4d6e979256eb2d843c8be708e8ff2c360ad0dc42b1869e3a83e57d2a6b475f64e129067b7f33aaa115c839544370d8985176eabc046ccd6b72cf78c393f469dffbfd07771a9137c1726a31b194bb4fe88236db10649c3787203748dd360db452c2f238bdec85edcd73622cc29f1039e78c3feaa89c70e7528ad30b28b61cc623701a0aa4c4ae40993508f43724b582cc0c08e53f51d0750a29e2cb419b52a4a8d696b5379b723c2293971e962fa96cac31910caad04e725b3d089d03eec4c576345b82c7ce424f7d487e7978b38920ae6aad185c5e10a7e5d72a55d1ba81f5b743a2fc83e0ddcdf386fe5e21c75873ae4e148c21c6764159e3ccb06d692e505d6bfa47e8eff2b320fcb78b78ac349a9e9ba80857174b821560b329b9a2dafc233dd114f9c03bc89f9c5734c61a8819bdb733d85b42055c573b348de45c35e62ff57beb88e5127bb4ae26327eaa24b232e510fb0deb3cc28b1ff46d5aa0f44ea57245d160b7abc130e0cdf0fa547ac075a9ec884ed60154df5083942a8b8ec408ac0d4f2869d82bd25cdc468f1d62d17ab1ff32bc01d55b0c7549ac800c1691e97a7bdb46f85b14c7895dddbeea4480719db027a29e41af9dc53785a9c8fb908bdaf535b055cdf6c88f9106c05065289e0cf9edfeaf0c79b7f246c26bb9276fd525a64069310921a3b21c9f8bef7a7921518f3253441b62943e6fc972a09b6d3f5c4bc7d2e52f6dadc3b94d94c45db6f6b2be201e25d62025b119d21de2518f3e72fb38888c28dc79fc03351c5a50834d994a82f390843ef65da343eb42e4580fc036bb3dca567405b4c1deb37b59790e1e5caa14a758b217001147c30b01e97179eafd9168bcc2ce2227cc3fa8af2484c3ed0149b48d6606a24d32c6c36acaf8f528850c7cd141a5ada79e7faf68a687f897e9dcb83c71d71104dde23a3676becf4a1023a39dd3cacbe4fe844f976b26d7ab6681d84ca367e7df3ad4375dd86a9228ccde6add702ab0da70d2527e953ddad79f900b07e1e31c19e3f0f137aeaf58bedfef56092e01af694df39d5da584680ff2b9ab64c6588cb3014a0eac86aa5aa795be5c0f683bf7930a18cd1338e8f842baf5c351b3410eaabe9e6467a7c044240b59ee6ac34b638acc794343ff56e8738b0523b5d05411b27ea0e3427b3a472e5e568bebec2b53840835f2d838c33eaafb9f892448c83a6fe7a94defd48c4feaa9980d8cfca6dc5eacd60634ab1dda8af83b81863272af55c8e425cfd1bf4d8382f5b32969aa3698bcc5f3fdf2f95a83d481ee7f6e31ce34dfd1b3148b70dab6469ffd71bed6ffd23ee7d500db5a7f6725085a3095507cea08fdcc5f40b35978fb095519c2331c191976f26b1fa74e92285f41f7c3bda4f0d0d7f156b322c72","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
