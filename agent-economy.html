<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"95bd1b337b37de7c6760ddef7dc7c2bbfa38a4d68a96657959dd98b3b5b989e58abc188eba58dca6456f2c8b4f524612452ad2ea9b91506a1503f862db443d202db5e61aa5bc19aaff6492d2cd9095ffd76da5b297b2454bc83ea4cbde25d2ea40d6e702d9fe33982891e7ab61d08a786d1d0430064b6e09d64a9dbcef32408351e8efd7d1f79f8a894103d7eff7b9ce0160c4e63fcb4081005edf2426122f8340e8c0ba76547ac99376ea8bbd1a72511cf1a6a76b6b3177de496a4e406ffb763d064fd5573680c2caf03c025b49bdabb0fb20d34664ea4faa46a5f55e9e162abc501d9d39505748df82daadd35dcc20028da9840536b110b355a4948cb8631dc57321c453bde8afff678ffc7993cd1492e8a84f669cd2c6c13d6c09f8a6689b2e4a9f63b659fe32f2eb9409dc01ffb05f46cb90dca8293b4881730c1d734b826b27b0cd3cf1a4709d15413cb8a2371faec11f0abdad2bdd5a0af70acc70eea85d5a28eef8d8ae6a022d5694444147ad1e7ec22d1cd2fc1b453e6d13301071c4aa0121e691dbda2e19e6b18f3298f2d2e1749ff0eb7a594c3bb2305316a1175d98e67a46bbc19c1672fca178ef6f57e583568589434db73b1d0ca4bda57473b7d5531394f03b467c532d3a1c21d50c3eba84ed8b910efde8bbd86b96dc11706726fbee1cc5f23fb0f011144d8e8e94005228323b1d63b22a67e203ebaac9020a0aafb24cb7870fdbe7ac4b2f638a5ecf5d720a1e38cf44af93466fac30e82b8f22cf51de3ef099f281e474b432928e49f8c956c17446ad0bad309d1431d43fa533bd2886246cd5c1818e4b1a1a3732e4812e213b52f573d3ff7cf9f09ff4d4d04b9aa5d25758f472646bf121093a3c37102c0a655cca670a5302641532a6499de0866b0d6a355a77f80889d357812ca415de385d55ed4fd80941eff8a8f9c30dbc31f03cafb5b371aacfa786b0599798cd06aeadcc84f49d876812c8708088047c459f0d593b938912c874acd740332b788c33f22dc6a6365f35e24c7429c1ef7c194461f1dd466b55b9243da10a1ff73dc49cce30cb687df29b10dd33781b555bf5b021dd61a43acfa00bf9004985e3788ea98011567a14991fce8eb9ec4d8a30c5c04a9bcbea53d8d3ff44343cebd65616c439def2340d3e66e560727b985df72d1eef6e76b118d80d401035349d260f32e2524b73e2d8e0efc9d4eb83413facbb03372164b5b6ec8231783993827d4c2c8df6810b88381e173f59ca5748d5756d55e6d5750384fe9286b54d2f3cbc33b0a2d88dad32d732af11b750b044dc5904bfe2683a7741821b88bfdb86965bf6c8de3c79799d35a1c67674853f049835f87a1b1f1bc15c43a1ff2288ce11081435b20a17e0fdfc3ba1433e2c526be325f997b25f38a8c143116311dcfd1d6da33b8670552bcbceb230c40dd4537b14b79e8ce6e291e88d81dd33a45f1d876c0e1e4267e23b32f8c568b9a73c4fbd9df73e4612ddb8a1e0b2c37f7ad68fea067243874a65b72b65a2b4352e23e7f424c64cd0075856d204e05f51fcef830157ebb21eb853dafae5b54c5fd32f96bcff5cfc4ab0da79a84db6d40156488bc8936887f8472c0835f9ee0c35b5237b3b192c83e6d303c0d041fd13803c52added29e5c1ff8bc46fb81f50d5c84b4cdfa88a7b6707ac03055eca06cb03ff9b8576e283cb462137aca1b223db8bafb33c2a733a5ab5b6b4029e53624ab8190e1fc22f3ac30da6c43254c4b198c2ae7f5742b2930be7f2849a5a82cfa23c8fbe4467f0993b8c073638acf65afaa85e7f9cd9f8ecb7e403d5669983348bf0a605c7157e6e56fe9bd6d9ea979bc5916f1190ea395f8f458f7ce33a9fd6f1cc37ca71b07de4276d81d59571a6ec928c1cd0872eed1c562abbdc7debbd6c41a6c6087c0a14f6d89fff0bf5396ff826f88c3d8a85e2a72ea49098d356aff55706e91bca63af5a41ca22f00332880856d0823e2297660483435cd2c9116d913850340921c30df04610371c4576da98481e9091f2726a16f4d9bef91b8a16e76cf007ca15f977cd644d8cabc86011f3ec44756329d6879197a4a96bd577286ec9833cfb81e0b284a763cc4954f80f6843cb09b58b90311df245c9659f7cb3312de32472abcc250f1a5b34c060406ff37bd6166bcdf5a2030783c42743ed0747f3ec23042b97c3f83d9a1f2d596d3f5e255c4752438029805922b25c639dd516000ef255d96d0ba9e0c57b2bd7b75302ec2bf529d90a8099600a38b852f1e5eb57f39cfdd3f93d6dbe9f9c8b6a8490ea003a89a8f09bf32f1b230498efa0d0375acd1399f3ccd790ee30393d6af6629b0dc00defe9fb9e54750f89b53ee45fb51a89e0b510b51b413b522be61544761c5bb2e958a3784a7f2873fc6f6798124fe9178e9567c9e0b08fc9b7fa65c092ba6b065f38e31b85848170440a0acd891a639fb41f5ecbdcfe23e243554f593c0a6ef02c59bbe67ef35d22ad498456f03eddbae55e364008adb1f8c622a5faab99affbe094e55093584c483061866208960ef286ccb0c2c3cf9c1f96093d7807afc585c30d71ec8d0cfcecbb487c19299d75a79c54add49079350b2d54db781e2e5a82db7d6108cd12559c9fc4134567ab217c1a375c44b556a6e6ab9b921c0c5862df77d5a2e5075a879e208ef7e84531fe1d9cdc89c8be0867edd340d0cbc0201ea6851861b353217d30d1728d02d64e289e101cf746b5aef9d8e838e220f82cf16e42a3884afea89c418e8dd012d482db5b61d940df331877895cf60eb3bf12fc7fedf1b24522163a9b2588b74c4d514a6c9734aa9e158e35a0216927bae8260b9c203c45ed83cb993b7f2483db4a0e8ec9978659ca02bfc8ca13107eb30142087f82c9441829b09dadd6f1df5cd72914e4cf4c96edf0241c0e8fede9b47c404b0c2aaaafd0af92edee61d67546567f02ee6c5dd9734c86e19a5cd77c9b53344748aa6b8980848fbf866c566459d6f51373b92f4f24586f4aa6c0dd02b7d395f5a78fb09fca59b806651930688e6d59f79980bd3e82b220e13fea9392528fa18c73c5caf7f4d5eef3cec771889e7fbe9d4c3b0e121941afd7ea8ab5250fbd50a6046bd0b0cf186aa4e7b395f77c06dfc6d904675580a7f3a4848727de11a568940a2e8f29fa165d432b9ff0c21f9fcdfcef77a20df66fe417cb6a6d4180b3d9544ba01288c7a198fd705bb5e17213aaa101ad3f5152ae41c0e67fb9e184a33724a01d9255cece735238b3611ac70a1cdc2d785f6a2c59075baa71c23b7f0c8002c98635c7ddaa0ff4e8b4d3cf42de0cd72c59b303131e50a933c163f81277015664c409b42c044b8412aa759486a2fdeaecc2c4f83e32b6fc135b0ce0a1159e4b09ce1b29963380f10d4d48e96465185a305ee87316bb6aaeba2e6584974428a45561b11e973581c748e850ffcc0ff2846b6d2b3c983425262eaec438dc0bc7a58add0464d0b0292cbaa5ae8b02d97fd534bbcc8be2c6af821adace76a33665b269a4fb21b0ecb5266ef5e3346f56ca7976b34ff7e061712382b472eb8a75f8fe0076198f11cae021495b66798d0898fadc08f073f8467cb6e7a7151f5cc0a452dc477191f5a74d7cf1c9fbc760b77688330b51d031271556f4cb700bee648a97a29de9158d71423f17125a185d48a9455da86c36a55de7dca96a5f3b4d48bf9a15c9fd9eebc80d80661331845a188712ab76408f3fbaf9a1ef6d2e7f339f6969e1225492a47ad12aea143415d582772110ed69c6d05410ff27056e68f4641ae6ba5df397845b1f9661440e532c627fd274e5267e52b811c6e9cd2c5e9c31ccda4b69425e3e8c3444c0efd9092fd73bc303ead64ace2be806bd556fb7cc19c087a41a4079acdf4b6a75c1950974c9461d2eef45c2ea0aba70adafb620dbe1f1f1978836d1366f38af0109d629b9209b8e9567bd089458eab804af2552044c6dbba403a580967d9e5d8d951b3973a3d93e13cd3cf9f8ef5fe857c01667c51aea7e8f9e950d1603c53af57362c793eff51fee1f7db756a641a1341447830ac7daa6286ee2f4df17538c9f7fb44477a5ced3a3b83f747bdce115dda7627fe7e8970906d907a55b3f4dab8f3d246611611e91da440ea47a3c64e0271767dfadcdfa3052564062d546746543104d94f0299028ad6cf9e50edf5e3fe31c8524a105ad332af36cbb9ecffda65fa09a34ac02412277cfacc9ba1edfa75bd1cf3875b84bf736605d1ed34a746a00652fe61aaf577322fd69ea065762d4a08ab1b11e19cd5c464e964d1158744538e2111bd94fcc16909008d4152f067c3228a555305984be2fbce8823ac80e95023394111d2f58c03b2bd8c4778ecf85273a789a4cfbf197ec79c4fd9603c88350fbef07f3fd556042a4f022cb03e22fc728b4d210e5ff23c971c693ef598dba5db29c4c85643bfa835f4f6be7be3be924719a45b3b8acb0e4d86a66edba08d88917a2533d5b6f6402cb1c7eda20ed4fd0712a2901b18eafa5599d2247bfdc7dd8c5d65ebbb8b2138b0bd9d460308bbf12520d15c568b33a2f5d66fe31a3ad727265d71b6ce2aff307ca456c51d2285e3b90ba3433c2397b452b89e370b967b7b9d9174593730faec03647927f4670b22f858aff42efdc263f9a4e2e15c42db0ecf757a392fddf7eccc5fe9033bb982cd8ceb0d1277f5e2575b482a2e3ecda8ee9d2088d8a8eea1cdca17c2ba04e2ccae1c5e1024fee4185c42f34f8d2b7708a8d906b7203f04418348acc3ce53821ed62289b6f75da255405c93e430b2d491fc7098dd10536adb7bd3b273f2f6c40c13d794417b12ee19a699fde44b10313627bb2b6c3300632334dfa1d5636b19f9de86616ce3e47f06e97fc04b0537c1b817fc2f05b425e778e96502618a4bcd2457ebef52a4205266fa0466155dd1de38b8f820123707fcf25cff0f2ae6cd0a04cf53f625dd8c8da07006ef2f974f7fd345ce33d76aeda5391f03e4826541f67d036c4161b37dfc7bf4fc1535d22bccb7f2ac82f81c5e2418240233f34c2e085012e38e46a96e482498980831736b5bdb6177d17e6c269f8928cee993a215f2049982249fa719ee311b30aed93fdb230a74499ffb8ac0ae38e848472fe747255dd58e5f674c8bfa69b8d00adf8811565ab989c29338bb6c649691f5748f3a686eaa20620a29d3289168a5a28b3b9afeac49eddb9dc236ef563762fcdefe357133ec27078771aba5a1f46d85e80959d6e58eccd253de6840431d35af73e4f7e63468e73d9e1f975adfe278baa3615fd944723b04d3c2348dd2d81a60f70008cdd74ab477df49fea7726fcd66dcb510e332037967a0cd99ee69d2bbb3786ab6ca7dce0efc80bb8cb76de544d41ae485a365f98642b30b0dd9414fe893b32300227d167f1c258a719222a5c9a448a564b855a66201c640abc2f5dfc29071eaad9e549384ea77d29e84d44c02401787d24b6cd989e4406839ae3152bb73f5f206f2379d2acb2d6642e68f306a0d2ac3a3044c1e0ec9330afe97ed8cba6cacff5aaebfdce5badd2749f43e7c0442cec07f08eeca59f7db706e8f7d06f4c1139e9486c8ccdb61c20d00c7211c355dc7713da44f66e3bac3950daf0f1d276b335ec29fda0c40547bb27f43527f82f2bc198233d0e8397b191bd174b9a460af341574ae6ebd69662a17b95521760c5c938a43feac2e4a6c6092eca0825cda4e3e003cc41f6469a479b1b9950723d93e078544cd1fbe9a8a1d458fec3b87697d0a844ea48a282569d0e63fd6a6fba16fff205302bb13d1e89f5395e78fb158d5d0cf0b011015544beb134feb28f8fbecac88c09ee25067277ba6e30d2fb0542ccba21cb364a206fd02ad2dab7a94799d6eae3c998d76e3005536a3595a2b4b4a82b897441de075e6a13464a1c496a7d3db890f8c255cc6678991fa59718ffe331ad239443ad4368b798668be43133d55d9ab3a05f874de42ad13f6c241ab05a5ff0543b1a502ba0051708baf18a8684750c7c7bdcb747da920af28bfa717e4e0a64efcdde5309377bf7c41222471b5fc1d5bac2f4f8a1cdf2ddc2e2ae7061d525af9be75776378cc9b5b0cf67abd1af635748da6f8d5941aea40ec7d89ae1363ccba24714b6bd6d7083f7b660e3b761bb6e733460ced2230efaadb570397b7b8c05db67594a9a1a578a10fa7cf1824899e6560c0bc14b68830fc01cf8596903ba7e130d936bfb24712cf14c647775e07d5ac350b39ba4152bc34dd807d5909cd6092a387587c592c000057bcb8797b980a77000cbc56e3a63c2d73c9274d9d16e5e4b465a2e5a94b224defce4d8adfcc0fa223e8f832a1f703e27443d45f491999eed2807b65fe6f1b0b96915debb0e58c0bada165c2d18521edcbb8a00521f2adfdeb3a3e1ab4962cc6ba0bbfe9723c1a0bc08fa4de946ee78fefe8081ac8c47b3673d53e63e95070a32aa981e322be3316cbd611df6bade6f4783a0b651dae6d2d87b507c1974906d2bb9ab3f1745485d854960729555314c5c7bafcb66725178b1a178a4d8f785827d86aa1835ed269cf2209a24f313d7b5d3fc93bedb89e2e2b3d113aae199721924a33be8ffc0df3828ced1ffb8e343ab496c9c392522cd6791996bde65a062728788c4b201e0e722a3154e7c014e17134771307816d5ed4c4ddbd7c96a21b1584c73c4f9ad8861892fdff3d1ac1ca32bbfd14545a0436fd63614a74bafe2cc23560d8a9032a981d083c8192408df9290261ddba49f00514aea08611f8a41827318263c8f4240f3f2b1f53779e0cf3ffc1d23338b6185bab7ee84b8b359765894e45269f8cb513ad99d6d39c0d0ec3c105852b66b39944caf2174c3b8ec5374ae30cf2b0c989c6f1299fc249e44fa00ab08132fad82b6a868eca2d06df721eac240b8b17fe6702e15fc8761797dc4d29a85b64348b75abaa962a86ad13f76e39142d48f1ad0ad7b0450b2597f846fe329e6acf281ed640fa9ae5bd10f5f1a2b0677134381bbe924b9e297302524f37becf93119102b45e1f06fd5b98757bec8c4f0e8c509b22a41ea3d43a23d1c780cb9fa9c63e41fc28c9454cacc7f458ca2e32c94eaf182137ff2c817db8530d076c84a4f641dae5693095dd2a3d5069b5c0066087e7023f73d50cd6c1d3d48c7f70847c5563b118c29cfd22494d20089eea1f5f63ab32fe59615c1d95ae17c55be67521b88486e2f37a9d284ec14e16523ec9b695ce9be0ccb8e7758e4317de7017eae3da99b9e37769e1fd6f725512a37cf77bdf36e1cc4e935a72371d83ba864b7b0c5b848068fd00b2119ee16d90a67d7056d6778a2cd23414e809066426943af359fc1abd42dd14024aa1ac9e524bee17c8d96dd13c1714bd4b0e6c58e2bb087e78143fe7b42b9572ad38cbdfaa68fee6502f163e071ab9f3748094723ea89dcc4103c0277f5f109b6a9c9f26e484973d1d4a66071cf7bcb1607f5d9378fd490910ea8494bb149d6f6e433d75cbdfe10e0df5b43353945abb839ce2b8afb68a102d077175598a43b2e9374dd90e7d7268035b48094dd50a275f849c7405ba38e8016d22ac64e7879d8ad0db23a55791c4aa39b8af0d9bc6c636f3b5111605cac5d7de50382ecd47145dda259443a42b1582cbd2cd39dc03afba5bc2ca8facb1191b0c65715b611354b196dc51a114f6329ff91c2a05146112d1e368d40ab8db915d879b0e31c63dc783622adce2654575c6f27e1dcbb167f095d33ab0cd9fc887d1681c6476cafe1f15c32bd7532752a7aef2968fb2c47c6cb499bfdce6943510c918155bbfe0be4fb8564d8f526a727d79b251cbd81977f8b13a56ae1c37ea12ae92f4b59effe7ad13384197df906e782acdf90d0db610e07a2524df6558fec3d51ec193937450a669f4f1b56eef87b082d1d6acc3bcf29353ac0601a203645dce755cab835430990f0cc768bc45b6697015b8ecbfac5deb453a2d112407d9cab1afd464d60fcd398474d2ea3ab8b11ec854e8e4055b307f4949c5b19b712880246fede280abc0d401ef20289a7459afe32cd35376e2b858d63a6bc226577f4182b3720c8ad2eda77d161fbd78669f86548a02b1b143e79b9e5851e794d75c1471b353b3d894992b1cf87fb380d7a8b93e64b7d2c12b1d50afd33efd69168deac107c347fa303d6af131a756ae25b8dd6fcdfc468ce82d1730232b4cc9b69eb1f6a0d562ae2e5e677847a7f4f343797d7456885ac90b30aaf3331e1be9a4213cdfc83a4fdc360796ef488a0aa225f15fea93da941ecd0e6198241a000c908f2f4c681da3b0b0eb304802821bf5815d15de7ab49644595677e97c51035c917ac8fad420d10a0c82f1dc09ba02097675fe92a93981afec7b5a5f621f1ff6498188b2ae71990e787c924445a3225f8dbc1f9516c505b805949a8d493b0a49f8f123ac4514e53f2605af9f868139a565078cb76daf92a8e7b7ac63006611a1c7569df7e32052e385412340e3eda07572febcdb81cf571f478efd9f450bfb5ac9e16d037c24312714e0cd3a2a982af5332c4350ca8ea39b7b00be690407269a6a29af70f930a827dcc2c00f1bcd8acdbfbbb97b17670e94cb71d9e8a6d4b21ddd6955b342e939a078051b847bf95fe6f97c1ee725d2dff9f347d7d502f3689f968d8159a2c7e31ac8b78d2484fe383aeac71f9610555cac45197654b7eaddd0479be0f4f17c877551e490993bfb4e88259303d577b4cba1052e98407b62d5b31877dcc4b0381ddefea8c8f6ef787c92493b5912f1af6876f50e6a184d5d179e85c9efa7b51c0aa51e39a8ef99c2dcb1d33a45f9945ffd1088f808686fa857923586b4fd7b5b179979f919736369ae45d2ce432d0b386a75e0f0f8852894558f6708342e7f0fdef81cc813e95533cd2bb6bb3cc8d480af9a816c42f20a314e85aa44546d10a002e762c607aab2497042d8bfad6c037565ab6ba054fbc956f631a895451dac93e6c53d72bccaa7f19c1a7473b5ac165b7fc11c72ee75402e2662648c91d27be946112f49606e55faa7fa32ea4a1cb2e4285b38258ddc105d7be50ae69d38d990c325eab9eba3f16f758d71c26db7c8037c7372300679b50e1b75e25855738ebf0cfa2437f7ab38fc002ea81dd02f285162765dcec6da43eb889bb5fe28a292f96e3f9969a7834953592007102aa6d4d45ec017b472c014636f4a0ede92bce85f1bbedc4afec6bef6c2e3abc670b82ffbb556e6e99f6dfdc9bf6c31583c3ca8a453b0d110689f6e5cd42bc3ee6a93026500b8dca53f9d4588b61fcfede89c8fac6330d11233f40d7bf1f68592ac9bf383bc50766234ec10a907b4c9878df4714c81ca8b028d516cf1009ac94751d66c1d96898dae66fa369317786521d828824c4a9a9e31cc2a13ad417f95dd2e9115fc028374cfc7ca3c5d2e4319fbb0b205f518102b89e82ae6d21fa14a60d402adec0a3f20bcecdbd54657dcefbe394fbfe7546ced82a6938b43b4a98f098faefb9c3c8312430400547b59f6a540fc37c6594d04a8f28caf0bf68294d97566ea48225430b7bb476bc1f949f4e990b1fd1fe0efa5aa8cae57bc5205899e161d9df9fcbecb73c54d71b09c5e420186f50e1712a7bc57681cfbb09753c748c57a39bef96088c9536ac5de09a6769f687f75213fb41d8a7c2269eecaefbfc8183af48f25d4e508f3b89b7688e082f7927bf8f8e9a1a3c2217f3d1d0d742663c53f21791f6bafbdd9b053d50202a86aad16db1de0032b98e5717c5671e2404a9f3ad0392afde031f2f11aacb002d97a1ea59ce5c18a19daa6e43a5e6322948e722cbd1b0fd4264684908d2098480582bbb7658c78f99ddd0f99b3c6cf01177b5048f092e45d6d95afa00114b843205a083a779ff97da7c329bc030653a4c410961f0f59520404b6c7cd4ac5a5c985fc83cc65259025890b05650e7ecfbd899a7920a7f2f2af1d68d8571577dfb45e873bce669c8d9abd884882716d5c0ab07d4342e0eaeb5e6d7b62695d0576deb2e75a1e3f111b4e2b40b6228b1f88931ce7e646d9a8181c349a1bd72e6feda77c0808f4fa1cf8a6b3330fe8a2eb0b4bb12efb6933a615b057885013b7e1045d5ff12c3487970f575f7497b64b0001df562f47c0c57282697cb37ee35695485eb56a5802ac6ed44b44a3dfa7219f4f3c0639d267f3ad92710c7d8968563a80bf79b68adf8a3c0d85dfe0403e6708687a0139c55856f5bac6cc6970c11477441c1b39a5eada7190c09649ddda06e1f96d4bf7a57a638eff9c2559742f852df18219f42250c579805f79abe748c965546ff1e8ebd720524df37cf3c275f0d4d2fd06c9e1c3fb5e283ad4053f8a35b4f9a2b52bce9837b9926420d445fc748fede67cdb25b393c22b097bcc6ceffdc1a361749a4209fb5d61b5534efe63df09b7ffeaa449f91d71d7667ea0f9278609950f041a2a4e01dd692d4846209137826745fa59bc519d35212440ee4abbeda535e981c5c93d9861983388d31a901bbf248584b3be176fc56e075f4a5127057bcf9f3667f39f004386b3a2b39ec4ad48480bc64f283e5c2c11cd604d57716826a8eb75d4eff4b64b0fb0a928225160a0a47f02aa8a5244b12c9a944a480ad4ef84e807bfe4b157ddd9eb666baf8cd282e89bb5c1be65ef70c8fd31ef1f8a9033b09f5c465d6480b0348dbd31d3841fbaa0ad40f9615c92d8baf98f4c98464f9d9daf4558414e478af67acbe3593ebd2a0017f1807b1d0a8d89aeccfa4990d2f68a6d2aae7f8f76d17da81ea6f40b3c82e781b21ea4ee1046abb6b2e172c2bdb36565240ca678fea5d4198402d52cd4443008c8a3e64040dccd10daffd254456d3d2443bb26704faa02c1ac5c7ea8d7fe05102298636473f1df01042ddb549b26fecb43a8bbf22c7600b25e9b18df208dcd6522802f0ebe4fbe1f6fc72aa52d6e95684a5081f2e82ad4b239d75decef59ed554f9359bc3a2822df37c0255e96b587ff86a65cc274bfbf7e48d0419215583f176639c0532859f95e3482d24a6b4143abaeabe3470744af45bcab054627fd6e48a952034ee88b0d714f1af6730f87a5792d281f6a72c5d9dada1784cfdec4764c68e211f001fbd528556cd782471cb1ddad101dc12f6b64c6b78847e2a511dc2785a202cf00ec6851093989846db4486bef92e54cf75cff8d3daaad03f3cf8cf172710ca5ec386eecbdc4de1027e1c1d06d2808246232142f18607e9e91d1fdb182138814b1b847b2ac3fe007c8de9ea604a3d0069e7c842b18a0e9fbd2fae983d3e3473237a823bd85018abbef7ee2ad631b5afd4fbfb1c32399b222ee9d0959b9e501824058e4abcf4958e91f725344942d4f91edb734cf88069e8193c0ee42a3115863e7ff98f2604fa07bcfe84aa7b69c24980fd054e4b413aa6746912a1739cd4d692656f0f9a60e575a4360868225b9b1c11503ebd80d551f2cd0ab345b8a84c189bd754daad3f2042c4167de54e2208983432919e60f41a4371d3849c4ccff929416c47f8b1529ceb51db4694fd3646aa00f03d503f9094881da134c1a4f2a27f820b8c01d4e4cb52d99289cb320965650c3e713a651e92ee077534edae40c9280b9abf19603c510dab26157d0e401410f7317dbc4fb68ba0bd5001aaebc5d21fc75788a7dfa8aa073bf8c99b97d6fd8d56cfe8072446872840660eeb55a79ea3bad51a9bf44be3857b477f6214e4d8686145ebd0d8ed56f6df08f203ef827d161becc13961147352f418ebd6e44cb6b45ada74aec76850936bcd90a99e8e4ba22bc767794c34c7e6b2bf33d3923301bf859d63e6dbc54238f8246efb481a0e6ded2334ce87176339204676c0be8347626ad4ef0f7e17e8a275b7e1ac2fcbc913309e298c474f66f4a77dcd6cf72bb03f9972e4f72f7bf0bf241350a45426ac62a11721d74e6e051b16b0d077c90bd641ec4bc67d37875661e62e0de14c9d7a74995887230ee79db18ae990689bb9bdbb257590692df4c2ab752045b549e5956fe00571623ed7279a011770c5ca31a25a3115be1549e1add35ca2bb818969b46a7550e7317ccd62901dba0b066df434750e3513eaa444be5dcf5ce1adca3b73319c3d56dc2ffc6fa84d7aede9c17e290363469a1b6c2931328813a031803a4afa1035a3c175794ec257e865cf2ee701e8c8414c464939cac3edf3ded5aeba5e58add708f7651f56093d6c58be7725b5939ddb30be69e61544240ecd0a2363f56bb988e33321af2f08593857412547760ad415bb6e18e23c548f501ba929123949cb96b262af3f5bc72cdd5bb16cefd75b7e03aee8d5e32724498d61e4ff34d32a032a309744dde467d4f854cd0b640939c7f10888b2794e202351480d54ca42abddb3f8b05d4080491046970f6ccb6757a2fafd1d262a917d9b60f480cb02bbce188d5aa66fe192a2150d83f974aa85bd7917a5f16bb546c10866955400613649266c578ad86fd057c5331ef8c9face319318248a97fa2ece3e67d1ae8c366f4aa3fb080fe983022962671cb46ce7a2d6c978e2cf0c94e65c50eaced89ff3e602b1a2e5ead07023691f960f5836634d41370bf83eb5d84354366ac176ba38b802591180a9beaebc345d40d219816508373a1466547e6d653d996db3fbcfb4120dccae3a97a83609b8fbac5456d7af89d17fa472f1bffb7fca5da06c22c0d00e8cb59675684c4a4237298f3ee58b4e4460afd84710b7dd96b49ec74f294a09b99177e511aa0c49bded5ce4b1ae0c0803c3aa4f31699e5fa0806e0f3e196893adc86beb0b9673ddffe1cd49b6539d109740a543fc1ad0bf7077c7d2caadd789e3c8e4dabbd742891967552f5bd66b3e5e3d54bc6510c5e953e5ad445c5febfe188d223c2b5dba13b5210ee77b9e7d980f373a892a8854760b7da47ed6f821b3713e7637f61bacb4d4aed3df9f65c13c16b37f3f0da0af9a29d7d3f58729c77e587a41dd937e258325207e60301b44387a646ebc409514460277c8805e0d8e0e247570051d99a82387e45200c9b8d769bea70ad64a9d177105a7c6da6de259ce8f00795d60d8975c493b296c6a5f6a575b40eda1d3e87eee7b393ae4820497b6a7a63779e712b8662dabea02dff78dcabf2eb3a4d0e526e45828459551d5da8d475980db7992dc4b74b317d2cf58583f378ecf62e41f09d5b3a2c114303d2daffa34c09a06d9938668d1d6def1e2a55a7a482de9f686c8d2fdead4bc66c7b94d173d9b16ce46fde5a9475eef30e51def16d201cb897ecc18389e9b8d5a7a28b8535a42fe27e0afd9846d5fa2bb450794b4757983f8b6612f686a4663670b6d125c2e63079867ab98d4990ed064a731727fbeccfa36a139ea05dbb824e0b6f3a005163e52d58bfa49dcc62ca0bbd6b83b35aa7cf0acd19bb7f543227d15145f230d0efd05f5a4fd8412c19031801681e42c87f9a4237b9734929279b14bf0d6d50b07e6d2e8fa089e4a0b89887d8b6cc4539494303a128ca01e26eb2886014aa618ae11271cd6e1a3c13f13ce53dce347833df9387fefe2dc6d45d40a992bf24c976dc39115a143e7215e5101fdb8ea07c47a373fbb81b37ad112260c5a0e825474f011133f9d5c1d5f6b8983a982c21725b029e5219c40b0f4f88ec1cdfbee3a92abf63da7de110e63a3d7c36a5e52b111e72d0bc96e45cb2d9405f046ed38e128c995872432c81039488a8d3073551848250fd29e4c2dcdf6735660f897cd4fc586c333ea04fc570a3d36c9db92320f67ea5ff74e3314c1d2770b31ba6deb5af77207e1466d93751c7dd44ceeda1da9318f897a8aef1631840cd8027c66fc1b2f027e822b29d3965e3571dcc313e802b264eaf18ea575c880d36ec3d8c1f0ec3f752ca95dd498c81f524ca2e416c1138d363565da9476facab5863ee3b4a44b6b0cd54531de31fc2ab20d826a908df98cc6bbfd73d30c71d3035b2e8f58d20433f80cf5edbf1450073ef6fe62bef81dadbbcffb55089aa8c9776598cfae58d2df1c5311dfd21a1335e6ff0e220e3024d48dbe4cea00a0c649864690514abd1f943af91bf6c9338fd9d53d3e95f976b68abe886a460e980f78a62aca7d3876930af8791b86dfae616218bc0ddf3b8bf4dd99915532f84269d89e3ab0ff0b851045988b7706b5b9aeea24d7de54a052d98b081594aef3e2b61f9ae27e37e05cdc47ce41a60fbc62a3beb3aa52435c130a77943c889a1c604f4198eac4b85e26b31100c9fe4c5a06c568113b90a2140b15dd1cdf860ee0a4f909a9c937bbfb8e5b13a9f2e039ff4ff62a6b243c807a3095803b0385853d60444f1c6e5346366b0e2c1894f729a2967c1c71951014633e8e3c33e0f58cb0f81a661ce08c9cc8826553c9d188c424d6c4e878b20829706f8975e30b7ef0f5eb9ecf94d5b46dbabc18005593418b5e3a1a54f5da8392a0a40e3fb88c1ba6bb3bdf4dd5a7aaa1ba6f3182f06b9f1b908614683cddebf254c796c1c930cbc234724378275edf0ba41dffee258b26162a98c40123f8f3381d8739042ff3253b54eb1891f47ebc0f8c4fb3b80f6094f7d15ecc56b2a94d2625c8aaced6fa1a2add71bbbcdf80adc6f96702f9df1d4e179628ce7b97fc8aa504d5bc27878c6f78efc7ce329bca98779d7beab301b2bff0ecf182095b7391cb98ff374337522b937b5261b2a90dcf007ad1da112e0eac39b55574ef3d8c6f29b7e0dc36cd2cbd7499a7a42099bcc657d667991acf4bc7b54261243bc0382f0d856475f43667f109730974cae4a2299c61d098b9bdbda1f227568471a5b85de62272e5025d5a9f141bfa80e98cee6b47687f596d5d230b07cd8431340a351d5b09e49852deac60c91ea26e6991ad78d073237a79d88cfc791faa3baccd6b1698d95e582c804f7559de0a2be96697b78109b24a2a1bcd9bba642bf23f2cda36dd508aef7b914ac0c0e291f66ca3af3bffc5eac83b7492ec2db4db815b549f780ee6945d8d16c4a49624db8c964d5ade3c75817f4948aa8b45ab4882e075add80bae498dba6621c41ae6ee180c17da8f5e852b2e80dc6fa1cf14e38df5302d3cb39b891c6cef2b91a4aa93130e5ae96bd3c4326ec76b66b6cb4a15e34b858db20a70ec0d649aac1d2bbd359b77523d3b11586757548ddc195969ac170da32db7ba2d920ea77d366227a26d726243ca927bec57e4521f432d2e048ba3ec06ef8ceb750f4b779e71e1cc5bae04ae12c5b731cb2b59e627e6362df25e7253ea2600bd4e7a0f1bbb916a8f95aa449a018a97d24c00eb3946381fda3c8fbbaed4e07b4174e0b108205483d76779df3501f31fce46a24f7094098e54146e661ee130089e7ed03026f032fb155c786674931b5046efedacbfd0a721ea94a77b235d041676ba2d6ab420e8d3f1cb3d05153ceb04139b255a66fb803873233fe5977a357b49a0bd5ec8aa97f16eb7aeca734d87a991bdaecbe912717f826608e695a8b0bd5038ff3dce192014f55e0a014f55e21ce6c8a2ea3358b69bc6d65c598eb4ab22b9a9fb99b96c33122b14b484dd60aa5c0109224c5e6534f52376afc5059b3abd75626ef318fa077a5cfcd6c2c2356f7a3b12294e383215b585969f7680df06b23fab39127d630151cd759b48cb020099da5a78dc1c5bc2c0df44fa236aca3c81a438b45edd6eaa2cded2af0b33fa9d866c86e85495f855a4fd133584b7df08be37c72cad3e676928eda5261b02c8cd39e42911892362724baeef9976531945981862e4e8fcdca888761d3e2066c238e60ef87511055a3a522973924ff4bfade44f8c3c19beefd0e6cc8a93d61b1d8bcb0c9bb7066702d2f0dd8c5c60fe1f86400fc6b3d7b9d4915ce9a751112175c4262246185547a6ad99266e6ebcdff09ad4e2573a857debfd244a3d34d16a363b5e049294bbfa743b44823bc9c50bf5834e37ad805f5e8580e2febdd2ce69d8c4f","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
