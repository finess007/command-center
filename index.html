<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2f81fd75ec3712c940776a3ce3fb6d1ff113205d5a24b8fc2145c1770db5a5cecf30f477668c30405d4b7fc35f004abb7bf6c166ae1d11add787f55a1ac1c495ebd32e56ef2bcb3cabd13be3497af18d89ff6f4c6f9468bb6effbbb5dd0036cd172ec826ff27d211df86052fefb36cfd7b069cc756fc5a2cf85216bda45bab9e0ce82ee905f9622febabaae5d972bc55aef6369a52e656a62a7a4c2289ee01d7a9d7e83d5af929fb806dff0f03ef446941caf3e9a4ec2bbc9901270579d19460ad3f28e0a66fa60570b3e18bf8d54b5291306c1f049caf22cbf3560a1c87dd7860b79dc01ba7ea068d33401210cba413e0e118ce95caa0a3c2fbc04a17e2939aa2e8e51669e2d9d4770152775e39c3ac913cefbb029e253231ed75e7d21a3698f0566c5c3d42a293a909237c5ac1251090310cbc2f8054c3b16f060c74f6536971c93ca7982b1296a8015e4ff83b94bac56829ed0142092716d858c3acf2c87adda1bc456d468711f067deb45d435cb37cd57ab900c4db4a145f070dc34f326e3626a5dbfa33bc49cfed4f5ccdb8f1f8aa548f3262e7872274f8e91344d84803a2de7c24a35862b614adaa81e63a2b0a6450330a1be5ebba7453b3729f17ba3c3c1d6e41947451fc195807b65f031420938fac363d9965783a79f78eae47b741d3901052b1fa53fa828ac38d188e634126b13bcfa4969dcb7ff9ff0ceb4c809e15e3cfcca8f388200aba4ad71228ed9bb686c2203e76ec554521159b6b40cee791ed175ff6f2b0e1453db9bf31f7328349802da612ea01362f2335423066776e0e8c10d342df725b410dde11cff32296d66319f7763fe0503a1517f9c9bcc9730607d12f9f1187f211217a70a9ead31e962d4e20ba27f235b652a2485a0e38414b7ddb8b6bef7fe2563f9b1c7d5813cf8b4b616522d412bb3f181b0b6368190625ac5c5ba25c83c76c23949480c88e04351360bfb61c11adcf6861537e2144939f1df56e113bef50f42d09d39df3d28283876463efbc23d84699a2236e6d6f85a24c028743751eeeed1a59c57a13975bf8d3d1dd26f0d4005b7e5a42965e04b6aadb5482ac58ade4177c4e908bb60397c110f36826bcb3bb9a0e2fa4b3d34c23817a1556e79336e3c58ac26d39ef52ab67e1d45845a6d0704c3b522349be764112c169146983295f28139f36242cf4bdaa9a8e1e1987586607db9cfa9ddf2b8ea673ef89223277d05918d4abc4aad1ec7167fcc8e5e7c65babbf2e8c39ae337513b80447a29b11603ba11ed519f73c47d0f988cd4992348761c0bdef746d689747d2cb185c0533ead2b42f8c89b2944910d9a6d5d1be361f4c1d9d23089c380570154abc0a6cf5403988a0201d6fb2d06b578bceaa4459b9e542f317a9b477c75e8b0005afd5c8f9cf5f7b8ea7dc4c25c5838664edf5dd46057f26b0f6b9ae753ed8c55371232b70cd0d173e667ea1eab32f13727adf93baed8c57b031d98ca8af3977ecf9a82ee46a583426a6a7c9eb7556d1d68149e8c10e4d79731a78d0330cb1938740bb9a7e01ddf1479beced325896e1ab44d3876b6fe3042f47dce39c3542b1ec9dd8cf398ffc9bea217d26e2d17d20e7a982649090d744d9ad6338d4b5fab8f281c7b2fd1f205e6f8541ae03d963ebd683e0ec21434e3a7d7cec928a2ae66d7facdead9f96e1215624cbf49cc08fe57edc0ecca5712001bc954e132cb71eb1f91b328a2439e320a740d46c8d5f4f857df402a558c05054985b73149c3ab9f13f0e8de0cdd503bc3977666ae893375a27f51e0b6b077791173a0a1173c4087162f874da725c19075669e1c4062a83b864526de4fdff82b1e76e02a53ac7dd47346e29af4d8938dfb11aa9c50a004c65da390822abbb0c6a8eccd0892a75d82b72d6cc1cdf96ed0af294bfc712ccadcb48dac406f5de549101ad9ee152d8e2d6e23e58c6cabe274e5f8aeb69e4b2057bfbffc75bbd7c876eee74aa1807e0ebd92ae30d6741ab86747a4019d25d4db6b4d6198ff9ad0783a844fa99101eba711667a91e61010beb33880c80973402784c26f3a59292e54eea0bc16f46cff7f393ca77429fcd07526be0ca5efa6f7c33e33010697cbec5bfdd5fbfeb95395c13fc9c290af096bcc549ee1f6762394103f47a43bd9169fb124c744e2ebf0f10cc34020ad23ec580d962542362a972e8a044585697ce38dc1a3d75d37d71fd01c8fe75157cb2da41b24c47a5fd29754270c8612e86945e8c49a3c411214b9c7bcb4bd240aaa0413124abe13b7a95b55eeaa089a6e6ba2b0cd0c35520831e35f2331cca9f73c0443e993a0547112fcc1bc35960911a1f1d7a2e3ab92cd4b8daa3a358d5194e78d8871bef673242dbe4d8916268c5ea5bd72a9d4649b0343f5441d6d9f83efa784b57f56059a5bdb9c1c14d861e59237299426562b2e96b042c30b72588a5f8d76b5b526228c03ed07e6921b32d26baf49b0432941415cd1e0d07bbffeec4a1e385048afcd3feb97b9639a1a1b23afea2deb0fbed58c7df3943dc76b11bf5c8a8ba653edef2db4450ae0b89b1514befdde0d2186212f690fda1f5572f8b67581327ebd4463c758d27e95c96a68559008fa89c2ebf617700a4c382fbf82f2a37ddd57c158922ec6851d97b42c24cb512977a880c1d4e85b5fdb303bd39c144d36d5f5e297111aa108968356289400686281b5c5b500327a140d980c8232325f93013f8149906058fd5bc85f3e242a3051b596d9a6bf6b73b2c7acab0844479d72f954e1427a666616eccaa66fc82db3ae745706be834bc9126a305e492545388c3557d892247327f7bb9a13583a79ccac4f0d7cff6b1f78d883af96549f601929b6c49ce6d38e6d064fee818c27afd751dc9a55f348257820c9a8b9fd95647ed45e763b007c639df5f6e3da67e41a65e80c7d8942896d18f864ee92db515c179c65552a12410f54747a84e9e8f09c394ca58bef4b426b48101add92d95f756b3a16953095a3d28c0ebce1944beb3b7447063e38b6f050f313dae4214b84952bae8305d47ce6d8b021918e511bea741f202911e0a9ed5b53b7ea1babf4fa807a2254c613226acffc882d39ee65f868df2e20df209128a9152e3e341586ab39882f34d61693de4b8c0f85de0b0211220ce3b7fa34d537626acbbc0d9d5edcb1cb61db22d60afe26a41ff498a5b3cc0d5dbb10b544c96fc18262d48b4cd1519faee30c59ba5551d522ad8130c07862fa5d52ba1317cb505f94479e768159463f9887067ca053923f88e10609011ee3c53b0445173e027be9017a4ae1f35f01bf262be9562840653c7544b1cd3d7fb3e28cbbe26f1c8eb8d9118153ba5165a6d969255004e7790adb8430aabb6ffb488f3a337fe2da07ce4e9b4b6fe113724f6b35c2f74c238a0b129e7625e1fc58eeca7ae7eaa5abeb0e520f243fd8b7c170c7f1db77cc97b243dd10f0000a8430e2fb1df04fc838ec16979a2d10730f0581b3b97024df884beb6d4d4c4778a4fbb270d50d59f8f3f61505c17fc37ba78175c57f7d33c019fe2397c799ac14be83ec761f54b6a6a4f34a580162a50a551ee0ca888ede5e3279d131fdfedb4b4ce4c327ee144cf80c30c8f165dbd27d09a1dd0413170335f7202d7cf26e7abf0edcb1c5d2ad4ce649f2906a864a3f21e291f23f511019364c9fa51bd0f590e1de07fe99b075f4273c979bc0697f0d45c5c2307d837638d2df965a6fdeadc4b7f6bd14dc4f708d9c102c1f0ee1c4580a5f992bdbacf3418b2434bb28c85e68179428097524a3cc27aeae99d77d3c704f347334c0232a15aef573f1d2a8f878782c7379839b9f096a3635ea8b94442632a8c3ac28800a035f93d092156b0e5a207a5bb4f24c4a2bc718227792dbf1e79c32ab719b93fd6a2f65a0bfc1aa8d4de424a60ec9f1cd158af1bacdaa5ec2d5c5a5a2e97045515e2abea593cacbbd3699e045be300d1009500d2390b3c9ff705b1b650c63143646c6d713e8197fc85d4865c7ca82151dc80c6ffc941088450aa30b576f2e2d408d1e327a341a0d5af9c0b0d213fdaaa24553bdc22934973a589b5332e8c8f5813ac0440c1866ca37116aea816c2be0e1ec0300fe832cc982bec6b78072fa1ea2d29d4fed68a2d5c56736f0a3ded73151079573d003fec2d69708fa94c157cd14e6b6644966b290b8b80ca1e772a904cbdbe8649cb71306a6de358e961f0ef09338e76ecebbd42eb79c6f82db1ac8b58796b3a312c2b5545fbf9130096d590b2b457a1820e5073fa41dc9e32a7e6c3633f010b6678e067147e8d02005f792b9f7107e671e960337e742bfb8a98fe73cc2d4b6e4d75225d8779204b6e443b275e93503aeccee8ac3b77685b07d33b1e0de0b9e00064b4946e9b33a1d8ed15c029fb3b381e8e8000c5fe21be4e7f486face510547b5069895b2ddf70dd34e060e37ffb6637004cd0bd88049b67d89ad9aaaa780d571c7bff2e6275eb2a8c380335db24f6146b0a3745b777e12b845095c892757180f89302c835cd11b2772534a27c0ee38af35ababb2515b931a96d788fc6cb3f7dfd8df93925e201422fad5cb283cace3478313494302f2876d564492cf998f59f2cb5dcea6af2b3da985db3bda7f6574263db990df0be191ccb9104817a3e47b3334858877172b5860982d74fc386fce34ee9bfdb994c1db4c8fad8d2bab63275e32d0dc92403f0cd8e2bb522c3390dce154f9366ef8ba806b81e5047f50503785247d19c7c0ea8e6a0e84ccf8f001a136ee1294447b0408f6771c29d8e8d436d714c257e47de863d7ef6a852dd22ff3190649dd3c74b4de31b82b0b2fc1df8570c581cd251addb4ac7d92df7b90aefc4931371df07c2c4ee7d9c04c59813c76d609768118f6daff6aea5caa9f4d6907aa78a5416f79a8ff8746614cb4fbba22acebe226ea7fe74513ea6f88c63cfc6226155a1cc80ff73876520da93537a70a4c218e4347a09d3247a3a97fc2ef1999fdc663573ae6ff35596c1ffe3e859d12a408613c59f72a320ca9d906656e48632484409f9a53d0b86aaceb23623ee52669761d86e04cb1fa9bb7fa303573e80f8a05b568e38e795a2b7c2b6d325d225edd117f70a14b4ac77eba21a7b173620ea177d7e5b0e531f010ad8eb46368e46bf439ed2ec71004275cc332d0ae6e900ec0606906457daf1c67b599a5871346b87d36a92442ab5e3ec02adeaa6c407ad404f8c2394392209a6420ea2476983e8766c434235e203848ff122c23113b4e7646e915140891a219388d019ed0c4ffe43a00d4c17f1a7be4b17ab22b3deaac8732095e9993a3dbbdd2af9617ef3166c65db62ae2d1523aad0cce80ed0168a6745f996bdd38a8164e3eb5dcde45a14a5a282d972e63d6debb3f099abb47602a583d916dd3c8904a67b3a1bea481e043844d929d8be5a848d6aafd44932a09ef4a92c88e5cd23440c78328ea5b6efb9ede2031c117d57cb2b1181fa2dd2ffe5da19b338e48c2451334efecb0fec058c824ae5761ef7ae193f4f962843d91a8485edc7844cebd685fe640de72a5dcf74468279b0b31d19be37acac32893a84efc712d1eab54012e573d4e3174e145d120cc53327467bc81ee7d6a1c84e984c3204240c534c7fcd61c0abb9f1b75720071c03c5f7c07266d8063b9a6de97fe3eeb8f2b16cd942b8d845a4b572333c2f9af2bfe8714f089840034b424e7585b6af6c56ff7132b1b36069c2e8b3f52e01f91436afa32ad6c6e9e66746b8dbcda1dc1607dfb4675e6d49d7806d9ee646196d7073b9501cab987f44c408587e326835fefa19e2a5b4c555f2a964f6627b01686dfda3e06539018b9debf3bc20a07ce4edf0ac6d259f970fffb7704eab374aee783da26b93be6c8f8a3e88389a0914162888fc32702e4bca54788e586019ecf9bad1f9a2538a8e98c76a073f366f2f36787646da9ee53da1c7b29d10f64fefd8b227ef09c541fddb58a7a3cf2ff35cdd91f95a947d004d9bd5849771c955989be44789711e4aeece037f7088199e450676626f763023e5261ef5ab3db19a0843bac78d9fefec97727be7cfa0def01a6a1863ffb509e9d1969a676ec8b2fc58bdbf74af9aa479a6e2f131a0eda03030356f30755c88e1a790e78cd1d0f64c872356504c4f6aae9b125a6c9fea3729a5105abf63a7189d4645d2412a7c162d234925db12bb89403bdeb3aa3eee75d4ea9d97845873a03d0d904f8215cd69558728d0b30c7ce42425ec45148b80f9ba473b02ce31612b9bc666286244a58964e6ef95957f357477a1a5026a3f5039903073527f65ee47306359f9adccee38467b9796502fe533914eb013f966b7173f94b9e971bba88e3694be4d5c182c2a0b94d4ce3c46cfaa68af101cd0eda9aff9989157e4ac7e54e899f23bdbfdb2d41f41a9e39be2a82cea8a40f5c06db138f57f43529a70693fe8c495b501d029acfaa656fac4c786f2137d52cac448601eea31512dd2e13ab229c8ddc9ddbe1244ea53035ba7a8c1c1c7899e9755642cee668ffee8ed2703aeb39e5a4322a7215e599d12793faea2f4e5c78edcf5494298fcd3a213218192dea81c737c08758e62ca2a5c3421d64f1f4cdf2635785240fafe188cfb249ff7d1d417bfee26f07bedefe74d9ddcddbd57876ac61196a785c0ecd623259f17666bfca2b05dcc2ee1b86697787af5c59667374d9e77b81e6a343d2cf84fc57d80c79aeb3346ad57ca00b99c54973ac388cb51f0d1e8cbd40c8dd4312bae93288fcbcd9e251abb02289a04ed55929a6b06a18867b486aa463dca79a40f97e95e8a240356e139d933a6df69c6274ad74bf4b8467666631ece9d862fc53db22e6cbc4de7ba3f70bc999c2bfd25dedc803be8434cfd2350248f604a28b6e060d3ecf9db5f18a743edb163b139137085cd855c432f4ca61b5f67657e165c2201c1f9884b872a92ba0f7454722b09332661acfd52277a21e5338c3cb9fe3f43d43da7e55bd89210a03b511c1fdbd4d99abc642513b90817734ac3791c88778ab22191b179d4f5770b5fa15c4d4954bff31b432607e9dac60c03fb05400f093a33664e89c24be31dd45688567bf41aef11dd18abb328e61236f6526cb5049691c9327f8497153328608f9db97e4e9ee3924cf51eedd9be7cbbe11ea62fe3acde57c14ffce712e767275a3ef415b60187a97b28a985adfc8d807ebf25994924a64fa2d72d5ccfd1c79a56c01eae5c76bfaf0e9eb6435b815fe0f2443c77d144f965ff46c22c36d09d593b9c64f6182d6e23947690c385ab52ef07813d7c75eae572a2eaa239780cd288402e4d4fd0c4a912088a70bd098fa2c5ead507903aa3b8397b836b4c4d173aae680898f944b3698907818df0951082fab89920d35a80730f3e515bc05172fcc5cb5cffc972ae37789f825a04e99a98ec981c53dc0dc79cf0a32829806937ac09932e90a6e5d4b098a968c2ea0fe1d97c13ee36d373f412f2fb257dda3c30b01c73baf7a86632f58c4f05976ecec8ad3eebbd4a2e4a0236e9d6ce5915b51969626032a0be58ade2c11a6e880909a9d78ddeb47d49f3f64df90f321c9807fe937e87506c03d4aac2b64745ebd25d641f8050d9304d2e1dd09e133c29dff701565b779d8997e5f5bc7516a95cd7bf0b28ff711d0993b66ba9e35745a8d6c56b2d841f67ccd7703ce05ed8e36fc91acaf36c7b36474dfac83d91f15d4436957b04f425341ae40351492023b4a08cf77affb3293b69cdb76864d779d94b49cb07b3860ef6198d5c099c7fb1a454376941e6183895379d5b337fcc5034e99cd17cf51dc217c33be02e392becc0130cfa0da44aca32d55becbc44d8581e0519f59647e897c84cc51efd96cdda27205b7d2fb1832d69198279f84f8c25d0d80d7e6e5aa77d601fb8c554d4f5fd3684b43d61715aeba45065ae239a20032767e0b7ec03f2d2240950ebfc9fc22edca46a83e55fb18e9578ba69d15c1c334002d433fec8cb954e1c14d8f370dc55783d04c4463de4bf6b36716113ab4a9094ff59b7ef5a7286f4831cbea201b7a2c38ee863e444f7932401187b9f2dbc072aedee7ef74614b0cc6d19fe232b8d83a996f96c9eb757b509b66e412dd729e419be788f357b7ea94258845d41e077145867426841a6563b0ea4925234d6ecaab6f61021d2e607511c5c66678b558de0792a54db82ca65a2570d1fdee3dc82fc6c1e90556e1ca1724a391f0beb679adbead27dcd812680846f74396158ee6643a69456ec12f77908780fc386d1647f88fc0e9bcc69e7d628343dbd4c96bb581111699c754e88299842f73b6b3c86b1a5953840883f895be76291ca97fef36e152649e80ed0f03be5311636c5e804081aa030e27a2d69275d46ab66156a2c251e73472a337b33b1dfcbf619758f57d9392b77b498030b6584db549fcf366689a28516846fb9ac4992d0fc3be66b8671b67e498c7fca2e0c6b7db32afe5b61a4b812cc2d3c31355dcfbb7fb992034f92a7d3e28b7468f1d567c835a6056adcf417914eaff5e1f52a4afebf791be55ecc3417a3e092ba53ac00002ae24f8785c00cd1568da429539f599dc46a9e4a5ac02eb0b0760032ed1e718828c4ccc7261b206f7ca0c3f092cbad24073fab16102aab51d33991f5fc58b078d39cae971b806a1f16dc311717702c3cbd6b58dfb08ebc0d4dace125bdd008f7056f0ad73e86e05d173d5deb97b2f184f09d29ad45f2410946671b007fb81b5f7f326a7b4a8bd21dcbab93e97e1e999e4289536002de316b05f129689ce82037dc02c30f3996635a7c0a15a785af052ca7a06952fbacabc2ec4afe5a2f8e1213fd8cbcf6b8503c75a96fa40d17a5970fae7bfe20fdd645f63e47f5f12966a5d35c9e8ab0bcd01d56f43460dd54fa0f6fb4d8b73e803a22cf9253032dfa10b02ea70afd2067686c7f34051ec106af8bb42f435dec19a6ace87b40f5eb73e5c54088a994b77a044a9e866844715cd968db0a67f20e47107924c0a3eff6f049ee5f0857a7950fa9c5ddc34379d782afdbae891f02ce12cbd125ce5f0847c73c8c3f423c9cc7002660211f0b12a935eadd7197bf4f498d755297994f7268f034f36f8246bbeab3bfbd4980693f8741f5415b91ff9e05c8b7c76d15b2104370284aa2f58878aced87c30a4fc56b4bf2580fdfbade5cd28896385f539dcdabff9c2b145f9fe63abbb5f9e8ac701ab8f7766a433800d396fae405a8dca8ab4c301fd07b474ec6e0f38fb54083852883f292134af21a44a5afddfb13b129752567e1a98116d9090f36a4d970537039c0933d761953c88d509c351bef8852d74c2df3803b355602f571da51eb31de546c222126d13ff297d559dac8709b79567cc69fcd6a5720250d79aabbe16a5b9469896df6e30f40edc2c69aa81b9a5859ab04e41cbd0262fc75775ffc74fa19b4c955a18e29516bfa0aef9d503162bf62efe4823cedfccafd8f2da0c49cc154da307ad2708144fe2013128c1d0d58ab2399befcfc9ffc2bb823976bb379d4979f41d84f6d049204b734f180fa1a1f3139d9dfb41745ef977d71a7235267336688941e90298c0757f85ec2759bf27a2f76924ecd66afe7db0a56b5b6cba884499eed60ee51edc8256fafb7444fca44e25680e52dd6b00521032a4e44dfc136c275028bfb1d75b38cfab7bdbe9b6d492e7ca9b21ac96d85ecca11cc5c36524cea4b0e691cf2b125f5edb8b0d2e9942587ccfe867202860cff14caa379350a69d42bd43961d5d074655486aabd7ef4c5a3ea8987ec4e5b9a75d862c458fa50c5bc43b549dcc41cd3701c95463d97a5315f0ecb9fd444ba69fb3f03010fdcfa99033ed280a51140366d0a9c1d01f43e87ad9bf75b7834cd3988416d4296ed741225fd7b8e0640a38b31b4b58986902d3f9d880004c7ae4fb3b36e179320f9c426f58002335f1c503278c19566afe9ca3cefe55dd1adaaed252bf1a1331f931d1a0f260bd0e8b8b37b8ffda8fcafbad31840235650ecc5c6925f301ec3c2b1d40c4529ddbb4547914c99d05de9e089894ca396e6a3a556ccf8370c87ceb786a681266a32ef3fa3d65b92a5a4fc785ecd67948750355f3024482810dc41a292a61ace32c542215381068090d1976021fd77bb14ee32f0f6070f34dd4b50a2f7150bb8a7e70491081ebfba017d01bd10948182e73c19baa6f1cdb1df1df6ecfb7994df14bec65bf582e6278ea4dd329073aa309c1858442214216cdd1662856f79cd186e3972604b699e21bdb7e89d79d174693d46eb517c1d8006619beaac8b1f0c450cec1a645e654f5e9b56903b8133978de1497bb176934f6d25309740ac30ec71fd33db47752ea3d820370149f6c5752ad5a115593200c752a8c6e3574b7ca3d2f57aad107fed9c7660409d35422c06a86ab9a54ee404cefd50047671fc7d9e536fa76b0aff3a483048765c5ae7532423dbc1644299c5cd081af0035bd6394dc71017943a6666bfa6e582dcb3126479358e1074f7aa81d57751c13692900ff78638e976c88f85d615d51522da237186ca388ec471ec07f4af0ef7c99d29e22844bcd8b9e75a8e04aede7b3493304bad4288dd48b738b19dd7b2ba657d76467fe07c6a89822bd6a70e5322dee90bc8fe96c45ce2f76312564fe356fe60cbc9527b3b7052d58888fa4dc75df772529e5e4240a5819431a6bde8cf21a9cbe7ab5bd4525c7f6f109386d64d620a3f771d816a4ef891aa3cbd083beecf8018c20807b92ff6dfaa6ce64853d13b30e8169ab56ddf7fb191f1037b02ebad20947b96a19d94da0ab942661736b476550d79902c2ca70f89c254f7c25735f7a53566c555187602ffdd0a554b14785d0c099e579cb3350a00f098a81b48b87eb278c2454119893919ce47b2da18c165a71d8069318ebd8049c862ac1efb5f69ff5c6d6ef054b8b0b09d2f534819b3463c7c3dc8a1d7c6a614120993059f8a43d3d071546f10250105ac2b4b7a7801362588d7fdf5e31011e2fdb9ee5773089341ecfd210f7cc3c485b732a6f583a4d26a7e6f7d17e575f713478a738e316895ccc365820dafec024e6e2abd56907d573894c952d2dcb759131a56b7f0af8790b36997948b662aad36c80e248d198a6316f2debf8f5e445727e930bf4bfdf65e9f9dcf4d7e51296a9e601d730588243717a11fd0065c53045987195e6cac6b85bacfb3f8589bbe46dad0f6e53d39c3a664a305b99893eb2fb70d4879fd316498f2d9ba0e5436b3d414183c1c334f02d5740f30b919b87052035911d8b433395d78f5c8d52ac7b66f23c5576f2b9a92d28b37439d59de43bb825e1451801213175ef1720c575a120349fba72501450aa4b73ae497a232556c567e035865ef60efc16907788acf1f88c7bd45465804411fc624d4ea7c37c182276a9a4439a738ebf588044f1a74f330ca6eee835de86cccb6fda947f5dcce60e42828bd08ec29721ce12613a54b9ec0a1b86fb01efc14b6622d202488610d5b6c6a8d7f2d45f47e1d43d0ba543342934d22c6c1e935bcfcf0b6e4b7c747e40cd2ff0294b6bb66fed29e2ab6364ffe7928d2fba52afa3910fb709de96157e21877177fda17e033b8750367d76b41462638aab78d14c14710354284f4c3a199cbb79889e5e376a1b31bbce64a15e59cec5dd0115fb96265db88147cd0909e215a389660f0337e35f865c06f18509bcbc658f7149ee3f94a6f2feeaf29772816e9eeefd5d6a2897c5787be6aeef5f9770b8fbc2f1290d4b2c40cf709b91a8e957d47249d89031f64958e9909e9241e285f81cb18580c18895158672c8334dff2724e3d0dccf055f9df71eaa05f7aea77e9a3216e504f0f4040f29a2faa3f7cff35673ed4c6779ff3672f980b4388893149d916b57bf913df41d4b7ca335e6f98eb703b5ad79a5a65789b213a61d682e041c5a8dc10806a49993215a8853fe010ef85f71f32c883f668362d93bfd25c44c225622fa81457dd0c6f0805384a373dc2f659df473539806e664927b63436099a97397ecb63bf6f5d98ebe115b32661bf5313b37bcfe9168fe9b264eba10457176ec046df6b4ee14f1da57d107b3e3852d9aaabe8521524d263e6199d77befd23b83dd03a5ed23268ab53fcfa33b41463ba5a9d616511e98dd912e7bc3b7dcc325235e118577b5749e68f85587276225a069b86359fbf54b2fa29c8c45f0bfc2ac4333d78848328844026c0a346da53601b329d2e7116cc03dff529c726f28a7a457592dcaa1aa2e3cec596ee854c2656d71e800e7b5824912fe90804436a6e92214c801863c2395d14c37056cfe3ff59316030c821d8fc414c951425093ec3baa8751b34780ac3c0d388a6c9aee1c7c10eaa9ce588ceac15262d6c6242eb0cceb60b193ffe64a9516028132b380e3ece9395db3c1a1a6528302c1ad71a51fcba3da0f2fc04e7c41d67c644332eac82ab9732b7afad95a906c1c6e70ab47c4773abbc779b2048c4f94b14d7be82f68ad97645776a06d186152fbdc70768a9a207cf37b14eb48ad7aa526d40c313b8215ba0d4a368a45016426c03778d01f516f0578ab59043e925b04256cbdc0ed9d200394011d26ec906ceaa3c00e38e436409bf3e539815a60165f0d90158dc31987b307213563d25568b1e7e55f9871b53144a72180dc7216bd03171efc3541b9014108b1e4ed8c658c8393ba9ae8ab7246a31204802ec71301fff108205059107b213d76701de0673a7f8f884cb7b31b65e1c56c3409c8ab25688994af3ae8acb06051e6a06ff030a1dfd4e47922f70c6778f3a227425156c73b4f98313e366d4eec4031aef706bb19395907b080d5ec733f54daf2533bb13e3b31dfb1c61266540bebfb44ddba3c4885917620f47764f717c0187ee241a117d1de500713f5e5c23cb9dd885e10b4a09ffeae4027394cd5875b143657c040eb621af7a34abf84354ff49b68208e27d9cb3ea0d0442035b6e7e571015eadea15ea1643400a6c0efa5805aea8e552d21ea5724b84be093155a455d3fa88e6650b2af9aa47436860abfc48513c0f6ce05c189a33dbea620e9f3162c0471f995c59893e8d1b6a9c2c34c711d82cdf92ff8c06dbde7a16ff4d74e78a582fbf45d694fdde8d0f1b4338c1d7f241c9ffd48728f8b597236aaa55a5561d18597c2b1e4a8820d903bd762b6b62cfa1b2e5dbafe889fdf8cd2b49904eac09c2a0a9060f83897cedcca3b139eedd730305f037c186e7b4c7e94687d633bfe8d2c767d960c1cf6b26193c6ec472b4227b1f206c4c3a933a35fa2d53dd1340f2f5db78b34391f4bcaa8fe2a710d40b62d749e819d0dc3768d82b5f6b506d4f0da3602d4259420ea4411115c123afe8f6bc56a355e6b3e423b62e31c4e772030cbaa3923fdc6b0094aa47aa35967be113c59593d7c595dc61ce8c376e760f195187ce47a3123ded8b9ab8ec9373ba708bbbf12eb75f0b20aedd25b49a98bc2dd3d78bef3e2eea63910065ecb601bf16530f628b4ad59d73ad6b905400b372010cd4be1d8bc061c2d7672b9097d95b4b67899486a6a5709716ea2bb1846bd5609b65e10b7e533ab505a7259c0177c0466848dbfea2014bc7be76951df8ad8f46fcf21336fcae0d09d32d5ada53e6fd6851be3e97480d024677d856effcd5e5ed37075502246097572d3c032a2a1ad02adedcbea073bd3923038d5b09af361e213967f5ac36d8f22eeafc3b21152ba619d8b037379ca22e55827b3e592f0eef91b80f4ee71a6343d8f45c544a612bc7eead5c070c6a4b9145ab8014b34abf09b5814fef1d288b65b0ecf474c6df6ffdad14b461ad639b0cf6e4d090b7204300544379e524cd0ff7401790c93a3b1364a9f7d982e9f6f8975ea1aa4c8e7a046152868da53994dfcb0b5ae180890accd61a27400ef97a44a3356f28b5f733d291beca76c335354594facb4cbd5354c3a6d9ff54551dab00e8a09d088dc4d50059d0df1437daac32dafff67fdc8599b1840310ca0f290548a1fc9a3053e3c6cd1c1fd290396b4fd03fa4f23403784c2bb63070a22b143a613fbdabf307510ed61310d0fea3157bd6858d2bd020c867f988968c7de2e6a57743c6aa7609b1f82acdbfcd43152a0e74d7ddab6cd101997bc57d87140786870c298d424fbba2ba2100b8797d621e3b74633f4ae37732cd82e8e18e2f999bfdd4c821ff56ac20d4ee3ef7b7b748bd0bc64f8c248f88dacd3e6cb1ec2da378a87c71dafcdef4ff682a847de3213b5dc4491c052450a85663aa0912f1214c9ccf64fdad6bb71a2799197f0e997130a359be5a0e2b2811f0ca443e890f318cfc0012321480e732c320f5f1975e336c3fa4db2771e552c5d59ab2f351c98f18a963bb98ec48297f358d209e89d2af15f071079a2fbadcd0c182ed4b6276aad72aa64bfe417fdabf0acbd8aa2e1b6448b08569c708a5620c406242106646a704aa4fdc8c3eb317ccec48e7450502f7553fcd75363c47af3b58fc1359602bc99fd19c68613729398e00566dfc28abecf1e09a4e0ec950969f1975ef49065eed33f776dfdb3b83bbf6e57fd8277d9f6ce3cf11364eb2e3d526ca93ee1854d7029f63a9c27a2d480119387f59e9be4cef93be02b4721d90549c7a2e700078812540909d111f50250807a019f30382ed243637c1252600f7239c50787dff6271ea6e90d142514d6d5e8f743deb64907b476b7b78f21b6458e5fff0c405661564d45ac501d9040fc5f2b5243cb9ff502f56af8488f9ebf097f76b054c6598480d01742f11c0ffedd9914e8f67313c2813b614dc759dcf5b4017e415015d709e2434d6b8b22d918b7e33bf45017b00abafd72ddf79f64d1755c6d18cd892020622b74216bc5403afb4cecf6aadda37ec340e96775395093bbabbfc0b9325e96c286a660af74ea79eca3d7ae4252d5c3228d19dc836d7b155083d484822333b50428bd3ea9a2a79f25c76b028c17284b0348d2fb45cae2780a46efc189b73b13ef9be0a581c75cad996799dae628ae89f8c9ef1cda38929d6dc5952e8651f20e6fca54db340e8fb4cf1fc74387e3ec7a42401df97d28d5f82e7fc82d28f8286a4183938bb821c9768eb507067ac0cdab4be61e033c9592df3b3c1ccb741363c257abec5cb5142c5ac0f0147575129b80c52418a56470949d98e4e46b34e908039c35d975eb216526fc8be72d84baafe5915e686fd2a68dc45e2f14ad2c29b3e1e59900526850fe38afae53c72d990fb44907d3b92cd4525563653cb5f8152e74c939e0cbb35e1b95b767c22cc944782216a6ca0448ac902d9517f0217b8845d77470984fbf9d803e106cab4ccfd58c6a7626f2a03c73d5707e7bfb7729a96a7a5ea8390886d997e23bedb192b059ca186482850d676048206644730c3e0269f24eb5a8a068719980f8366d8744c70bacc8adcf7f702ccf01da85c9660bb4f55cdd70b4cd8ed24a24a1bc8ea1d18cef5d558b883f8d458001eca4f532dc5cd6a9c8ace3ecb9efc60bdc8caa27f1330fa322c0984f940f60bb9d08c73c3e5824297060064aa6d3d627ec81b1ccffedf7c31339682d58cc7a90f56754ee0d2d75425d7babe30c2336c6bb5b43783f1215b75c148d2f56be579aef61d9d0433cd117ac728683a215babb1ab84d98994c98e223ad0ffa161382ad06ee7b9d8bbc1c90c75d951e21a0a8139cb1003f1a91ccb155b5a73092e4bcdec86f7330bb140fd612c475e38db217d1013613e0700f02517fdb2b02c79d8bea59cd04ef13a2937589cd911960f73b0c621c35b0a9d756b3e211c6d21f8bd304d1031012f8aba8318c793cbf590c7f5389b0bacc157039247944d5826fc5a17acbe86336481d5543f89b2b635ec0dcf2a6f2e1265f5a242b5585e4e5ad738a052691cc2e0002c275aa287aa9093627d254910d2c7fdf94cb379dc9d1f6be6482036facf1286ee15113e8a1880f2a3d46d083d8524e1b79fbba8c8bd079b6b37572f7c82e8538c2fe8c4bcb2957385e773840e9a9bb57e2cffeb37c8e2035a44a4434a6bfa2052deb6f19bc09be2271abbb2f5cd85e6663af8835debefd36bcef1632d16bdf06a0c16bd5dbecc302e49b4021f43665d2d27ebd2a35805a164971a0bfccc410381ed6be3a27c942bf1445c1e78f3f0016f88039a149b9b68edc28359e4f2a549c296db419bdde00a7030e43e5b247aeeb723b578278e706ac9bc765f84cacf7bc03fa1c8a62e2b2d1865d492893188eb78c8c8de55fd6d7722094eb6d39486a8e1a4bd393264800107d389e394afeebc7b8c7854d8c2c73a71d6e68ae34a39df167bf3d93b18ac98d7308829e933edccf21323a7d359896885882b0d17ecbff67c6001fc122d1deea58590fd30664eca25e0ecbeede056d3ccadeac46ae7954dc72e97b0a0bd2e9f182a6ef76f80be7f8c171a99e125e55b09312320a510f84da9aa819d54edd59755cd929d2e84d3dbb763939bc9c565658a7971d6d339e04f199b15b80b4cb30028f12f98328240db65750165afa3c7c0087eff79eb51914ae4215dc41945d8c7e2d067f6676585b1035574ee79debe9b67b700ea6f4b79e6354f216a5b01b5bc82d7f3d723b24c325eafbafe5f0b959f973f72d408dd54afc8c7138adfeac73eb82fee8a8a74348e36be782f1ea4e9fae74f71e32bae8d027de8f92165ac59682291a6005c15ec91b5226776adf8f97e87f14262615bbfe6c54d4f0cd7fb09ec4a99a49a325d2fcf1b3b9fd059969a2164f2cb537b84b2460cbe6b51743b9ff2a73202f07f7fa29310ce5d34e4aac8770293a91970e9e44f9e4a5a6151f344e8b5aa860c4164faeeaa21a640938d74fe1d593657b3d89caa665993092a7f53295bee72422865129ea2bfdce","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"666125d2285f1dab0f009ee7052c866f"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
