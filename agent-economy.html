<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c8036fc2e6b213bb3e7c5f482ad36a871d7e8d46b35bbe5f9d361982eaff98a6d8854162fd33f437cf329852ba8a408576e303b3f8880736896067873f1f44995f8527ec174eb50d37772e03d030c039077968f4fa7d311887839e56079eed2b88691d98ec8e25e5ccb97eea3921f7559e539741281962e31bda01ec1f3c824b1ba077710d1da21503365a64a8748d0b6053dca22c28891dfa3c563a8116a37396eddf3a14be1605ccc7f399bdd33fba7507e0648ac9a0a4ef34c4ef499476f140815fcfd4d6adfae035d357c8078784d6ef317384be4abcdbc4e99b16be953d39c0b783262ac06d03758d9dc5ad63e3fb6b158fe70f240393e721c9b562bb99ebe59b367a7d1bfc276450dafcaadf0bcdc87bd211f0e854904df04aad968d1ae7b587dc3417785f60ba8a4a87f4658534179fe5384f9ba1fcd32e7946544d9f2815d325e0a829df1d04284acbd9cf10203c64910244cba9e5886e6db76eeb8f39c4ba51ec6e3979e8ddef777f5a49d14095899a09a2a78b61bf83f2cc1dafb3c1de2de990a8d1dcf01bc4bddcbb778c162d766ac9889bfd75e5f39c2d070ab610668cf38e95a8e2bcec83a4321d3edcea5891f891078a3b245a3099c1d60b42b89ef800a5344c5ae455ae358646a6099d6edc33abd592fcafea25ef5be9e3fb13bc97a9ac92bba463f54d8e638d2ba6e61519d988ff509d5e64517920342a34756ce6091cf3c46370adf31bea384d441441b587f1bbf90587090ab0d1a72de16ebd69552833fe9734e8bd8ec3e30da4f5436be2ad504378f398c9fd98554998467ecfa18193d503e7a8ca8055ac794938462a3e098304f6a0d61d2b5bcc1fb99c86c5d9fe15a8e7b4dfe0d6e57c989787153932d210250dc434370609b3b8a9e114125f5d8cb60b6c32edb23dc0b45798164ee0a7f6000917ad6bea794a35fd372fb93695aff567856b7ee22dfb75a754d52612b888642f1a54fa1fd2fe2a20760c8e9917abbc4ed294c106d5c155bac536f7f1abee2ba3f87c3c0025778e3a6ea4307afcc4e0d7940a8bd9c72b5d462bca23100584e922322be2918c8304b605865429b90be117a13ddc7b2396706adc0f024bcf1dd0aa0c960105658cb4bf83176cdc66721f816923bed627abd4de2c6debec01fc50e145e88d2b6663a5e7cfb7c66b08f8a3699f2d7fe8dba8f5ec7a10ebd78aec5e437c163ecb2d07a4d569a665338cdca9005cff7b66cd2a38bb3b151872567c4ec39f1753040358f3a74beaa1978400d5945dcc0bc5b83b400e5da42e275e2dd60856776b4259e05d70088ddcf102d048cc78baf590056c4615897535328a3623549280225e83f44cc114fd105dac92558c8eb4c370cfe16a64d689b4581949219197c37a1cd1be611e724ca83cf67439396106a629640954a2012a10ab2cba3c72994e73545e43aacd76b9efc97f564c16ad7a0ae319daa83c17652823817d7dd92224b9c67e9d8ab7d5b91c05a105745fee61a7c32f00ec78cb29144af53a551e43b032f65dadd1aa35a8d6035c7f418848ab76d90ebf3a1100bc6fc0af77468f2f87b85d60218c8ccee9365817a802fe3a02801d19ad646fe65e3c54e42ba1f1bdde177f09e0d6467e59926d84b67be03b34d10afaca4ef1814e3d905d0d3917429ca122c64e635734a2b19488718a6c5538811aeba4ac77fc40e1321e878a9f3d71007a0b9aba17d35fe935bbc796828db0c232a1de9bc6aa8ab0b61cc35d235830aa32b9456ef1ec29d7185e031e688ea73a91ae959bf22ec2cce4f74aaf3e0e72d6f9ff9ba6e8589595d05a6dae038ae8a462da198ecd4efa17e274e870cf74c1ad3bd4c990be76fcb0622fed64493896b6426fcbce323ef394ad2a57707dd8fa814ab7308c72c5d1338ca38c08ecb014f774b0292d838ff675ce9d883ba659c2dc2929162bd31ef5b204aa61a49713edaa5fe32cbcf0510c851f178ace38e35922e08551b1ca037e5669bc99b88ff704949bce6e1cf603f857a49c9dd82609baaab97c6754222563e16d219bb2ef2593d463c59f6be94cbe980644ace9dc85e5c996463bcd488b7153edbdafd392378e2b6286d2afa71f31c3321e41ab37edf91f73ed3abcdcd558a4c10eedc249ed8bdadcf1c5622730213c5af8e4715aacb2432664f786af806df06c253b4cb12e032c5a330988cd6f4735e569c5f474f56be33f93ae020e289811fb6ab15787def56f332039a7936a90c058e3e5789f45ba84e7f639abd08314a658c9e6f54b380ee7bf078e6386852145c9c09b9e5d4aeffa39350ad3fe24a784f936de2f9659ec8496409e644314f84800d0ee9497b05235f35d84d1d5c16d12dc2b1dabda9b84439a62cc9856def8cc17e5e09efb0ed88afb694927a15118922330302fc8b6d0d950af9456eb8ed6986b3939782c63edcbe586002dae2c283f20d7c06fc47cfd2641be78f8185a07b6b1d27aff475d1bc496a716de4f3f63bb1db33f74fe5778b477ecade63a395d30e5efd0456f0842f273dff22c6d1f647c4ba8ee33e26197429d1f9cbf5417440e5bc3f1888d850beb404677b6512ef19dd59c1a0fb34ceff976548830f6112a9f9f3d8b8354221482ac5af9c2dee5e023f9fd758024d19ff239a2fdef22953ce15dd9961e2b5edaac86757300423754fea72d0488f8d1b36cbc5a979b5ef51d69b2f1d1c29094a6df49f89c0ab921d5b392bb24a7cf5c8fa08af32a332dcb6cb28e2edf63a084aae1c657996e448ff9b5e1bf4f37b978342099d420a26738d1605887e8381698f04fac667e405daa1954e0fe884fde7ec611553913a44e126718d49361e8e61f2d5e381b1749b93cba557b4e3d4d236d22d29029bb32e859846cfa4877b9063a9e4ab033114992ec0a768f6919b29217be856c5b6796d42e717a346ddcfb0df1f3fed8ac7b4e4c3db9f4a3532d1527e3aa411fae4daa5a0d51235544175810eb5eba6344c39122c1fd7ac56e907130a3ba19548477fab0286c8e36de9717f538c457c7f39eba3bfd4d67fa12ee673cd3dfd1fb464f4e9639bbf10f4b6923063ab635772193a239f81b24d052b06ede3fa6f6eb614aeadcba71593a2c6be8f79354c3067ed503036852c84ddd512a0a8c7917519043c14aef4dd958eb2449359656dc0800f3d3c51d45bcfe8affff3ea1ecafc124a9fa2ef9dd58c5d8bed40f8fa3d5fba5e527dcc9f488a3a333e537dd631b5e14d9ba5c8ff0fa7fa24ce89f5410ff125e88537deec179b27126f3b2470e33e403faa62ffb99ec021688ecd533c601345cbfedb1a17d6f6b8f00b8d35aca42744c3063b3e27c2bc679acdd73f1d0fcb7ae69bf1e8640119f9dea4ac838e6b32e98958b5e3c955833539e6c571c2b3c104ebc10b6ca321d4a732b79559b967aec2060496fbc12e6c68d7c0aa094f32ffafc5c0419fcb64905516e23f7cdd7a6de5763a8cd584f75570857c3f8ba28b95930e9f3258324b55c24936277e95083003d404c923a253f15772ca1eac000a29222157576ebc2eab7ebb71c99a1d99671663a087a91b01a3e77242f573e33fde6a7e27ad9985707230186361bfde622116bee9e5a035d87f83b217e21deda13e00e1e0677af04d97fa7d9d693e36e203e95dccf17ab4235a6e995c55d04aa932429a7abad21fc0a00ab64f59759efd3167f3f1d47c28c429501d5f7cb50f9f465b57787a52d9a5419a6fb29db96a591ae37c03f1c73a223adfc4e2c992267535ad2f32a6bab9ab3dc365700a1e2f182d52a4a8f813e78cc3002610ec8d8ea46410151acf5e6843f392d70189eee13eae83b6341cf5603dba542bedccc5a349d357a153494967ee7d6285bfb59d79b304c80deee9f7a96b9063c0e5ad6431ae9327dbe275639d326815ed5e9d686512e3e115d9ef225d827cd67fbe0e5439f6977aab20c9829e8e1a9e41f7f0879f0078e446433a3af437d5a72be5f7d6d84a28c1bcdf52cb59ff4caf78d4e76ce7e1848c149190c17b3e719e9a631ba426748f9455fa583ed92a6f6fe35e186576af4e75a4138326295be969259d52ecbaadf8e76a3e0296f6ea4c6155abf50915f91987439e50ed5fdfd993da36f9749c4e2f2b9fa35be98d7c71ec7ebdf8d304fe5adfa6accfef985e6181160ec26f92713494d00beb2a893afc8d536a181d24ed7f1cbbf0c46a116d46b31210f0b48ac4af326e8e072d1cd73e2a02ec9d691558cdc36a90254c2431b805b1a5dca31910a86be5474e32b0a4113b49616f5588b7de9d63c8541650de6cf224d4c713ff01c244c516bbaf07a21574bcd4dc4f58bfb7e5d8dc5a72bc8f96d1ae9cd791c48cf44b8ae50fa82b9aacbd0899e1d9815d9e1a9922398cf455fdda145bff7878cae8c782fa194623a14023ddbbb7eb5964befda037e284e286f6e733717f48c56a23287cd3a55ef99a7b55df498cabb7bc01434f4c97aa6d62652b88df6ff65d91ce3008dcd6d568da83da158392db572927192ca333e5638b4c5897b17a2e07e076a98c6da75c8f989ce2f1f61889e8addfcc411fc946fa207da1c3116227c154dfef5fbdba4c30ac26311e39e0cbdbb1e0388a5572873defebb64cb55711aa79ee4f1bf32f70175a99e3d4ebe00fff2b98f9b7c9548d8abcb4b6894fd83613735246e2cbb5f8116e1cf976c7a3b045ff8e0e3c68deb4f01b1384d489f8977bb12936ea3d2d3e680ce83f4c8c9d37628f003780572d6b7613659ef25a1c867213b8536d0e720b811b46dd7d3e91e9d2f79d0904848863644bd679ad0caf9fa5e0e9bb903eca62de48fa53d69a524a1f090d07dda34a9eaaa5037141a37b253474f3d9ef65a51553af111c89cfe1c92c2253101f6e49ba40a5393d736d15699fb6b1d346ad0aed9f06afb4a2af529d097a2d690409a730ddea64f1a0488f5872de88f31dc3ee2425dcc3a599afbba699391c114c673ec97bf476c6008b262ce652220b02df133c128ad323fb3d19ad654686ec6be3490571930c76e4bb883ebf29f3d2f792fb993eb8c5b6574beb1623e06591f98e397473093e9b8482923518f3468777a287f245d4e1bedc6659e45af3da7f9465aaf88ad851b78b6262c1ab7922093b41c52e7bc4c55a2077ff0cbb64be0b4df91072b7c3f7efd42b7a26bb927235b8143b7ed154b5f4400ef5576280a0b7da811a5f7a264cdd8e2a6319375cdb2405adb0861765c80d13eb63a519892fde6fb1379e649aae037bfba304fb5cd879639f0db32816d2730ee716fb7e2a97e588fcd2ada6e0dbe4f245d83e21c1c8e8a60ce6c1dbfcede6136e4b1329ec0ce3d7db30e19c2c6e9ff4154c540c497a16cd825a58ed7e15d1392189415c72a21ea9430965dc09a57828e3fc5c39e43b694df09204e590ed7e308b1f56342708d0c5bde7e0e0184c4039acd815d05a770d2d81feb65eab6012560c52f735a711673e55d05f00c3345d48c1465c49e9773ec56ef40ad9cca0d6d849d467c9e33025f6073ef2c1e499fada9d86183a16de73589fe53424e2c48b329ad6ab67ab6488679e0a337ffb3a31e3166ecc6bac9836d46e91283870a220d2ec195c9fe6e10b84bbe8500293cba1f619c56b0f4a5db130cc0829790706d7a37b25940a8dc1d827cc426cf7a14dbdc69e12bb940fa2efead543ee83672fd5a332e21eb2b0cf68a3bea0c9b224bf5cf62d51d7a89ac6eafbd5405f89c9e91f642551b9f086490686a77d52b5dc92d3ecaca6567fc65e03aa9b17076b88c91804524f2e9af49eaa59bf3fe72e1555325cc33f14ae8586ee1df40b9871ed198623b0c3abf1382a7b74780f4695c5f82c33bbd66366a5592415b2f47fe0ce41f066a32d811a8c7931cd015ca0e35c7d2c0b0cb2a64c1c41591afd506add254f42595d429a31777a4c8ee2e43ff14ba7f9c4238d7030dfdb289b453df87156d3b9b512062b188ad959659710b7bf6ffb2ef67c1cd7a3eb0767b84248fd619fa571c894a324bb3b83473dba3fc7fe46c97f1e32ed5150cbbd5b5cca6f1ae8884283e888b1bbff62bbfea249747dd0d223552d465500f82c4dcc9dcdf4f56174594a9ccec93cb106eb0e782d4c7b57cae403b46a88615c3d09bcbd40b36fa0bb79f418252e2fb216aa411884a49b311ce0bb4a8dead0f6245f744e9e871cc8035eff348b416513f44ea6509d9776ffa9f35e6cd04f2e6d1e283db9bfa7b8e02ce0f73f0d8b605705ba378ae89f5f3e5d21d499dc585b1d2f9b13fe6c1bc597595690e795e7ad8ece3156a1fcb92fba14f860c2dcca0aa9c842f99f3a9604acf1d564ad129b2bd300c590a3c88e25c574cb00180dc3deb478b6521aa9ea2ed2354e1f2154640b8fe09355e1488c89738b8fc18218e61281005aebf552611054ea84fa08014782b96fc37e485d1d20d35e2e0fb04597ad07f574fdd24fe6e990a6fdc018105f4d0296ed3792731d428a952a4ff4b9699b2c1beb267a8bdf936413641ce9bb3cb04029bab4e19027e7e730edc8aceced2239d11cdbc92aba00dab17c09a11ebae8b59cc8b43660abf3001fb62d0d196023f706ec20fd4dcc1ce95928aa1cfe00bfd38573104ca8d80dd46f9084892c4db39066e49186717285a5b93446b29468ec3f3e0d05026034414e1ee5cf7cac9620c704cbe4de30ca3df509662ea7ee240ac3b08fd6cd756473835d19838860422d566d5832bdfd8a8908e8950fdf7b6ed44e801b97eff410bbdd9bb02f4ad20102dbafdd2a08c31430b65983a0adc8c20784dc1d83c823891ade9503f57624121f4b5ae29eed532df40d14aad777f5aeb91f87ee8abec1267ba1f4099d36b474ef623f8dd57780229f9c10eb7462834e6f66b64966cfdfee40cad95354ee949102fd8174664dc5faef38ac9a14f998c24b65509ba1dfb599feeb1d80705caaa18029b64ba91e4d6e8a710c28c9efecfeb9842a9641f0634b9bddde3fd6690bc6536fe4c2614e94de2620ff3216330f71db92f796c6f329ae49d00e2fa00741e70a8a94798c25c144fe5ac62cec3fde3f80a8247e05064af934d01c63d64313e1ee5d58a84b9d03d165ea36cef5ceedfd9ec086f170447e24f411125950df499fc65900a27fd2abe36200ed2d47735e933223109a92753c7be1bb4eee06a8bafefbc81ad7d38ad43f30c088f9be0499137df1856ee78282a183c507d4e278a071e8a5d24f860cd5d05ba3337c33ada48f5798c7aed67b76290e609ee1c54b32561b88eda47ce26af7cb769715d627975f72d4ebd1076c8abc6d398ba4b603765c78962f3f853eccf7356d3f30c6fb5bb925c4bda7370cf0bfb3ace73aa09b85cc950478e116f48c685eab18f7e8e45852ba9455cd6887099ab6f60b496d666c36caafbb68c40d14910a63d68c32a58c44badec719f402688c24738efeaf98de5e8bb69c16a183131e1baa8b1ed9e8437470fca459de04897fff61543033995c01795c609b194ea47b19b9cf8fba09a312ac3222ecba06d389dc5921eed9d0e35b79af8e63f9ccc5ea770594d33e9f58a683a54b9cb930514d3aa1e0e648099aa5e5f207bee94dd28626cfe5efb2ea3ba12dd7e2e72b9d5db05332572a4f508e1eb5a2951ccd33c469c97c0659194480171f3f439f475882c09ec47f0fcfce4b25aec764f0bcc6728d95577b12e90a6d79cbc6781d9a7cfd70e580edc25c8663bda53c5f0d659bd98ff77246aadc80ee2f71e7b558a34b9f45a887c08f5bdadc549c40d94bd7820dc37a1fe38311a5d2376c7fbe4f01dbad68ae8ec8d37c13e81d932b6363e7b4f56a6fe6ba87755d15b7b95f1303d9419fe61ebc37960ebd6724f4f391740bbe3576b721cb6d810fed9431ae137e7ac7c284ef705ef5173efbc139f4b154908a97e6ca8813bceb27cf2525c90d2cbeaaf0c0037948b60b15b3afb976a5ff2c715599f232a63929642e08a24c37e299824b741cc5d837f7a6ec6f3ed55d265d84df718464b8aec79d1c09c90b3ea7af3191cdb173dc04a79ce6ae806242fe0e5d218cc1de891bff66b7d867907e8e27fe89bdddca31da52a1834b7b63ed6e68692f639848974ccf0c0bcfdd5cc6f773f4543a8abe5fd0536752ba971b3be3621fa118ea70b0506bd07a470863e8702487dfa44cd2ef60673d45478d5c11bbcedeecec373ab811857a58a5e1b14f3ac9afb09dedd972288afbad9040d8af7486eb3039192a2e5d7b5e62b1f24969e3e7c4ef8479bbbe28dbcb602a6f51a9c4dda3fc1e1bba0909738086d1309326aadb1381c1d9172f1eae8b1c1a7ab7d6fa47835b0cd7c9b546ef716f6f02f611f7649b490d4676e470a9da285eecdaa2336b358d40afb7970958485b84f610ac4c2e60e0adebd398304eb9c6fd8844526cb01a10665659ffc8e05d33c74ca40aa743c982550c00b0deee02d8541cb862f849d82041e2fb260b937a1ad8879b33b242b1e9f35b8c8849b9283313385815ad146984afb3136306a76c2f16b57e12d0e23c591723ac356857af82a19c31a5040ef085593467e2d8d0d985c7317d1f44509e377636fc3da72607aaa18c595f192f517680ae8c78c4b5442c83d1c2133512cde58fde4fe69a1d146d4f0acc3f1f7a04671807c6f9857c5af7eb12d3211a1a694defb646585a24308e7381d860bd2091806e822b9772903a1199987e7161067d941be3ba09edaa7f9fc0bd593b28a7d9bca3137e3fd2cac5cb0a7ee0cff5133f598eba1e594034d6350ff2cf72b4babe97040974e7ed40db64b6b4d3a40b79f827df65698ef4447c84d55d0422354602d95ecaa0b4c97996435c1c54361b4de5b861f863ccba36037662bc3cd0aff912e32aa8f1281bad399e76382b500e546ac63c7856da8c2c08bc28a27714282ffb5f151e29861501137edeb170df2ed8dc7a3f4e6d3375f45099b3fe4a3e4d6cf16e8ee2960393fb6b4181369021c5bce72c19ad6fecd55303d7d0ce6c7daa479649dbb8082ea87c8d6d5bc0a10a76571494a603bba735ca53fdf67a659aecfe2e7a037b57fa4ee76557b51532b0ee052f553882b35222b0cfaa9736c6c6dec2d506b36d4e1a520460c85ffddc47ca6556c396c69274e20d099134c5e50e6d4bdc4a383a8ae50c3c5e1c817e9f14634cf46f3e1534c25e72c0c4f147db05db597dbe87c3e1f3c8b75d5a8ebf9ba4a1aca30d4ded4ed58f99951177ff33f85f6a4fa8bbe4f8b5d9ab4f68a6beacf68a72de6b69bf054ab03cebdde8ffb0f964232e173938af8869e320121daf72a97b01008ff12621bc76fe3411815c7d28f7bb9d0816e52405432e74eac82d238399ab1711947f0453d076e3c5662a94e5d0d1f7b66cadfbf307e585ce652b4cc73e278a92a0e595fe6998fb08b6f8d948264f3b9b2468348d351802e651bc55ed50a6130d4830764f2956830764b2d85754934ea7c7dbdf8ded2034018d982b51b75c2136b8556585b6b2176a115bd1cbb576933af6f06e6b2b735fc75492e7bb6457ab884f2ed3cddb41d0db2369b079f65b071f29f11b267719928f929e2f4f28e3cce145d65b4a4bc0c300e1dba50b9c0b6252b641c02aac8b18a7f8b0726a7e9719cbf5404287502edd12af20efb77d013a13221bae64edb79f4ec2bbcab574bae5c4d3f62758f97597a207f870edbe6678580b0584480e23be24594688752b9f0fd13869a2e89501d04fb7f7f64ea5a31de6ac289e106b5763f82b7e402f34727be31d0b6026f51722850e8ed56e83a7bd997a22b4cb5278b6419477ec0ccae0fffb31a3cfcfbd6e13e11c26c62a298e0e4cf3a05df37c9ae8cbe038d500322ea019e866883e1f54c3cafa62f5ba1941fa899a53ebc659b7d29f501f20c207ea2b284ec1b38f8560f23e47418b1c1497d873afae2eced4012fe5808c9ca4e4605539790052e132dea9f9410ce8b2120177b222a790afc98937b1cff732854f9e28af68f29bc938b90d3b5af90167b29a2f86831b02eece99b4c8b656f3f16ee6949ec8c2e89c67d7fb122acf95dcb6d7527d07cae41091f7132d321ca2788a888ee04faaae05f607196ea9116f1fe705f7830cbf019c5fb68939ed4fd620a7033649f4ddd8972691e2954b091d4417a60ee6b667e91b2a347c7a12f1965c55a8157639209f7cce570e64d84d02c0d7679033c405c09b716a7ca3c1c6430ca1bcfd6ae1202115da113cca9654dd4dca080ded4c55de1e2ba8dd0e6879e2b032d8a4f98d8f675482bddbc3bb63de6d925a908375a727565021c8bc9c9ca10fb00937fa745ee420e4ea85956a6b3f61113566fa6eaa02915b708f77c940e538f35297e815823dbf69025574446a50493b82b991f5ebd0bc449ddf17cc9b380397b75ee762c4a6eddeef6fd3bc8171756c3aea7c3e1fa33d8df55bf1a3d2d3e84226602de5a28e52bf814420885fcb1d3c20c5cd5a58db0e19474f0e304c664faa1151f612e4c15aa579b9aa5094d19f9bb4cd16bb06da311ca8a5e8538d71e4caeff418ce178c132243abe85364485d09bed074626847c4968f41d100c0b73fcedb1b9ac5fcabe82db135928a5a4ceb0dffc9ae3cfb2e70fc0ce0fa57e9d52db7389e91e1e02f758501058ebabebc3ea96d59d2b7051963b70aa7535e6b182094cad19e2f19ac995b2fa0ed1de63ed8db271ae79e4185f2b6cbeaceaba306cbee63c6479bbaa4d25058a9f1fe9d928af4d7168592971c6bdc598b378fb304af12d36421328cda7a8f5237ebcb87275d8b6b72924703c24b6be9555517e610f6621e4964fabb6661cf6f34522b191ca07cdb8659811b5737fcc283effb605d0978d0fb3235ff12f4cdfa8d85a4bf0d6632dfaa047256d8f09d06688a780ccdd7f4c64202d808da49802c87c9bac1c1db21873d45965cbc6629c4dea72be6899545d6977b613f48706075c2d6aab5a723ffafc90eccac1d73bbfbb8c982abb55438cc04674c8c8b027b753976043d0d3464c16120921d0d88262a96ea06aea2a34641b32be12d1ff0eefe6814a6f9a1ee810dcbc988e1c24b47b5f34cf38f82e287573fa6272f73dc7d26d29be6915fb1b866787ad6ae92796fcb7a1b7aadd98002aa511d74448a66c64790802b89958f65469a49023a1167de99c31aceea3ff757e8c84f8dd8ae225328ee46aa08ffcc52280f74f173beab3f3545ee7260d01723f862ef73df7fe532d4bd3e2126b419e5853e37bfbd89ff0f859c10c770d57279cd834757e67ca381a2f8d234338c1f188048759cbe4bc2196bc50559a9985c9452ad50a3d90f94a70d4bdcb64590ceb90949cf2d85e7a3c183280b30469a89fd4c033dc188ad5767f30001412eb6f44884ec7897c1c4fde93c82fc355897273f240250597832bbc550a557d4a3ef9d3bf3f26e6bd698e4e2544f5df95133d550270b4d032d9bed35dd47eb20eb0248fa1a4e1cdafd7799c12e4e4498c48a77b0b65129ad5e840a9301a21d50d85b81d1b048f20d8d809300c28557926af17f96811f49bb05b631acf8f9137b698906168b3aadac31d09d8e13afc9be021ac086a39827407ff3324f1efc81bac4d0544f2c2fc2f35f629f9eab368bd1b39ae6454a081b1abebc62e13c20a89d14af61789c4951b8669bc6fd04049740aeb23513bf59193c9a5074d3d41fd47d431e9a2b715a8e3ab28c4d020e8a17ffcd4bc82a8c98ae4bf9ee152830844970d6cbfebe785e8a94685ba06717e169a17101565e733b55ec62a0245a237274064ac34d2bd0c6bce6d4e63bba0907234eed38f258ddd1c576642881b8dd6beb2dc6830578512a9296a7ea32f63863a09584bc3d092f7ba3d5061a0c23f94a2779c89866c07df54bc4bc2b6e854117d7aacea909aa3ee01953b7b69ac89ac1046ab7ae1e3412096209e620dadec98e574c0c65b9b9ec96f1db0671ed47d63b4345e3911b786e52887c3fc7044b28a318f55f4a12999d7a0cf6a1a15c0616032590b95d665df1734c30b14861b55319f1c1bbceaea4a9d7078f8e7930a5a99004c8bfe04e8b87cbbd7ee94cefb27cee4d6daa84010d3775ed896431df9673dad9c95e2f4738f74a271d77d6a6070eb895b9a4940698816921ca5de508f910b376968632de2b22cdaad002896db7a7a0c30859b9ceb3100f68120c3a146653432c9b74a57cff818e6f53d000b5d175cc7c5bc5f58d24c53551cb1829d9190995440f3811992475e2b54ec3b73a1db3dbc5466c7499badb9a937e91ee4a4a02ff17031a1e74c1a55484dad817272362557842ab491d18b443684ac01deb98ba36a21752e53d2070faeed9dc0c5fc5a1fa79b277adf5bdbae72bcbe5bb91410819934c4c4095b7d6165d6a0be9230990dfe23a1ccb5fd4a8c24803aae50ce203e6228e4826ca34458e5977fac998048f532167b2258fe06293677b55fc8bb212d3a78f68b165b0a0ea21f96ebc9350a5b8db470becfc4251840f9ead6ce1ba35e8b1d8d30674e5e4474d1343efec7cf99506f90f3d5077af4bddb1417291f6781e168b517122ef8dd7e2bf84fc8cfe856ee1f2668cfc18d7a696a5de117a3fa7f83562d90c8f0a0b4852733459b4d5f249c9982d05014a4ca47121d78a71fd5c3d269f165e2651e7b4e2a9b624a0cebfbcc846de5417fe413cf7a1e0abb29404e4ec13ae0a5b1fa6bc40e6206f0ec62fead01ccb0c0c4d227d2c03a876524f000454d724974d77fc71afed84834d42b1c146f20bb83c2f0d1b20cc2625aa7c4c76cacd5e95c8f3eb7ef5f54d49be3c3f058934ee889f034358e1a68eefdde9e360b87c69220422e7aab2758dda7001ea8f66894710422188d407ea744aa31aad07b262d5343862062c12987b8e8addd036e01bd05338566fea255d37725c6c9d14a7403c03871986a7e49cf88fe7d661c8dc02eda1b2b5fe95ec687e131bcfe933cbc84be3a91d298d7a2444a9208ba986317d21b0a918ee3d8417394f82095c81db3c75449a759002a935b179f83d2cbd52364b6662eb4a467aaed83dd46eaad5b2ea3fd4f131685f09a45f620dcc07b639418de40813f55e55e67028db2154a52f7535b1389a6183181401645aae0389ec424abf7c99ad74383de15a276ea231615b973aae205556a1aed560cf4534a4ecd43cfbf95d78d141fa97df485583bd0dd0292a2ac3f15d950e1d4da931f096c39baa299218082e6dcafa9dfafa36fa4d2c719cd95a5b06e6ffc3f0fca79ee36cf516f5e74aad697abbfd46e03d33fb827259cfa0443e93374243fc007fb2a750148b333c59f82fb77f360756d4048c68573ca43b3cdd11a4792d7108d25ccbb08ca03c32b15ba3b7ada85ac25e403de510c06edead7b2c27614c3d36a255961551a91d213316882c8d09ba2d85fd80187ae23a45ab52de0d4982a48de658a7a5b3540c7ae8c9b7afc943a9bc46f0e7d46943af0bd09223f8fb140328d33dd9f6df41a86738b107ac51e2294676a55e9510c47c9024c359c67d411b09015e7f831d0f55a605e1a40a2ac83fe0db7a78fed8b30219aa626aed58c0b92bf551ac8ec5179a5459ace1c545ea44ac57d33141499bd927e59cbca164263f2093a9dc82b781ebddb373328b94c967ddcd1a43f7d521b6aa337ff454778388c5b987c9faf3d45d566fbe7bb8e7102e9a099a3d08d2f3043a0ab7568c8e5704243793e1c828caf291b58faa5dc12d8c52ac90e7d977e81f6d11f1783b4a72d3bae8ab6ba93c13a0fd2c66728a925e4e7cdc1eec09f30ea109e4b2f0b6fd7f06b3a5172d852c258cac597d7a907c9479a62ce3819387c56c013d10683cdc33d00a5423da488069c867be9fc710003df66485b9fbfde418b74f48a8f7c471939cf3105d37458357782b0b761fafbe8963d927bba38bf4b5b4688d8a809acc1cdda07a4996121ec0a8a19f8ae936c9a0e3fe09b4661473aee993f376578a17178d7e389235731a859a981da9a9d45763355051d0cdeff3c46a1a91ea5f8026801915ee589d11969bf8f10b27b862b111acd88071860bd1fb8b6199c8a2dd8430dc3152a13b098b4deb5db53d5a89ad2295f42b9de2261778ba0a4a10ff1545180f698fad5fe70a8acfe8b15a373f5cb50a0658b622ea894d68a52378499421f37208a7b9a8066565d2fa16dd76ed144b477aa27648cc5323f3ac3261f4031b3fdafb35327c4852082d8cc89ec91aa47a9146808c8361aa589ab60b8aa77c491d9aefec3c3d5d3b9ffcdc713bd82427fcbd762f62b5c0e91bbfa204359cd61c936f70a6e210bf46d8af4520069a5fd2eb70233042241c2bb3b290fa70121b606004476b2af4ee6881dfb90d673c3666096163fcfc71607c63bfa0a6a1a88fbc71ddcdf37835669d42347ec3d800138ea341ecbaebbcab0bfd621da4e63a0f9fecf639dd992e648063803f4d56bd778425cd1fe16c99e475c9a842c9808885743aa780f2e2bedf2a4dbb49a999a94c8fef414aa139fe21f40a8223fafcdf32d9c61796f05d69fbdde7aa183c87be0320c932dce4bd1835c233b75a0e09b6c7ac8d4e7744ac0f7fdec4090ec66f6401ee3e1bddaf7b276e3a27559cc49ab5fd422e0ab26f65f1bff15cbdfa82c78a8ad1517f512c1f11d5461ba21834a8a394e9618387f5e57ae070a772a2a38aac25f9abdca6da200bd3d34da036f0e334fab8ed274cf2eac03626d26026ec0150870f10645f21affc5455f4ea5a5e371555c0ade4b47bf7abf6e13d6e1362a7da1dd98ce226b67146067dbea5ab10843b5aaad39c444b1dfe30cd0002ecde9b0716db99baae4e7d025be661ec5bb9a659a4959667dd8af107efdc7613c4efe8721b0b5d7d913a884c32a760aa830b72dda5474f7cbde834f5e6b1a74a3b579b11168afe1e0cdb31034ab1230698fdc41e010c05070112e30f7f8b241228ccbf27b6dbe38eb8b4181050669b4bf707d48790a333e12cc045b0dc4624d70ecc2b065b12327c7933fa729ee8ae23e775ac733237d6aa1d42fff6be646b70831d5a0e78f9322bca905ece4c27cb58cb0c5ee1c04adbebe2bf5cf93f8cedfe8ac76a175c0d838302ffc06e7b41b8c91a9f9110c1f388dfdde1e8a82522668b672890e0e91733ff9dc2b2f6fd38f950cd42872ee9f4fdb5a29e330eb960074fecc46bb9f3617f08af80e5eff9d834a34090e5087205ad047967e33b056ac6b79f59a7890660f4aaad5e4d5cb073ae7a00d7511bbc456778fa89945a4519d9d57c22ebb423f334fa1f73c7b630d5f4efeecbe2149383a9c9bf08ec4573c5c53d41da7fb96c11485888e8d9e34e197edbb8623cfb70ed310160c1ce6922fae270aadb30ec0fb6190e8708a396f323f6d1e40ef97934a841a56c3ebd31bf8d59bdbf3c7814464cea4fe4efa8c39ee6f80efdce5096e4d798ef83e0db2b692d140dd412f16b73c4ac6efc6a0ecf883651346d1e0b2a4ebaab5754a362718c7b008eb35a26d7dc4d12746bed3cdf6abbb2e46a02ce16654666ae5a0fb7c43d172e9246627ce516d50465a0d6342f8437ea0b3208e27c01166df2ca43f322fcc2c1a30e3d50fe44a56084f1f08086491cf7e2b8734156f87447960a4f3a40a11acb86833b1f860014177b7175558475a2d6b4159cd0770de985664d77ce104da924b352f424d7c81f30b56b90e38af5862c981d89d4829be11bb3682656386af481502ef174f3502463265c1ced58003413cc3f73a6333a38ecbded1f2bfec20331caa20c9c1fb1e33bd382c0d8c12feb95c4eefb5e9dbf1533cf0f5587b0e3bc598afac95bff157df68906820cd84fde3919b0253a9397028626ec59099ebf52b9dc42d03261fc37fc2ffeec1acba4c4aa50d573318304f02e84a957ae94646c4e06ee88eab5b0a93285af7c62ff49cce78e2ee1b15ca5827525f09b6d603574957d6fb907ea1bc02a00f3d150cbf9958645d835dfbf728ea146d0ee2a298c77f27aba5ec9595d5531a5c3eb1ce5acd8bc3ac42dc639b8c10","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
