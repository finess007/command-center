<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"01133d2bbf18c2859a6223372e967b3800d4c7c3792eb4ad1dc4d398f409040716f9620e6fc97edd64463efa88e42fcb49c787f5ece4ab4727a3399e55b79f53a57c00aac8661703c611aea2176d68d4e789fbaf3a492a121c62fbfa14c06a735499327be833b31a82c368a8187f4b08e3f25c35f54b070daa81aaf5203a400d370a330fa9071ad3ce3015e106c2437fb194645299f605ea7672bc42605a93ce2c00094deeaf3a4ef169bc34fa21ac6a0b4c98a556f647ee3b7fa7a4d5217bf2e4249f1afd519e0c8249e622a2793b3d5367bd83f8d8c98ab2faf98e671edb8079db9da85ea5a56eec033ab1c64c131041bca8ab4b1fef454c492c88ac2c84d418a54606c1c07d4fb8f9d00349e15dda66101035a0d4fff23c42ea5de80c5b109ad2504633311bb4d4f535c4683bbd94915a38ebba78cb69adee3333cf2a2f7c27913dbebe2f154bc52e798cd170dd1d881929fca68c8c92e9fadae01a81a8eff4e8f96b6993f06cf09b477fe5db69345d793a8136e327ed145cd73b8bdba07228321eddd016fccb672b881dfb1db4b5c0595539341b3c55e5e263adbd4826253dd1936898cc8b2687f9c190d786b119ec911aec686a5dc91456553cb6705dd47469434df9bf77d91939d87a56cc638ebba16aaf540c4dc323af6a0e990eab51673a002793973bcc360bfb0ae5ee815a23d1d2011ae7fc4def3fd83b94b88796042f34371b2121d735594dd300012a0a5f472f17c7ee7a6c3d403695f3abd0287dcf234861532d6cd3a6b3534ba53f5486d75ed74908a5d4ec7b7683c4a59ca7dd99a94303d3d0f07c22bcbb3bf82b4b94587685e3c6d9e7f42ca53b87c0a93c4886315bd48d1e328250dbb46e173209377fb5870d9486304a08a5c190fa9022bd6ee91e895425592e0d3b89ee2985c69dcffa4fbafd78ad3c1f1f586927f717d0ab044ad57a24cb85aba6a48e89341d3944efed91ea243d6854198ad577098c4bff75be669459b18577a1161deb66598a8af4d47067e6f1e16d44387e97aaf6b4b9bcbbeba44ade07f41f8e4e36832027c1a0ab75d41c3a7a0775b04ac79daff8ade617c785d3a50452be3482f010e94b0ee4329946a43346c6aa32063121087878ba883a9e2ec27b85bcd4090fa8e201553107eb9a159d85d29accc93da7838d25d774a06a81525c08caa391eeb025a59c81176070a39abcfc1d55654d8f6b9b629d1db8a698a5a9b50cf76c589fe939744c27508ec1d11b850c0fbf6b61a626db3a73e39f40daaf96c95fd6c7336f86153e2f8086342810845320a9a3a02626f1d9fc21cd21750baaa6d61787bddefb9be73c57a1e5857b0c627dbe1d77d9d3dca44aa3852c66a5aba32143fb361f5069380ca46acc4e670adaedc3e84a530cfaa425b3c1e05816d81e995448b462d09d6b36bbed21098df420bf36e04a656da1735b7b594ccbdd0e384ac0a03134da07453be45c548bd3e0d737e264b4bf71b777aa435449de0f48c289dd35207a9b0a27a3c077a9f6d64df9279a6d5dc1638589b3090801e129a26c9df858ebb907f0e7f09a1352feb227ab2a62271003fc3e7af80960ffbcbbbea98e8dc1830b2333e5498b102d2aa228ccc113a9ac0ff208cb85bc6e21174132a82c1199276922fef51188fce535ec716d22f765a0a41da03d45a35626abaee262ecd7ed684e5ae529ed1217464d1e935c99aa0dce25d2bb5b378a1bd06d0136ef768fbad7e0b1fec8fe221491e8d9ac0a0fe27c4249bcf1558345c0197799a2ec33db4308deab56d9feaf34fd29d67e7d9ec2c8db31816370cc28e8dcc28b391606175f89a4194c52936a1f08973e65154862b6f4f022b20b4a55a4987a3ae0102fee1b280f94e24dad2704f2074caecba63d7620fbbeb4bbb6d4bfa4cdf937ca7deb3477f284a2b4f74e7e8414e1ba34be6d64c13e29ade81207933d742eefa958f36068a28603889ad188e0534477fcdf768ad80044dc2a16a818952bec92beae114da6fe6e6c2586afd7295faf742f7e4c61fbee34c2657e8751428d3bc5ce395843c824c1025c4a10f0635a2074314caa751e290580571eb4badef4c455048659890e415aa48001f6c3eda1ed7e714a5010c4ec17620da1a580062b35896bc51dfbfabd2fa556475cbdb18d9bb6dbf056b9d8f0709aa2cbd6b8dc3a95e501cee1b6806c7dd752a5673df0bce95dbc276b7831d3cc31a8d13fde0d4ed5737750d1b8645fa86256c598d8f346344ede1483c44e427207647e4788d4b3ceb7108c1d1e0238b49235810d13e93703df77d6be80b28ca2ecf5e76656d4704c27e0ddd41cf475e61d43dd7b288de70c131785cc96c27cf1c4a366faf11dbb24e0971eae49e707e5d46d75a312ce126f0208c454b2eb9f3388170ca8da5c0016044ae8502d172f6037f309e9ef92791e3bee4513f3482bdc2ec5172494b729cf3df17ba1c77dbe96a574907d9ed2d92f778d7e978733861a06cc085d87403dcd3ea270e37d0e9364ba1eeba3eda40d30b74f8b338e79c34d9165fc0abc8ed9bf0edb7faf3af574ca3588cd5557520fadc0b090a877b3768b99d519e5ce62d3d7e8f12470dba93229f1782ed684d5dd4d8e47633d3634930d4b0bd84454843b89db2a129c71eaa7e7d69f8dbf9091d6d4e00465bcd3b5d590146e0c8ca14270394e37781244b078fcd30fa76459facfe858c6b8eff94e8b0b96fa78cd059d6f9ca7ee1941f51a9edca7037fbe387ac44680c6c0a832885fe7401df0a02e88d0cce751c653f63e98ee2edb4ecf526e94ff363fda0eaf5ae0397eaf3ebb1dac53dd7e65ed7984a67ffcd4bfea47e380c4f1520e3125588edfadedd2ea570441ada7db41a4121633535bb1decb57e7504dbd2dec5733efc24af11a19c65323d50dad7a7eccf8ccfc14801420cee80f231f00967015d65403c582dfe580cd5aedfe5e3b93c4f728c14a0e37aec1a55a8b993d6075e1b8ee676ff2d29f7f8a76ccbf9d9730c3f7f02839903fc0f65e70ac35884a53c616b5645886547282533b52f7de224980f3b679fd86578c11e1800b5198cc0c3675e348f21b8f00b9fd0521b798c7974850d2a496fc51b5dcf94d3c5481c29e5cc980f82c5d787b9480d2e4c33048fb04c9904a148b55a910ac4a2eb474e755ad130ca4e37e36f3fa410b2078b1870ebf691c520c0cf9f085f2551a58df0acf195a7d9a08a832ca65928ad5672bbfab5fe16d398f12c91b9ce0ae8d26eb85aa7fa1a8183027f74c2ef7d22094daa2fdb1900b871155049b641cac84093275365d426079abf38f30ab4d2e06f6fd2789a1716976f1f55b1a31231ebdbfff0125265cc60f38c42a08becf17b5825c3b709529d5b58f7aad1beb7384b5ebe6bf1a42ee3b875b1206a55e0cc043bfe8387afb8e7d108b9d04a2fe83007278701a60dbfecb165e4c05b0fdbad918e0ca58e8c6fb4250b3d04f083100d1a400869c106d266fd5d1abeb32223079e45c7aa7a13755451a2ff16bac1df2c943b53204a1bc32ef84f335c0d260621b1894ae85938e44fbd238b6f0f8be3ec77e2f548f88b697e18b04ea395861665bb1d1b6bfe5ebb8b06f1aca4000a4ee6f8bc6477985dae408fb77e95bac714d56b640ecd6f3959b821d75e2b4df93049672276fc3d562fb22429e58c514245da912e2e7110a2bc7e9c1de6c99f599d9b7b8c5b2d15bf75e3f192709f6dfc36e6b7f4bac533964eef2d5dead56ce8e1561faafc06d7a114bd42b0519088a4162e340359feee3fae65f3146ddeddfbf146663e24089c025b8c17d211f8daa45fc67f16132c6ad1abe730a8908b35bb4b529cb6d96a6f637b0f0fb32889fd541b363c112cc23e5f9c42ebdeda2340ef776b6125168d412f950963da2b179ce67498b538abc817c7d08c865c2542b4ab5c97f8997de5146fbee351c1b099de1a3c12213aa902611c52a0c6a2143850b9850d5ac868155e70aec99989b123c2449585152d431d49c3576383d0d45cb73eccef820399aec1b5d7848307df60c1b9325dc57675e3a6ec6474f5b8ffdfe78d1f46e07f69f868a8450d2b4d773fab1d1090a2e6c46267cb78e3a64ee0ee210e57a42a7ee4c60ed415fd71645cd261236d187362d552745202d3c849a4eddeef308f4efca0b11a1298d9c2bf16503a42fcb57f800bafe737478b9cb1de0d15fe497ffc858ef0151f3a168dfafbd6417ffc78c42a14a785d4add12220398bb362d116c39664de0bfc8602a4f9a92689bcd31a0fa5153b78ccf629ed9677be54c0d3a662311eacf04289d0fc71a469f8535e539b9950e0191f722ab5ad09f6b330c0acc41bd9e1fa4557d2d0e4cddc4a1f6e682307bbce5e2e0457cdf3e825e251df13ba903a1d61b30a92a6e57532ef1b6a1386d94d1cbf969f6f7e87ee934e2c6c96804cf5874d1d4e1b2808a4ddec9320526a2d91afcf7b03032d3e82598bf250064359a76492ddd99f8f902f22824b1c87904b43561063d69d4c83337af6cf3ea1fde1b8d81809250d63ed3385c3dff6a58b979efc6653647be5bff125f3648b48576081b0b9501d84852ebf49c12ee4f4a2cda9e2959291e82036b5377fc16dc178a6c2dc97ebf2d03e021c9df4d4f33e0b55c89b28b8f816c55a66caf0976d8f45b5de833c8a3ee99feaa4405c90c1ae2955eb28a7a3abb5e27905db111ab1ad8071be477ac6d17ebeb461b9a1ab8a3f5d4064807d4172a16d2b5849fc40d894fcd473cfa6c4215d31f3db50cf7698ec222ba60206f381c5ad4cfdba2ef0de98b7dea6b283ec41b30e284c37b2b38efd70b38a0e3445558d9c95dbc2ffbce154b87ab849fbe7a275d0173f43a8b6ee611c5ab7b992f5945faff64c6fb21409b3371031f7c02ee6f473295677c5c4463eb10191d201b4b395c09e8a3b1867622389515e7449b3e193bc56208169f87256d7619281c1ec924279a331974f8c7343da018b8f171bd6cf71a6f7f060264480404e7ceb7d511c123efa7caf69aa59724692b00c464c77145b8ff7270901067721b4f19dd8615479b2668e0077ab2147e7943fdcf0a64d6bb68fee5e9f59c9bb77e7496a00330ddc47c5075e4a502396b803154f047c0e2b404a0cf4d0a630e8d97cd4e040befe082d942c075d857d1b03d8c9ece9fd0dc37a935d15d2d8ff48650e193d9c71f4228b4ab1098595052e26b7698d314388db9a3898ffaa90c06bcd07f5d9463896628af54b1ab26d0984b96222116183dfafcc1a8484200f40075d8fe7693b082a801bdccf1e86c2ae2ee3725ad7f4fe5b817260ad526ceced11fc297617cd82da8424023146b805abdb08823fad1230214aa850e3d3b37badc1911b5c5e67aa985155e03cc32942095b4afffdb879372884c95b2140e4dd1ad86ca44d6ee5dfa538264f4e98fef720f19072af77387cd16b764795907275d535c9d9d62aef1ea91cf414184ac79b7ef356b8396ce617a549a451d8f76a05402994161ec6d4cedd6322df6255c6cf147a9afb8ba8c15bd47ee2016e9bd19baa40b7f0310168f20b633d024c59bfc3d474a3bba136a9101cd3ce6124ba54a071a4852d8370f8698b77c8630c163fee772f2d13c99e24c661e989911d26aecd854cffe8a8f2a9967f6562c26b680903c9c829f8c26ef534f15f904770a238a093b6ada543be63031c385835c3b5c51d0bd6c6a1934c6148feb42517216197992965c196b83f1d820646d26428a8e19a98a750cf996b34ac46f74a416b3950264b77a0b1e7afd3afed5d9d7c7229fc579737b40a8b6242ad2a8eabc449db888ec627026f9b21b3d555cf20a429212ffafd5a22e63cef2a4651f0b113f768c21e8043e4097e0582fbdd36ace5f74a48177956d5f3615e04e6607fca61a6e99c6e11fa5ca6243096671cc008196d8fa9ee766928d1f19127061ae19dbcc724662834793982ac096fec538608dffaa12fbc2253c4403a6457fa2fc6d488fd35ed2d69e0a8a310d757458471a1fad3cff6836c1bc4f9bb40fb6d25243e22a6618a14272914b18526fd2427c49194ad48e90dd8dada6e2cf1bdaa6156cb6e65be9f56ca38677f16fb65481700f46bbf65439e1ac4109c1119994e393f49a0a938e4eb3894b1c6d526075a91be886a4061783025f01a2d9dc5a4e73ac779e95487d009682a25ac9dcee078aa3fa9341a0904b6d8caa3d6ecde8ca244ab8a9b731158d755c02ebeeff05fb6ce6682827938c90c8a62e130cc5d382e62dd7e449781d27a2bd7ecf3e091e838641e70bc4df0f2357ed383067eabba5ec6b31d1e783c0d0e73c0c9fb868013bfd4c7635ac88cfcbca8e290eead23505802422eaf22ce09ff6e967465304447471ad60ab57546e3c5407ed605cd5ad11f76caab94728586266c709a249debdc115806ce78ac78d5e94a751f7277085d22157f7e729a42d476d01a22ce81f20d149a3d63c81b0ad9a868d71a37b62bdb92c4f8d4de281a4ac546e246907e83f2d4c821e26045551b27fdaac789d3d0d596d6c9288a358250dddceddbd9e1b9939566f2a5baacdc77af66cb4478b36c431eddf4365e206eb0848670b4c3e6e5cdb0ef31ae79debb79bcde1c95d3130519154ba61bad08eaab575b3da535196a6455c997e1cd0a13f5a6eda13058469f2345df4fda46ecbfc737273d2907861b95dafabadfbb29d043955587fb676bc70bc37b76f75a5a6f217c24d3734f4c574ac39f73d68dbef8ec4d1056501b8f74cd7312887717fec280ece4389b8daae55250e2de13f5cb4d465ebbeedc6bb20631edc756149a08c229773062d01c846f95c541e07652fce7e6657331a4255a92873b81a32f61d1174824e4350b8ce865ea009abc0e9779914dbb9035844410adb3eb0ae2371170a228f851e9dc1a4faa2d952bc51b989d2b0fbe49e9c40aee83892b33c5a0e81496adf7e984dd79529a1bb92c1b70468290b593af3de1daa82d2c876aad80c18c26efdf7a91c7a129bee5bd7c11a2dafca9bab87152ffbd95494eea57228c3b8b6e099c2aa8f6eb59600474b92dff9405a6ab0fdd62baac1aad8e25123dd83160697be05474eced78eb029a620b8bcc72886e62bb512ec46a601b771deea41ccfeeb41079356c38f04e24d679f8af223db1df3975e41ec793ecc77390241cdc53571c812c07b306a57feb642e43ccdb8f519ec3c26435983685586aaa965d9cbcb03f7995010c2cf87ec461370afa2da2333e458ce9e1128ac96c5fa91c1ec27f07062737d7024deb4e83c689c985d48d55868d086eb8d7cfc66c5a915679234a95106ad8c7c8fd8e66c3e6834eb9a696fb124696e4351bcee847762d29521312dda6378b6346a5c120b74d5f9a7483fd35e269be8ef2f38038952ea68b92e2fbba2fe1f17667ec31b8cfaf63f134e227d5b1281c722782c698c5ee7126d9a86b044b6b5dba7a5377a49b7aba3089f2563bdb764645126ad673f0ee5babae56f4ac8b272bdf89bd3e185865361695227c1334f49a18b803ddf6b1b00ada84cbf8fc879c050a36c966e9eb6362b942ca656dceeec174b7d8812e0ed33faa3759963d498fd8283aef24895597bf75240131f6a8750b07596d7ddbf43af43ed3a2d49d031895cc67a09db9cc05b274c5e95f9f1cba2b7098a69c17036ba8f27a904bf5fe3b287e025e91f935bd24ef6915c4f46555f5916f9c02071b7932fce44bbbe1d923a567304741d07692548451381ac5418b4cf4410a651138cfa3d512c610330721f7eac643b59cc87eea229bebfa365589bc6567288880a4f7370d15820fb5d07fc061e9558828a733a68d8917624b6785cfa13037f9ce9449e84f058a4df5c65a18f1e332ed834121df5c6a700b5305733f3d8e1f389340ee77e11cd7adad0d1f152cf0bf4e564a692114f0f60d57dce1771fd6fabbc9e81cc3b555c8f5dcf1c34aef38d59353ff8c4f71d40c5dea2a32776fd41efb2fee7bf3d390ecc39f658f33a0440e8de3ae0f25d40d1da54ee1cfed13f8732a6cde0ddf9e77c0a77c354d88cae831b5f700a4db2c8f344480f9e2494f69a98f709863de6e39d3da2cd94e32af81374087e1dd03da325365473e750cb7669d07c2908e4a41ee2b2283297b0c08face4a2d49173e044e81966196470ce562c8e431fa25f148c88b52d272b4c202d21dfa7d5a7c12e286b9d74ee48179c19aabd3c27f38f770850d6f505c9b54d292813f36934cb51810a5083cb40d8e230345c2f7104be9afc7ce5d642b8e7bdfd53580e272c2a260ece6a120d77266bd28ba0f973e5158192a88694be17273a0faf993df42a64110040d2d9eccc63bf2d83f9e1d50e6f167fefb72270664f544425a8b671a5f5c88a6691b8d6b495e92199ec13722c72da9146337b7083dc539766f6bb71275d57a0bd31867a7cc732a30e50b9fc63974fa9dd2c92e9826e21227ce7b14f22b05632a7b49b81340ef4f17c722e662f8094350e47907ceccecdbaecf15717c5d5217eb55b6031d643348b8083bc54d7cc557bed8518bfeff42069e2d2dc88b8c78047195f4730caa710f569fbd4ccabd0d3bd0652b0e4300a79f904c0222b1e33d5aeda8b1802e4a636474bb13a5d05cdc286ffa93ec660c1083a4c6dd19083ae4084f25634dcbe40af31063749b4dd3b9cba5efa9be9e4920be7b3087729da2862e62d61b84e85d05e66909ae19678c1a0b352dd1f292ca411480594c3d3a2f939ba471571cd314919128d1600ce1b2cddcf1f24b1e3cc313b0f17909d8c67d9f4d23aa45c210b5c07b3a618424444b880cd4ceb69b9b307e354475d1a9f43fb26c6c6f87d47b1c3697f6ed021dcfcc57cc5f8952c461aaa997ff3831ba22b71b33bf9a052a58ec61b3b0699841311cc44a88c1991f5ea07ea3c0b6861db04d792d32218e84ffacf37a64116178600d24a234298b8bd3849b29161e439c3efcac6c4ffddc01bf8d5b4f3b76a01e967f5b2cd4ddb1e0191229ef0074798ee319d2e828978e54887c1c0a269b3d2d7ce11af890ceb559c24a3aeb1dab11f73095c5fb07445c4fa6b9e67b231ffe81689a5335011b2330be71712a39f0a54803d54383d121521c4bd5b6c8a3aa2390bc13908a00550dbafa9227ee547d42b98e8c4bc7c049551a6edfa7eb102f73c699f5044f2dc138272e3243c7f21f3a6400c2bbc4c54d639b53dfd33fe264878ebed07e31a828326c6bbafa7b22b64b65e97035b32c4bae2c315cff7618d0018887b4167e24e9af9c8622f3debe6ba9508f2d4d2e19783deab11d767f23c5fe059f9adc60b3ee13004fa082ba43390b3f5c1bb2b522c0f48852cd34b04fe34147e5c64b58879fea9184788a15ab79a1890213e90086881a0142cf15ccb6ebdb32099c22809367e08f635c1f359974f188f1f777ea6b30cdaa049f99a3cb8a237870b84e4bcc1d9fdb242dff085de7a22dfdb72ef6ebc6f83f098fd4cd9e317562d16fffe914e189ed43b82fff3af621f973deaa87c88a05e70890d56a3ea07618cf1aa44efe5a53b9614bee9a0a6efd6f1b0e6fdb0cf271e135e0a74df8d40e26bfb90e0a7a296bbf3a9f3f6038305b2aa488d94d8b9b60900afd969ff422e8ca689487557c8650c824c3a1e972daf46fd0c333b27d15591a9db661ba1e1fd16c2c2fcc3a6dd38d6426faeaf5b94652ce816d1d1503c325e5938ed8fb7dddf43ac7f31a07e8422d7dbbf7c32a92ea606580a6358e430e16dc972478bc65d367576b56753d93e7857cdce96964345a2db4dc838fa259bf121c0c64e22f7d97201f619d7f6df8f73649ed8ad30f283c25699cdb2d3f0def9ed57d35bbb1ed52893214748f70799ffb76b90eb07b9b6bb72228edc3ca272bd412877be95f9558673b3aac7dd5e63c9b412184b47bd65e7c2d2fb3339f56ee697357ada727f0c6b1f17f72d4f02a29048115f0aae889b8f600d13cde64b9036e458b9108a83de01543fae7c01be4afe39f9836dc85fc4a72da0710ed1daf3fb42773bf35f6636be3668eb077ecae0ed80bf88fc28fe6dd351712d354782114e1865731de61914d10c22ff066d8c2204f9312fa6bd23176064436b348f08d86949869c9d26561d8cfd9b55d49511b55521811c504640c42f49d9208e3e285acc4c4e2fc79bcc2c08e7e8fdf2c9018d137dee9ed4cb76d1424f5fffd51bcbd79d1f1f5f1b1f1839f14dcc65a4852fdba637af2b95abbeae7dada86d7d18871fb69d6a51462a4b9d0534724634a7a2e1a84932b3ada82ef70e87ac7a49c8e229d2cbd23e8a711a0d7518f7887e1a26fa33f742dab3d58fedf9fee653c385fd2c241f7ca05dd8787f16f41fdb4ebbfb42ff3c7b4f59cd3efabea7b184f5327c26a9d2fcc230a2b19da526bdc6cebec56e436a367f6d1cbc671f073b372c603f016eebf4d135f79bc276cddc4959f0b21d491c3c72c02ea28a558345643be88b089ee4ce95e3621ff0bb56766d47a7c44d02434faf6a48755c8049b28a74f5d06d093c9d92587cdc4fcf259e4e0daab109bbab0dc10240bc9fc835208bccd84f4988caae9118ecbd3e2085a854a3f7669a033cd4be5218ff369b4b5807b4e6ceb551a5b22ae0e57569416fc5ea923a9b47cf6e9b54abaa3f25bd9fcbbbacf3270c24426bfbfb2ff4b2ae3c0b5fea0a7867c629a319b54109ecdb6998ebac0da3ebad11323f843d1bbffa6314b5a928af89e25ecdc30b41df2181666e0ab3624f0b7228450c12f4e0b98d2c4abc698833e268d7a7ed1ba0c45507d925d4da64c61237fb7eca2d2cbf4eca2c213ca75916c871c7d2f7f3916384900d64e5fa6266f1ab47169d2d3aaadf6d9c0d2aebd2006fff6d256ee97587d9f4bf52d823e189d58df91e6e1f10d254506fa218384bd0861827438fb7fd5cfbdafae4f65e5a5454b4342c7b022765528f5584e5bd8e303d17f7f9b71bdd73aa89063e6ccb3e8293ec89c66ff0c28e6921246b1749ec171576546187a5c13389a61959de5899bf2188660733adac6464a8ebed6ca781ebf93a94cef94d0c72553760c0000ae77569b02976d669bbe61c0f810fc2d9d6d69ba5ce6a75c120d1ef4cbdd375ecbac3234487c9d078f1bd87b86aef4719d685133928f78087767bef67105150cf1967c980e95331dc9d9bb43b119412b2aa28b31b3a7b5afef69203504a77afec23700131f71a15de46800a20455f7557350840428c23b59da9ba2e97cd52a68cab1576296b697c6fd5bf5aedf80ae7d1bbe30955dd18000475d6c13a3d0d9c65d49708664fd6c7dfda12d9faf5ad273c393df1bafd9abd530168827e749660e6573982c7fa8dddc43d4a64168426a380cdb4d36fef84b985602cebc76a23f9a8ee6ecfdded9bf667bf76a9ce1763444b6c483c8a3f51cb84709efb4f241d731a5dd29e387c1bfcaecc366c901b3d37cf9c46d7e588fffa70eec3772ef6a5773d12566be0fbfaf0b922b576781809614c6b9cea87ded0b7aa2185946528883e5be7bf1e14610375f53940f0b429be79079cde9cec91e3687707afc6e8748be214c706a5cd2bae7745dece72007292071e32bd3bac03ecbc41d3b32860a67544fcca51d606f361b1a378d577b260ec8d2812d486f624cd65f9270e81bb12b92eae0b4fc17ed63f3acea24481572292f10f876907df72fec98462e478c8de06ef072fe1fd3def175e42dfafa7f0cab5da14e96b2bef8cbe9160d0b4f006cfab52a811184f052cc23c152265c171d2f5d978ba58dfe12d86de00e0c50be1265e21c67f978277f4a666a8cc6f73bf47267ead2c68b2649620f99a816bfb8a5c2033aa8d5a18180395b9052631f0d424df4103b4108cba92e00f4cdf956b0d5860a0ee7767b8240177cf45c701729b31296ae4d9eefdd98c5bc7bc5cac17332a6641987e1caaa98fedd5988cb8ee7db01c894f1709e29b4b57a99ab0430e48ae3d5faa82b113120b774a05a012edf071217ec3a7d1807ab6fa9397d68413fd485fdb310e3d1c422b93db28ea4f13d42b9d279ba5f98ea98b1b1e18475db918e292b970439a1f83de64e17836b1e314378c26a48bcc1a5ea6fc1fb89005e1cb68e19dd76daed537a9ff05f08cec69650158f4bc499dbf227e26413a136591b00c2c2d56cbb4c93e91c601e086f8a7055f0534311d1df686d48ced1cc0a47145744d8c0c96760666aa72db23a47d7c9e698c2a7b5c039e59b76673c8fbc944ec6a8754e4f1c78299ff3cd57f74e4c0497a12389f3c1d9c66a47459381502306853c83ae324ddb56fabde2ea351e07dbd42a0f1228bd8b70f4218c371d3381e8b43fb38f62ca3cb44b26f27291d021f934a0fe38289624d6b9546800d83a4c94f594771d0533a24d4151a33426834dac05aa91b6c5796cb870b7e0a489ccde12572ae9a48659e6cbf3ae0c6d9b0d5fc324cf3fd2990dbd2a4e266d5adf65ea14ff57f0683cb111d4a2862079fb764133c5123e7f6f9af7e16ee627d1fbd9cc7257ffffea6d26f377ff8ae6bcf3969d40ffc998dabd87062d2a2f159abbe50c9e2b57041c65aac511cac7c8865a7badc11181a6c484c82962e599e886f1290ff04e80c1028bc2541e7cb406174fda7500199e882a3e2db8f142b98e6a831ffd0fb8fb398acb9049f467ab00a818adc28056ea34bda2675ecbdee61fea0f88d4fb85f6d95b445a8ebff2a941259a22d31601a5ac31a13ca84f49bd5cd57f7502fa1a518ff63d76c3a6d1d52eef445a5acf71ac77d8fe35ad48ca20ece3662930a56075e0dff2cc8dac94fc6f91dabf97808d53716f2b9c8a9e0eba7b7d3167fff97c9bd1940f24fdaefafd2a77f54b4aa10c9494da7e9e048be27f2259cc2b313a382e341aab605a18aff56a64f258c037da8dab92db9e685339ed4b6841c9c329dbf314a3e0096837eab8bb53f2f8aff4fad5e8ddb873554dae0ee0df6785de326e2171d32a3a24b1a7fa8644513e74775bdc706b49499b645a6639b285e24a7a1dd506e5e66d32e9cb5808e9472423396829c50ebdbfd551cb8e38ce35811c981213f23eec09e7f7e0a7e336b545f76daa5bd173d5e397a3a243fa326495e2b2f7dafa011e77b4e8e06fd3f689e8106db27cd227046adc50f38071eb2a146a6c4d271a2b8c3798f1f0414638d951db28b9d3dfe7ba49a3c6e32dab449e9ebb84e0ff734017a51562f30af51449ba7fdf08cb142ae1c88e8077b2952ba50c584ff8f5cb76ee9c994f3573bc690fe9b074218f774157cac79d171f2e03adf2afe37101f356b2f64c15a350f4eb73a78d00e47d7b49b55645d00704f822567388671cdca0104727c0c4c6ea38bfb4c8bd04bd3b8640a9386b10464b3d17b0f8832ceba326571684803c2bf91baa5a84c086f3184dfb4a24b1bdc1ac9c9c11e066cca55f911087e02cea337d991810aefb6001150195378defa5d352c4148c5c4cbce71bb862dc8247efc63fd93764102647d28103eb33c879c86de3db6c38acd45fb4423217818390cfd91048c19465ee776eabce9ab30d6c2f6125280e13164b38197b273fe401dd5a26707da85557fe7a818de0f156dcbf87dd754244ebfbffaaaf9d665401200119b4a280c530f28cd8472c5202bdfa7cea0d24172bc1573009eaba0bc2305e0cda889f1e40f072afeeb5eea61a1fbd83c3df777a23f551ebd9c9930b8f1043717f25d85258baefd674e7aa4298686dd3bb8a7b92bd204b07ff6045ff576ad269523af460de4d8285e0130cb27019838b9ba8a397ece30d87f771635851d7b45fd10dc2bc0db9de907f133c6c7e86b62d2f46e1bd89845d3a37ca0316433f64bd27bf489519d65136f163e42807ce6adf806da8b32e8f16260bb595fb0a68f31bf7330520f24df0b12d47374a6154715294a1a925721c5f3410fa3c4380124bd4bfbac2537e5819208e35f5f53abe2488d852bc76100efea26c78acf72fb630b50520012d8aa3efb5681dc657a886dbfad219c8b9dd7f61c3a6dcc559d90906bc3755aa3db509073df0dce797930848f9cd187a639649c533c82e5dd4dc64bf4a6da13cfdb3b25e0cd7ea36f2cbc55536cd21d368432d55387d09f239c354105dfcb4c8fa827133bf83eeb4c77892aea157b32b4807346ce38b39c663cb15cdd14e7c14652c1a3add71fb7276ca43d98b89ae3e9f2ef51e988028ac42771c5db3784073d8536365cd90d234ab624bcda90f77bf1cd26048efd5458c306dbd1a3dbf95497d023b3b21685692072fc08a972583b370f691c2c59c215f684145fcecc43d37a466b537f08c1865e54643ec3a27dfef6713fc30e5ffc0670c22f2f59c0cdb7862105ae10cbeb48b7e78d7b125c508afd5d0c9d54c5e63c40ccc2d182594b86cb1463be91450cd31adf66c7105b2c797be0996ea77979231b0b2d260d73d579d43332f67500cf04a3f8aa7e0a86304a84830fc54b0c0797e2686ef579d154a524ed56224551a1e1c800695eedffc05d57444e149eea71b1e76b6dcb0da1be1243e895cc24954912425af14746ab487c4e122df0689a9b679cb39539631f0472f3095bded8f3d05c00454c0befa780edf69303f72f037ae4f4014fe14badc8295f76f44070ed642f6db71320d1f041667e6ccffae37a861c30f4f836b1b388e297cf6258ed2437512457bfbce4b53e4295ca01f0cbd596a15852b61b23af6f2f925bc5f88bd02b52985473a46bbc96553e9d4f293462e4be0fe5c8fc801b4220411c7600b9d406a92ee2d55b1c3ea2b9d44f27b3cea77dcd5873afc20027940fb1df8b8325a5cac3ca8f12bb2037fe4cdd677f68eaafbed479f931f32932541d74adaf4767a2af7adb4981bd183408260c7ede46db6670af865bfb5e3983642edca28999c57928964011e41def0519278229eec5d5cbb6aae4c29149679cd6b855f0d67fbaef2e201219491d124b2df1a8a8ba4a42bb8b0fcd7bdff394fda62f5c8ba4a48916b6cb8f1f68264f2a4e23f2bd9df105fa68799eedf73121787ce9c36bbc767d312eaac475c481a6a8c10585d83d48463db2ed0619953f2711b8e2176fcc62a1429980df412c777f2fc7c31edf643dfd61349dcd20d06142c354b535fb66063ae8d242a5f4dccd8a80e149ae4007d976e51c8cbd5975189dabfbccd7198b6e0931a302985523b930dc81992fc0ea199e58f7fff2307e9830500d333ff08201083b779b2f1274ace3411c1493bece8785ee17f0cd93968549d1005a284368b9999a917fead6864fb230d14046fa238d61eb8db4fb9d00b5a472c8a2c236c3b66c7a67fbb2f584494448d9292ff34a182573848652de4bc2cf11fe0470de64128b5abaf9ba1686a3e51252a49214ea9caaa2bcb54cfc68103032347cc1db436025a21d85b46ac96aff3ff658b26efffc8dfd70192c487179007090be8832608547c18193cdcac5c1c44ed51ad2218048d178e4dd694d24273611bc58036192fa09cb602197cfd8298240eb958ab3c124337335000429c89b4cc377830d9e2e9eebc8a9f7b10f7e8c03691b13cae6c78b490573b6dcb71cfeb469a0694e87a8e8239f9fd7cc4337f7e50bc2b726d1bf2cef851f1cf48c3af978645cbac3a8c980f755a8b0b931510907fdb8fe7cea0c5e547b3d5f4f4fe7952a30ccc3910f01b451b89d0033280d98e71bcb8d16b7e71aeff4831b93501141ff19013403a244d0bb11b9d99ff9c5c9f46894aa971367898223ef5ea37a9472ae1b20ab725f5cee598ab134c6a9cf32619f4873c17175779ab7da74fde437d7f79f899bd8457c458d6fa65cf1d08740bf1b53c6e0d9cc330a9abaf5173eeb2eb4b3138b98d1e75b28eea3b814b8fa0422d5843038ec8e79de271eef214870fb21fd3fe7a0354d09df8ddf8ead9d34acdcfce6af478c43868ace388141166307bac3ccf3dbab5cd63e5ab7ca9bfef1edb41bf831b9beec46056e3f63d494b2c957b846fcda532e3056b56dd037edb800d1ea37","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
