<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>Protected Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">Protected Page</p>
                        <p></p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="Password"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"d3e3cf3f0888f110b1a35eac4e6dec5148714c8e0fcd2a810aaad89e018b071a79e505d26c5b40a6dd5f09ffbac3c8a6542623fbfb90092d8c6ece7c70285376d1897125709b16b70d1f4e88e929e2dcf78f875f1d0b53e51003d71e5d8845b5a83dac34abe5c181425c5a41b951e2d4ff6db882add46f4bf812c78c661886ab26d347170df487c06e0c1b509b2926aab2069d3d9fb0c1140758e63aad86167fad1e3524b77bb390a0145fe9a3fb1971ccbdb1905b97b763ccc5280b91f077c48570132db5425da9f7edc2fd11f6795d4838ee9011d10e35866535ef1a683328fb1deff98f753f3d4aae8a5a749b0938ca7f6d41634ffc1e0c0fd08ab8f3b916c5e17f215456af994ba85fa3e4911fa9609283177eb5c2a3513d91b7764fa915f5e368274a888b395d87d42a35602970e1e229f9888bb6f38f8ee4606d957e0bc4e9faae3813ad68df30ac53f1a3549d036788676626a7bf2dea2c1ac82925dad9d1b831bc7033b1ee856bd4b4516658755f8980141297568093cee30c6407a399d4e2aeaa81c45bc7f51a1bccc3a8b0a7244eaaaf6dce71ab1b147feefd310d50573c00de8e0d835c9cfe661059192854426769b5e4809765164e24cc0e3ae53570a6f1fc2b51f4e776ee10aa07b0294d359b9f5263ce45a9913687f2fa5af957ee03375aa7ee3a2c668fc9cbd124af3b4a635017f5b733cf5b90baafb1b0966700254e6e2b98ff58aa16e2af37b0a0e6c6455905a5b260b8a66bca8b274bf1a8d84f6763587f422a818ca20a886f7f78816ac1737196dcd2d7b093819d6baf5a6bce73f2030560f2920d7594a8920f6cee28c26832f35848486c42bb49e4b2d7e2b1e10fee9441b8764d53fe4bfaf51d158c232f90a6f748dc052f6d476ea4eed09bc2b866a99fc6f2339dc2f5e03d0a0478c3bc9eefcfc03c7c331908d85235ff8c88bba6a3be2b8da0def34590fdb8a32ee5fa946aaf6c66e0b640779e6f0ffea4f5041f1881594c1313bc0fcab0cae851e56f013d618f2b0be30bec1e229bb433e10e0338bd290d1ff2cf6ef6d03a88a30d61f1ced9d987eff58b07a36e0f971f6057a821dd3dcec43497ec09876cf250283f1cf4751b257e039df1e535c6a5d3436577fab1011faaf01daf755c6aba438c6a88903857a24839190625905f7184f78927593005e0e9b2fbd90f71c5195f74c30aab64089326f7fc3c65287dddc7bc9aaaccc22b8c0c0170d9641eea372b6bfa8e7c1e4a778ed1f0607a47a6a07ddddb59fbb29e9fd91c0baa71b1c1117e31a3c78a81d547a790c6d4fe99df78740ce0753741cd6707f69599e0e2ef1bb3d5b33262c7026f8a2abf9b595afa1a10be9cce2113ace1ed9c3682e599bb50af7907302c930701a56cecb793c3f626839f501e2dd02857598168266aeae08fcfa053ec1902825c2fc8b46856bbea24f0f279adb7b5d4a0fd70255a0c6df0412800078718f4efb9b73aaebea8bc8db449bd995dd31a922c67340f1ddd7eadec567cb1ac96ada590231a6f4513f1f63ced40ec56296c4f76539764ca3b439907763dbc0c3f9e0eb0ee6d32ccf72ddca84e750ed326c64f065c152cefdb6bfe28efaa04f64162b630e9ac3875236c1260a53c7155a48f7a7338a5b7b2067689ee66bf336e789c97864489302f638afc6076b7dadca7df7179d779700e7b50f340d701582cc40c62793de8638038ea4fb19e423a147474796ea090075e9ea5377b0c94b9c2f13b2d90f30789867e7d45cbe5bc436656e09bdce69584b7e041fdb4189a5d11bf07ba88ae0ec6102535e9bc233eb1a28ec73a5319d5e71a48b3682842e64dc0a8bdec155bd593b2316a54f580b96d08a64e6f7bf01555048c6c2e28de640c3e0644d1fe15d66968f15594a0ef3ee544bb1efb129e19f42261821547e2a16b46a53bc1c471d3f7c793202259c211aaa0a7d2824518b471799ceb842318e3ac29dc412b9c3efcf9dae5b9ac0f571ac3785b21f8f55830fb0de7af6b454af5c7489ed90b233e0ab7d555cb78b440509859488c1965d93144fcc72c542e184267bfb8792ca6b1b844b570ab2a281e7f95edc2c20eb1b2831ef75f91a93b8fdd8764f46719fd149394fde80a8ce061806452298fca91963c1509b47eacc7526610cf4dfa856959f1141d6c0033d7ffdd3f34536474d74015cb0d55fd15879b8cac415dceed7c99c5f2127150148ab7f3162b5b82e953ed502a973f99bb64db1436a6f151aaf8b9ed3d808171b168778c559261f63b410c6d72dd9e11908fefffc0ee823a8781c70ddd88e11e5c1ace0127d965402f8288db659ca0b98b025dd35f27597eaf2c452a09c9e3a67dcb6a1a332352f25b295050851c50ad74a5de36ddaed6917d5c492d609e9cecb362b777c13fa805c4c99cfcdfd359a0a8bc4f157d2165848ae0cee189084377ae0e27badca695664be828f220c2de3e39033bc83e462d882c374a24ceded4a3fb5b73a3d346091a08023c01e015158cd74ac0842d19b13199d147a4c3135e749a55322e8c9213d7e58137b93427b153605d3fb51ad624d7d582bbc177ae5a0165fd005d568dd31ac23688b9ae4c1d99a0cb6856eecd6c0fef06451208c6faf2464f9c994ec378a74edc63877686a1b1f7667ce1a3fafd0e136889466b2b33cdbe6e94fb81306180bdc7495dbf12a41349ce64bdedb30cd20d6e7418ddc194189998bf0674d0a9a7cf9a132bea2f0389643582e9aa1259c4656ae5507e381acb8546b1fa3156cc756b4660dade3737dcce2af56ce8403fe493d65da21ebca33d4d575b99d0a7c0e811ccd20b15caa5fed77f32af52aeae616252ac28c50f25c22a4744ffc4de96941bfb361bf18b6dab0f91a53c4c1f2ebe2ee429feb462a9ebc0be16301ec8bf2d532ffb9a74d65c52356a5161ba6aff29fa4bb3488fed6e31b352fe285bd33c5409a38778b68ea60f356693bddc59419c149fed63271b3c2af487ea994a0f538f6fcb90bf01920d718cde1d9376c6b0298f7731282fdf97a127b1ce580e2d7b50bd4b271a971f3cc437188ccf86df906883ae85b72a1f24b0ec5d85de59f3e2cdce251760207b674dac821bf735a5bf2871eda9b0899fdab6f7bba1b651152132cdcb1c2e12f1b18074ead80677018cdfd6f5ca7eb7108e3acdc7616082a0c08c328d2414e6e45a8079979fb3d34dedc5f64007aba5eafc22b2e5d9552b58ec4a7040041b9fbf78439c325c062b39268b140b237adfcfe0b69c6c3b915cad49b33ef06c4e55456b93ab6d157170f3c75b4a6a2ed295a8803df884fe01f240090ec5dd52897b0613da2e07a6011be563cae0cf20499823472dafbe7e0fb37c6889e904cd5a44b92d103d00437106693464374d3cafa1886f35b88852df17bbbed90ec50b551f32a49ba5829cec527648a3b266187bd5ea80994865c90e5a8adc54fb2fa96502e721dd788102aacd2de5404b35cab14291c14e99fac8ff2736d21cd6262d8d045268c8027f27323a9cb0374aff3b38659ed1a2ad104fe0fa695633a6b1eb8ec198fb8e3fcca998d230b1369bca985114c57cd04eb052aaedc453151cebebc6888630d78eabc64853248f8c8cca5c06188720315c5834ed0e99c460370d19fc67542a277606fae082b090a229a130333c8c29ff6a9735b7b94679bbd2d1a88b070bf4700f4f59c438252e29b67bf76022ff21e390af1672a9de863c6b4605790485822ddf5fe72fb624eb14b575903f8d0b4986c08d3d312206a4e2f5c59d9e6394190ed59026eda5c9cea004e04aaf42d7948aca46dcbb5d75ff929aea3f987de73bb0b96d53e44b14aa82a00fa5ef6252edc8980e1043e7467d7f5a1befbf8841f018ecc5d5a87edf7247f23dd6e1a9c8c3805cdf7d3137f14bdd46d2c16a113a7250d678221a7a363d12f254fc5a05a095967bf68314463684b29167b434f77508e6e27c9b96f36cc5134707a76259e6f26df491e2f4ed45c0e4b26d160c704324023240fc0e090038b725849d4acd9d9c4f2ccfbd6c63dec494c54ed59d248a0d8408dbd7d101d291a10ab00ae70a2b0d2623aa02a32037c52850bed04beeea56c007fb86ccd72a7cfbe4e9cf0284ae21c748c4e2e48366dcae76bef9d4428d8dbf3accb589e72281d0d7f53b9f7bca464ed695693748aca3b7edfc0b7144f5d439aa0d3bcd7e91e8191aa7ec9ea2edcdf2facb4ee40209e42b284d0f5a6f77316ddd7ccfac617880a86d47d4428adab1e5fbca39b507169f1723bfcc2c09accbe0880589452543c19eed6136751b8399345def45a8d8f714945c103fe549a1a9fa357514e98d57e9743b14303bf6dfb2f2f1e25e453bec6b12bb3122f4a52293eb9c7d3524cab9e171e28431570727e27138af51bfc03696add1f0f3da7881f5cf3115da158f022f8ff9460c71cedc931a2535b917373fe120231ce13e8c064ed006421b5a95265fa5620cafb923e58f9da53b3384714ffcaf76d5232076d7d448a4d7371d7e4fa74e91eca3f4b2c5b3b4210792c9d889a2ea85141b18c7ffea2d3496888c18afa3505824232d679f3618d7fb47d42b0b867818a29ef4cff367bab8e1f11f8f4147bf94d20d6c74c17078d6cc9f8e458baf6ecab52fe3f36b779bddc23c6081369baeeda914f5df025788502de7382635856f08b95f5509e0ccd3e7891f0957bd130eb36e1cfe65118ab93804f97130202de4ff9ad3f3d91f0e7dd7257f74d8e79ae0a407e833c34c0cb746f3b35ddf7b8ad40466b4f620b7d3dcf9e7990a99e9457ff1de8d5051d4cba85bea67d7bdc5091b67aab2e27a2f9f9da9d68f358ebc8d243288aa80b6f82ed8cbc523e67350a25246a7c09fc4a8208743ef99b231c00d0c4f409734d054a7df896c87f9d3af580bc909b6f3bc6130733976d91235850eef8ad02c32819dedbd5eb2a88a70331a5e5972391c225910a578a08982cdce599430b6878ec99cc1c45705a657e36ef74b5924b14781da66aefc5306730abb3b249952b0e3704c6fa256cd340044315dc0e032dce5d2bab879ea7c9159c28642ef9596107126f29db3656fd7419ea3b000117c6c63af75b26487ff18e8a3909e22029f4dc47e5e6bb1fc2949677ae6e2f1586af64e0824a03ac3e6842bb7000322d04e3a2ade5b41a9b427115cbdddf915b6faef77d3f4555c0312a0718ed85398f189f6df3e6124b680f55b04c3bc570d5e94849394a63339f418e53b7e1d4e1998376752f1d875efdb970df039cbe15ce25037930163176d020edcc2c8192bb028a3e8018de5c0e006623bab902047a5f12c3e1afbb7f18f7777f84d43b18a39152ef7327b5f2127465360d62a36f49fae2f61b415d01920d1d63d65cddc04d9c4883cfe7734d0995e14d875b5bb6afdf6ba75f0b23f485c97848ae410e179a44754d61e48cce5668a36cd165fcb634f7ba7a2c0c054200831d43010a64e76de3789c1cd5b2b0fe3e8a6d437593571b5b0b9c8a84f137ffc059c9af2584fce77e78ce9cb5053f31579470b0612269a42d0786f31116e854551b58071f0673c5f0464a0f324c60419b32f7b800bb7eb604cfd8f59bab51cff9347b458b218e30f2a78eb35e088000d4bd2e2315f412a2631fcf2365a23ae4f882c0c13052818dc66d3768ca130be719103de700877b5511fbcb5fb6eae7be58655e5aded225fefe8f88563de5a37900235a46a3ebc2e274a7b8bac9b06ec0d243e4abf3042e2a636dbab0ff3f800a0de7823a9f62a86c9810a1a357936b3474c840a05fcba5e4eae75c37c0d3be2752fd1048649c078dbc907b4839dcf5248019233981287a71065b0400722e26629247d9006e2836e7183cf30f2d074f802b2628aeabea1ef7a31c56ca9b9801c6287d1e3ca27879170d93532cf4f72c49df13ed968efb0fd68711fa32d592249bcde83ef6f15f9c9154cffed59b519b379ac1670937b10fd3385ea38466bbbc1b8af84afeff9d8517647e08803905deea2f8a95cbd5aa660e5a8e94a3faf8e08fbbea55ac5640a551321a74e95e70bb8a851d761b2902ae7e6fc4764852798de8f87699e74eddc0fbbdb42739dc1132ec6e10da96c29064555a17d135afe6fe0095640fc470b23c0976565eb01e4d78eb94972d058aa072ab4a2d621896e3cbe5b8777b709aab94140a3f54e0cbbcaf02171582eadaa3dc12f3c8a13bbdff4fd641624e8a05b3ca07e57d836a7ee3ac92ea21432c75c0b2c02e9726312b5b5aba018a62a628821befcaa2722d655bfb41bf0eb23336218b8054d3657b09cb816a710e3996d40f05e2e171e376e66343a7f0711782f42d2f8342b090bf5539ced5a186893a76a3a51531b0adc48ffb81170399d0f8800339d8ca4951ed1217c07292067ef05adcae260a641f9ebb3daaad180e1f9c615eb95656d031e4cf6874a3fa8f0a6ab282e17652bac1bf8172b03b8d5734e7b38d31b6ddcdfd5bde50d5d3cf00e47ed6fe80ddc527bcb019d208b8e25f3de5f00efd8197dce00837e3bb367bbb520aac5c4911ddba153dcf8671ad08c5d6ec5dedb3cb5f471d6baa13f0c630726552a4a50a6644b90903620b20b9b3d79d6035212b884eb1311ece533c6927d246e5f1701b81492ac1deba50ab11fb5d14515a51c2bd4f443d4294ac1636417f209658dcb50a3f690d686f4a33805a62adf3fb3dc342376a8d6e5c0fd3ea93355f25921fd8cb5c8eb23d7f3e252adf1fd27c6305fdcd3938b4fb4d3dcc8e97f1eabb8de41efa0fcd2f8db592b9296d2c77885af4aeb1b8626c1a0e1d379996f308f9d20216277a5f8afad47edda0f49ddbbd4c3d319c53bcac012f3d3cb4affb6f68b7da4c40a495b1a391e5f351a1c31549c7f3e0875668387c814b6c21940f08e9057f5782c9ba3e85d95c37283da6f273a859bdccb66d5d8bbfdc900697d172b26bea6b76df0dfa173f5425286a82bdb0aeb37eda52c90ee941d920436b4bf9ae09723498d6e4f519d7557ddd248ceb2636ae97cf913781d63c57b3c8e2e4cb5a2dae5f8e1019a0c596ac55625b63b4061e3555c1ec5aff177518b56a0ea952b67aa272eb9489ff7af897a8dd7978f412e831b5cb90c555b1f6afd99f652386710e66e2f277af5cfaa6aa1e5f3e5df0196c64f9e535f8c8c4e1c6650a8e08abae9e80166738c210005f5e134d2e29cac30e168d1136b61dcdf92d264f44cee68c9686e6aca844cac8ba2088b6627e572a9df27e042a8fbeea97a8dcb1488d276d80c48336ce10973b32c017cf1dcb80383e904eee1d115ae6295400b5b91d49124f98fe64ced733ca10d697c99afc998869d1662740b2599ed254d7bbde83f03492bdf919a9e3541938c688287fbade5dd14a81ab53da587318922ed9c44bcefd95d72864a6d36a9eedef826de498c79cc798cc95aaf07889ea6740d21092a6c712543df78175f4a6496a00a6b392c01d09b6de23be3d5e4a27d21eb41c886c9dd35d86ba27d7ee006e71a66ffe940b34ff7c1cecaad81206ecd867cc1ed49b5763305acda7c2ab6355bbd7f4038da92e2bf40f7e2ff89b54f460317a5421e5977358bd37f442dd54a2056dac38260bcde61bc664e436ccb881706bb53200b9aa3738aea638985ca7017fde4badb68fca8dde18d64cd584b80e61a7d46bbea95ce13b83485af5b384c5d27441f4cc1301b3be1c9d89a17af096c9381bddc0704e597e6bc5cf87deafa7cd02f2e78fb99cd0919b09359159f4d6a1e7e78895fffb02077c1956da2706bbd422de4df87e348c0f18c923d863826a4a1b53c9ba81aa8eb2d6b6a217dd8cf56da19e4d20de2bc0f4793cabb0076a089c3b77f9226ab9c9cf1d9ddac77cc6d567d56bdc729c990fc69d70c36c4417f82e7aa909fbd4c020b49a9133b5288ad36bf9a12ecceae8b75c4f29d785710791994e6df8015f1b4793c20691dabb4739337960f4e8f39bdea5dce668c2416fc41ec276cb0ed99eaf7ededfb22f063250dc7250f8666c2b2694f9f50145895177c4e6e49a9ff403c3ccb0c564a59e65a3de34bac5fbc59bd2148780a592771fe9d21019da4fb4a4c8cecab894041f609acd03ba710ca35f3b7365955cd2a4a85631b07f9137e116e56fc6d4a642061d11273d13643db8bd1ffa5d2cac7abd6b27d53d6652a065c99543a99ab71c47841eaa8b86e476c8b4e44aaac3c42ac43e0472ad7a785363f635763780805982b3dafbe603da0249cb2631f987edc106c10394580232a7b3181a936adeb6dce6829086e4e265e7ee9c3c564f7f858d5b212794aae93a364375e784f5ce8b4947796b2f1a10786837cf16379c071cf023b071b3c4ec5c5ad5abac3ff64e40db5370ea960c7db1f54acb15cd9956d8b7753524a2045c07ee3ca429bf5be63bb430c6fe9f8145e6a832c3ad852987668d0ef622fac697fcaec89ef246c25056ba2f79facd8a69a749dd91639aa10f603b1211869139b3507829bb8f500b399ed07767d72bf94caa5deafe948955b41a8c22ce3f3ff66ddec89cf9dac6a8130b76e438273a20cae3176a054e73e1fc0267723155231d3563b693a48dcf5ad662be16c25ad93b7d0dfd01aa7b750668deedfd797648028b190b8c6fcd289b3be290e1ce067ef97d4db4a76f7ea77a54525fb95dfd922f29149d7ce53a113e01a5488e472a71e18def8fd6f62b5ef997e83bb4f5b76577960c55f89ab550b7a8696b265a0ab3bbe0fd5b189c875cb8b106c18886bbec7ad289933b6c02455acb25cfbb5e70b4379aa70b4f8282c69528b15cd83c1f4add20498ddd820aabfaa458247fc0b9e1de4e904df4852093e4ec681ef8c8dc3b1a77da80989d293e4fd5268b38e45d0cf785b89f4e0307a38f2ed1130f51b478828c9f48221d2ca44fa0d24a829b9bd1e205497ff17bb3be8ad0ca0882ed484785e47657514ed6579c4888d1c823bb8897f22ed847aa09a8072bfcf6a97a87ab6659be44ff6480967f3b7aef90a30db298c123bcf3bc82abcb772e30ee00f8a7e3885da5642a145e88f5ad7959b3604f09ee6c1b2e56d817e88624a5a5890efb8710bee5e4761b0c9ec074455e65ab0a32d498ea35c20a2e207b1f21de4162edb8c0993c9d0d436040de19cd2ceb19703e28280914579185a435ac12b03276f429ebf61b6b757da557e5c08493fc63ae436bb3ce716cef2fe71eccebbe19de785bb20d724af030b3558f521f08fabb3bb2e239ff73f3c2ec600fad557db16ba990281c57785642ee2513010ea65928d23aef8a3189426a490a7b5dc2383f87dc66cf303f868e30f97e9b525d45cf6e201968ac7d1b2f3f281c27265f2d84265cc89695cb5788b4f5c0e0f32b29c46c57d7b6ca18d92ea43676ae770898399db83fd667035c665bb1984a4e6726444c7fcc804ae8f4859a3643976e78b43133fdb503ff9ef3e77f7a7bb1dbc8057016d47d0d05371d2162a7522d4368b8de4e375c37fcce6c2d7e3e2cdce695f15d93af63e99c7303324a73e0ad5e1d29cf139c540becd5e0b9908b02cf456e699de88984e9696e10eeda97b82c9aa0a693e217b7e4cde49bdc5fe240200ae856efad5b0e3229bd2664d590e5793d7b69dd756b890edd1656a51b7e9ca5832ed2f204dcc6fc837557477753a364459abb9e6d2cc763bc8d8e254488f9f7f0d91e6ff775315682491e8b6d3a0c21b4601a68f4c6f78497b1f91b31aa3dfa821c79f8d07d4fa2deaa45ed7b1614ea8dfd8e059bd0a91df1e9b984c03bc1c0730a8630e912bdad03a966745bc390503a526ecc3c518734e6dc6ac52bdc657815a62d5a6a397ebdc1c11e23f6607c8f0daf2fca6e282585852761f73ebfc1942713e37ab0d99a3e631bb175583330fec00846117551b601c538ccc217d46ef0acf91239bb142d07cfbdfd87a38cadcb6dada782aa6cb824db11628e4510227a06009e0724409cc422766e8f4052f32f4c7f563f11bd3ebccddfcb1b180c95fb66a185630e92ad5aa11cc0673f61ee7f56600f25a68959f4b2b51d8e3b7fc16c454e83e003499f1b305571deff6451389ad316c1b1513aea3260bd44af141674b562737a84229988bcf8856dd9ceafdb5e2dbd23f5dae68c313a50eb10580aaf42b304e24be21bd82c1c9014799bccc7854f7f24df25e8a8786304520f1a168a9ecea9befaffd1d61906863f0785b5c5b7e0baa0fc3f016308eabf8528dabafc96d53e4a6fe9500398c4780ef8cedcd5eec45afa3e3d062c649e3d389175b7ce520f31634d33c453b41e140dc501ad26d6f435b3b514a11be3760fb0911f5a0d06560d51794d0d9c22a9dbe7b84b7bc858251e5deba24b3f87c11c119b138f5650bef1e4e4903cc9cb001cedfdb2db0bb94615ae5cf6174b8c2ec7d4467574e2c54b9cb5323849d6c35bb8756a329bb7a4a7b89535d683844fdf66a6da4b14941e442d215a125d8d9f16ad0ca96035f9451fa7fef5a1946a3159000b5c88841f565eeacba56257f6106a3ea52cc65ff489ccb779dd2ae30f1b2f6c11b8d837994dc21572546b391ee5749fee11d27c8a1218d31199796318d1baeccd04b41da58efa3d55394b6f819ea3faebb8151eef5160b42733320cf023f37df17deb7adfbac1017b23b90c2979e446055ece5d67d62b1d6ce804bfe84ce68afc4f16b08bf6671215ed16db6371c0d83bf3f31086714657c4297701e4220fb8ae138cf696448ac50e07f7d22a7200cc4ca7ac7ab0328c929851ac9f79af5d4125cd4be113929e4f2e7f0b9fa829a030ccc999de6754a3de3f7be2f50459b35119eef09144f4f40f2a9ded1d72bc37fb45269a6e619f18eb4f2097b64bc7281fa0bf290db315ab9a4fe4e72162f09bd7b646facfb36990665dd5b8a5a207a57a6cc7f0fdc76d053f4d1e5e54ba5f7c4ec9a9f8b7c3ba3a1a8c330058d4af82136d85b5d57628c3c194fb0cb003e978db109d797c4cac443aafad1e278b12bf979b67b87e041893a5c42b610f505760b1f7e49406394d2143765694cfa443c45877b2312a5b0102aa1601d08090b883a1e396959a9d5339e946cf074e386042c27f881e2b9eae8a4d77ecf31902bf10120b5d1ec712b9cbeadecb8c8458c77782dd146f0fd19624eb80141dab6954a68ae741e9e1127842e5d2c15ffbb61efe742eb1be85b20f612b2ae0c9b7888df4cf78bfeadcc7c99e0c99ef9d3eef01e645bd81adccb3be9bead8b68c2ac3f2f2b530a23b3a2e62f16d8358ff1956d11aa11b3f9a1db94cf259d08a96b65bee41ddd1c0856c035711b0d414c3af75b06dbe6e49b794f16bd5380a7dc0d2b40607102a363e930d5de5aae54b3275cc5381bfb79252201c0499f7ccc6a8072c8199398d79a9aca7fd3133f07647f2385a3be7998230fee94ba4d1bb1a4b07bc489b34bf2a1b8219c47b811e1af0a22c3a5e883e9d3276ec4c4c895826bbf91821c5571055bee83eca853195de69db5916faef36ef05dab90e6ad6ced1a95a898f49cb1d4d14e7773004c87a325f6680b6e0df8119f724ab4cb8ed684d174f9c726b7e753525663f7339f3df955b40eb0e15e6873f6b64926c09f88fe64845f8ab35142030a63d579215481984ba82e060aa755668bea14d4a0d1abbebca2ba5238e9e99d10a67ade642819fd355205275037915410f01a620109e1ddfc2bcded81dd75991c3f6e4a50f3e9af482ffff767aa9ad9e6a91c963385499e1f9e42f4b192e6236ce3fcd2d1dc7794e3c87a6c7c410af45b8419081b8f03ddb0b7cae9e081ae901d893aa3ba9939590710f4edcf5b485f3efb871da84691f251a5e9479ea14e00f28cf291fd4b01dfad6fa8a8d2a620436388cb9c0b262ea392d6c5688784908f0e60dcec9a4db62d2cc94527d131c009db1b6cf69ef619fbde6f238be89636d4052dddb43a2592aa04b92aa86d15e78ccdab44e0b720be9ba14182a51c4c7ce6d56b0c50fad6333e3c2de55019f5f5d92a668e4c75d0291ad2ddf2121acd27db1a9fc7597fb43fff0615ad380a309639059bf93619bce6aa47a24b0df0a4fc990e2ac9fe353112f88953dc1977bd2eea0b4c60d554e5811a7af747f31489d3458a2989f27d859292b98772256c28ef055b3d7fcdf9a11fee1f094454647cc739e5b56f93e7824386713a5254c1728dcb63a71a23c0e6b9c98ddd79e9f1db0edccd525c11d8ed866c35d71710473444f17bb65274ad475762fe40958ec2e478249fca89651ed361e12a9f5fd347f50fe47c3471519314fbcde7fece04b6b28f47b4d82cf9a615e525f15e4fb008b0f5a4614f84e34726e21299f53e168d7d95fd302c9797a3c60d477da125883107194b78c0c81f7fd23aa2387d2a061b6094622bb1bce1a57114c4e7bcd47c3c5ad8245c85947f1c9bbc5150fdcf7111e164150c7ce31084d91dd016175591f1e3dacd5c65475c0f3348995f339739b1933e4cb253f2618610000f38db4985084a4751a2a1001d2ca8bd64a8c1850e265b62b171c4aa0eb34d4dfe0800b06c59b5e06c908387ddb93d722201c6c86f8e41925d2e8e09724f10930b4130af36ed2b1745265986edbad5a4a496c5e00634969d7be506d531167a990dc960ba21be13055a727a816ac70963672fbb3f1dad9272f2e5b6cbb0e1512f222d69a4123c75de6bd09a15b6292f338f8488748d3c4f21d9028836cb2298d809e62c48d259e7d3b3b0ba6948644bfc22843982cd5fda382e90391527a61dbbbb0c59bceff2bd153f1a48812c256700c6e638db1c422a9a99b5c706f65218bf653b9bb869d243ee40b5f4b1e6cdf59452ab1b353413947382cb4d62bf5cadbe9593525a4fb0337cbc496bbc3dd071def593caeada4afe303e3a65a3b404c06f610a66b8095a926ca2827307e235688564f9a0ec1c42888dd9a3d941f62cb38b5b300e9aae5a343b7feef03993461f6208d38012c894e7916d4670ac230c76a10cdbaad73036399b1647c6202e2c3de590aee4d2fb19cffc5e66c9620d5946b093a0881c57fb1496c764396645532dadba834680b269f96578dc1effd04e00941dc7769d39ce3f9801c049987a2b9d98a801474c83b72bc7822ca04eda6c80628ba36a729f8a661b1e0a36c5ac7ee7deceaac1b80a9d5e80684f3080158cceb0fd5439bf389e5bb9269028c234eb036a5878da3c4a3fd4938a69a8e66876014bfa9e72a3197dc96504552f3ac414c35e0d199b11c72792b7ba9c1679c2bc24fce623af80a0c0b85b75abcb61af77d4694d418bbcbb9ff144dc51a9dff0cf5b84b7fdd8e489b9d9a46c3077f3e5cb80500d72372e3cdfa1dfe1ed4c80acdb2d44565f20953585fb9400d8100e1dacef58cec49c46219fb27c07aa2192472e3e7a4030fbb6aa920cdcfe8f0641061bea7ded1ead88ff109cd76efdb9027f7904a645332419cb4c3e905c2f0f781e3d7d104620566ed9c0767207ae6a703fb956b49ea09c8ebeb2e3b5f15b42cc4267aac56c2344ff16a09c6e4e91dcc8c2ab3212d2bb67d8f60bbac28ab0dac4dfeb85bc18f2ebd7004ebaf9de9a9398c0a3993237cb5c1fabc5802c9f2dfe7fdf146e50a1a5889150e9266495eecbfe06d7221c14bcde9b7fba9f1d3ba5572824b373bcdb8eed6e0a3863606b30ab1f0a9d23cc6e7ea36c6105e072a439aaeb0c5019058ea12cf791657686e65681fb39d2043dd144d3a739158d1ff28b0e94f46191904fd52799bcef429937e3b2a83aa13db8ac01d817dc1fea203c99411db82dc8a63a40bc30b01bdeb63537f58359f975d2e2f920b8bf4c6aa2c6bfe69cd48837e8a9ee1db929d1db9784b0e8aa3c6d7f444c2dfe2d08395a9b47c0a2d09f51f674d9e26302ccbfab2a989cb23bab974baf315e37e8e35287c8878b3ae1dc22c778a524118650c0a48a8fee970fd2323ce7f6ff1382ca13c73aed25ec257ae5ed7dbf06ae1586a563268e6a6215400de85bcdfd0ab3b6922b9efa82be0267d97b19592c3e4140dd7d30590f2c62ad13f20543fbca55bde4da3f4851e437ca462bc26b6ac11886cecfc9d41f29a403729d39288ce71159258f6d28491b4ea245a35cdfb66018ae4cc44e92498d1d8ef6d86919b08e65cf378dd33ddf73c1b42a2b836eabd06ca71626b4097658620b607b026fc287b753bb3623067837dafa7b6287fc0d7ba269b4ad01c5d05e4fe932d94dd7b70832070c6a7a610f492cb6c843a70794df37b9dd03f3000bedc3d18abfacdf8c6803f7cca8e191ca131dd1e8544070859743b9327650da4b63af02f8b4da4d4bc02d2df680a917bde9b296b8e9a09b09c936434634535bb334e5d7dd7b81b334d85c2e722548e3a2a31749a514df108656df8adedfd912bdf14b6c5a7e9bd93da4154a446674b3279b5157bba99be8c9d22e5c59ea8f67f658d707b93374288d389e53c51a2d277c224faa3dcbf0298ce08c638b8b6020ac14012a509963b9c53eefeb1ce1dac69d1d444c2d8a7d197df32d19d720e7a292971b37a4e0aba1cd9b180822cf6df628f32aca4c351f41f378c85b4bbb68b1a3536a0d34081efd6358773510e5a3584b8b0b70e8b7a0e8090f61c92cafb3249e68759237eefabc66f0d252689f9110c7cb825cdd435d93b6c91f3344f5843499fe23590f339fa86bf2631ddd820fc34c26172728f19e6ff171041ed5a21d30ee953adfbd4e98960a790c76d546033f012fd67ecc4bf8123ccfd04fb89b1e12b15fe98fe99ae84969fec3dc9bdb95d972afbcc6a99414ff4d3924fd3df97b338525c85e181a0caf6b175867fe2ccc4ca970f575cf9b8e8f0632c4e4b7489510bab29431c278b46aff8957b727498057b9b565fd4fb0afbfb09641870c4aa6a9a9e34868acd4fc11f02a051715e8ddcaa72faf779d2f300c1ef51568684df9ba18d39597ae205208dca0f577f9c96a7e80a016bdc3413249431491db6317c0db16be29edd060f751a3d6eade4945dc00363b2a0e6c1b5eb5b5abf46701a316752584ee63b87a232c4616db43460df6947d3d35db49c3e5d742d204468cfbdec719fc3e9260bb72d2ab8247a688dfd42114d75e7c4a113c6117d0f787c97d9d38e36d420c4da60e428336378b136bf1f4e9da935ed86786fccc869a15a5faee458835023e0ceeb3039a304c0d99bdc4ae7aadf1613b03a0a3030afa7d645c7c28cfbc8a2882c0e15ae96aa197835c6cc5a3032386c0a237391e79010d1114217708f842bcfb5f5458e5263d5a0fc058928ecaa09782bf08a647e7b4d7a528ee24b21e7d5775b9afecd93633d9c812a678b078ac423bda660026472b1749dbfdf55645b57bc90e8fb6cdbfda6751d432e2bb1e1635f39c4f9ab1b0a817d000f4889a5b938506f1268d154d85db817e888b109e67a6ed966eb238183bf01eae6a8348db3afea654705c46e4d1f0dc655c45f847098a5e31b444c771276aa99bbce8e02a88dc4c6f165f32831c6e68c0bc8b807fac3d8aac2e9e4cbf67342d9b1a37214e68018abad27836dbb7c66e29af47b3fddb2407f12cf1138e5274f07b60e86eecdc276ad0e92f41e783875b9687eeb834cf81d2e7d36c11c7f67098b0fe4f98a122d9276ee795c045aeedd66c24026bde74e199ff059c019aef4f70f001e6a1888d9731707b3a4a33aeb45b97b849543a0fb938bfd1668bd763c4c96da11ff9a28ed2c1aca1c5fddcddaecf3840b583764ff1c3c9203d5298569d657f94aaa671262365e9a412d60a0e32a578e729117f2304c4b49953ef1adc515c6ebded054c0eb69d68f8d5f9d90197a7451b8c98abc7a5b7057324c0bdd18eb8376b35c065a78d1e89a9ea7fd4b4590f00d4589b612c54cd9349e577affa957574541f3d2ae7ca8a35c13849e24351274a67effab15e9b0b9f19c9344599c5aaa87b0881b04d4e8ff8825a8cbf71be8302910b381f388aedd699dd0f63300327fa73a32e57958f14e13a78053a1dbd","isRememberEnabled":true,"rememberDurationInDays":30,"staticryptSaltUniqueVariableName":"e06b548b27a7e7d8dcac8c756dd3f2bc"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
